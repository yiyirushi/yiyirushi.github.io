<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.ligoudan.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
<meta property="og:type" content="website">
<meta property="og:title" content="LIGOUDAN">
<meta property="og:url" content="https://www.ligoudan.cn/page/12/index.html">
<meta property="og:site_name" content="LIGOUDAN">
<meta property="og:description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="æç‹—è›‹">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.ligoudan.cn/page/12/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/12/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LIGOUDAN</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">LIGOUDAN</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Š</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">326</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">137</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">461</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="æœç´¢..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="æç‹—è›‹"
      src="/uploads/ligoudan.png">
  <p class="site-author-name" itemprop="name">æç‹—è›‹</p>
  <div class="site-description" itemprop="description">å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">461</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">137</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">326</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yiyirushi" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;yiyirushi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yuanhaohoo@163.com" title="E-Mail â†’ mailto:yuanhaohoo@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/b563af/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/b563af/" class="post-title-link" itemprop="url">ZXing å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">å…¶ä»–</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>2 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ZXing-å¿«é€Ÿå…¥é—¨"><a href="#ZXing-å¿«é€Ÿå…¥é—¨" class="headerlink" title="ZXing å¿«é€Ÿå…¥é—¨"></a>ZXing å¿«é€Ÿå…¥é—¨</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>ZXing</code> æ˜¯ä¸€ä¸ªå¼€æº Java ç±»åº“ç”¨äºè§£æå¤šç§æ ¼å¼çš„ 1D&#x2F;2D æ¡å½¢ç ã€‚ç›®æ ‡æ˜¯èƒ½å¤Ÿå¯¹ QR ç¼–ç ã€Data Matrixã€UPC çš„ 1D æ¡å½¢ç è¿›è¡Œè§£ç ã€‚ å…¶æä¾›äº†å¤šç§å¹³å°ä¸‹çš„å®¢æˆ·ç«¯åŒ…æ‹¬ï¼šJ2MEã€J2SE å’Œ Androidã€‚</p>
<p>å®˜ç½‘ï¼š<a target="_blank" rel="noopener" href="https://github.com/zxing/zxing"><u>ZXing github ä»“åº“</u></a></p>
<h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p><strong><em>æœ¬ä¾‹æ¼”ç¤ºå¦‚ä½•åœ¨ä¸€ä¸ªé android çš„ Java é¡¹ç›®ä¸­ä½¿ç”¨ ZXing æ¥ç”Ÿæˆã€è§£æäºŒç»´ç å›¾ç‰‡ã€‚</em></strong></p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>maven é¡¹ç›®åªéœ€å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.zxing<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.zxing<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javase<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœé maven é¡¹ç›®ï¼Œå°±å»å®˜ç½‘ä¸‹è½½å‘å¸ƒç‰ˆæœ¬ï¼š<a target="_blank" rel="noopener" href="https://github.com/zxing/zxing/releases"><u>ä¸‹è½½åœ°å€</u></a></p>
<h3 id="ç”ŸæˆäºŒç»´ç å›¾ç‰‡"><a href="#ç”ŸæˆäºŒç»´ç å›¾ç‰‡" class="headerlink" title="ç”ŸæˆäºŒç»´ç å›¾ç‰‡"></a>ç”ŸæˆäºŒç»´ç å›¾ç‰‡</h3><p>ZXing ç”ŸæˆäºŒç»´ç å›¾ç‰‡æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><code>com.google.zxing.MultiFormatWriter</code> æ ¹æ®å†…å®¹ä»¥åŠå›¾åƒç¼–ç å‚æ•°ç”Ÿæˆå›¾åƒ 2D çŸ©é˜µã€‚</li>
<li>â€‹ <code>com.google.zxing.client.j2se.MatrixToImageWriter</code> æ ¹æ®å›¾åƒçŸ©é˜µç”Ÿæˆå›¾ç‰‡æ–‡ä»¶æˆ–å›¾ç‰‡ç¼“å­˜ <code>BufferedImage</code> ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">encode</span><span class="params">(String content, String filepath)</span> <span class="keyword">throws</span> WriterException, IOException &#123;</span><br><span class="line"> <span class="type">int</span> <span class="variable">width</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"> <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"> Map&lt;EncodeHintType, Object&gt; encodeHints = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;EncodeHintType, Object&gt;();</span><br><span class="line"> encodeHints.put(EncodeHintType.CHARACTER_SET, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"> <span class="type">BitMatrix</span> <span class="variable">bitMatrix</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MultiFormatWriter</span>().encode(content, BarcodeFormat.QR_CODE, width, height, encodeHints);</span><br><span class="line"> <span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> FileSystems.getDefault().getPath(filepath);</span><br><span class="line"> MatrixToImageWriter.writeToPath(bitMatrix, <span class="string">&quot;png&quot;</span>, path);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è§£æäºŒç»´ç å›¾ç‰‡"><a href="#è§£æäºŒç»´ç å›¾ç‰‡" class="headerlink" title="è§£æäºŒç»´ç å›¾ç‰‡"></a>è§£æäºŒç»´ç å›¾ç‰‡</h3><p>ZXing è§£æäºŒç»´ç å›¾ç‰‡æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><p>ä½¿ç”¨ <code>javax.imageio.ImageIO</code> è¯»å–å›¾ç‰‡æ–‡ä»¶ï¼Œå¹¶å­˜ä¸ºä¸€ä¸ª <code>java.awt.image.BufferedImage</code> å¯¹è±¡ã€‚</p>
</li>
<li><p>å°† <code>java.awt.image.BufferedImage</code> è½¬æ¢ä¸º ZXing èƒ½è¯†åˆ«çš„ <code>com.google.zxing.BinaryBitmap</code> å¯¹è±¡ã€‚</p>
</li>
<li><p><code>com.google.zxing.MultiFormatReader</code> æ ¹æ®å›¾åƒè§£ç å‚æ•°æ¥è§£æ <code>com.google.zxing.BinaryBitmap</code> ã€‚</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">decode</span><span class="params">(String filepath)</span> <span class="keyword">throws</span> IOException, NotFoundException &#123;</span><br><span class="line"> <span class="type">BufferedImage</span> <span class="variable">bufferedImage</span> <span class="operator">=</span> ImageIO.read(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filepath));</span><br><span class="line"> <span class="type">LuminanceSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedImageLuminanceSource</span>(bufferedImage);</span><br><span class="line"> <span class="type">Binarizer</span> <span class="variable">binarizer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HybridBinarizer</span>(source);</span><br><span class="line"> <span class="type">BinaryBitmap</span> <span class="variable">bitmap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BinaryBitmap</span>(binarizer);</span><br><span class="line"> HashMap&lt;DecodeHintType, Object&gt; decodeHints = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;DecodeHintType, Object&gt;();</span><br><span class="line"> decodeHints.put(DecodeHintType.CHARACTER_SET, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"> <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MultiFormatReader</span>().decode(bitmap, decodeHints);</span><br><span class="line"> <span class="keyword">return</span> result.getText();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´å‚è€ƒç¤ºä¾‹ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/JavaParty/blob/master/toolbox/image/src/test/java/org/zp/image/QRCodeUtilTest.java"><u>æµ‹è¯•ä¾‹ä»£ç </u></a></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”Ÿæˆçš„äºŒç»´ç å›¾ç‰‡ç¤ºä¾‹ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/3101171-26b73730088f0ab8.png" alt="img"></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a target="_blank" rel="noopener" href="https://github.com/zxing/zxing">ZXing github ä»“åº“</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/b39f47/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/b39f47/" class="post-title-link" itemprop="url">JUnit5 å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">æµ‹è¯•</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>15k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>14 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="JUnit5-å¿«é€Ÿå…¥é—¨"><a href="#JUnit5-å¿«é€Ÿå…¥é—¨" class="headerlink" title="JUnit5 å¿«é€Ÿå…¥é—¨"></a>JUnit5 å¿«é€Ÿå…¥é—¨</h1><h2 id="JUnit5-ç®€ä»‹"><a href="#JUnit5-ç®€ä»‹" class="headerlink" title="JUnit5 ç®€ä»‹"></a>JUnit5 ç®€ä»‹</h2><p>ä¸ä»¥å‰çš„ JUnit ç‰ˆæœ¬ä¸åŒï¼ŒJUnit 5 ç”±æ¥è‡ªä¸‰ä¸ªä¸åŒå­é¡¹ç›®çš„å‡ ä¸ªä¸åŒæ¨¡å—ç»„æˆã€‚</p>
<p>JUnit 5 &#x3D; JUnit Platform + JUnit Jupiter + JUnit Vintage</p>
<p>JUnit Platform æ˜¯åœ¨ JVM ä¸Šå¯åŠ¨æµ‹è¯•æ¡†æ¶çš„åŸºç¡€ã€‚å®ƒè¿˜å®šä¹‰äº†ç”¨äºå¼€å‘åœ¨å¹³å°ä¸Šè¿è¡Œçš„æµ‹è¯•æ¡†æ¶çš„ TestEngine APIã€‚æ­¤å¤–ï¼Œè¯¥å¹³å°è¿˜æä¾›äº†ä¸€ä¸ªæ§åˆ¶å°å¯åŠ¨å™¨ï¼Œç”¨äºä»å‘½ä»¤è¡Œå¯åŠ¨å¹³å°ï¼Œå¹¶æä¾› JUnit å¹³å°å¥—ä»¶å¼•æ“ï¼Œç”¨äºä½¿ç”¨å¹³å°ä¸Šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæµ‹è¯•å¼•æ“è¿è¡Œè‡ªå®šä¹‰æµ‹è¯•å¥—ä»¶ã€‚</p>
<p>JUnit Jupiter æ˜¯ç¼–ç¨‹æ¨¡å‹å’Œæ‰©å±•æ¨¡å‹çš„ç»„åˆï¼Œç”¨äºåœ¨ JUnit 5 ä¸­ç¼–å†™æµ‹è¯•å’Œæ‰©å±•ã€‚Jupiter å­é¡¹ç›®æä¾›äº†ä¸€ä¸ª æµ‹è¯•å¼•æ“ï¼ˆ<code>TestEngine</code> ï¼‰ç”¨äºåœ¨å¹³å°ä¸Šè¿è¡ŒåŸºäº Jupiter çš„æµ‹è¯•ã€‚</p>
<p>JUnit Vintage æä¾›äº†ä¸€ä¸ªæµ‹è¯•å¼•æ“ï¼ˆ<code>TestEngine</code> ï¼‰ï¼Œç”¨äºåœ¨å¹³å°ä¸Šè¿è¡ŒåŸºäº JUnit 3 å’Œ JUnit 4 çš„æµ‹è¯•ã€‚å®ƒè¦æ±‚ JUnit 4.12 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<p>JUnit 5 åœ¨è¿è¡Œæ—¶éœ€è¦ Java 8ï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚</p>
<h2 id="JUnit5-å®‰è£…"><a href="#JUnit5-å®‰è£…" class="headerlink" title="JUnit5 å®‰è£…"></a>JUnit5 å®‰è£…</h2><p>åœ¨ pom ä¸­æ·»åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">junit.jupiter.version</span>&gt;</span>5.3.2<span class="tag">&lt;/<span class="name">junit.jupiter.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.jupiter.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-params<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.jupiter.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.jupiter.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»„ä»¶é—´ä¾èµ–å…³ç³»ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javalib/test/junit/junit5-components.png" alt="img"></p>
<h2 id="JUnit5-æ³¨è§£"><a href="#JUnit5-æ³¨è§£" class="headerlink" title="JUnit5 æ³¨è§£"></a>JUnit5 æ³¨è§£</h2><table>
<thead>
<tr>
<th>Annotation</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>@Test</code></td>
<td>Denotes that a method is a test method. Unlike JUnit 4â€™s <code>@Test</code> annotation, this annotation does not declare any attributes, since test extensions in JUnit Jupiter operate based on their own dedicated annotations. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@ParameterizedTest</code></td>
<td>Denotes that a method is a <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">parameterized test</a>. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@RepeatedTest</code></td>
<td>Denotes that a method is a test template for a <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-repeated-tests">repeated test</a>. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@TestFactory</code></td>
<td>Denotes that a method is a test factory for <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-dynamic-tests">dynamic tests</a>. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@TestInstance</code></td>
<td>Used to configure the <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-instance-lifecycle">test instance lifecycle</a> for the annotated test class. Such annotations are <em>inherited</em>.</td>
</tr>
<tr>
<td><code>@TestTemplate</code></td>
<td>Denotes that a method is a <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-templates">template for test cases</a> designed to be invoked multiple times depending on the number of invocation contexts returned by the registered <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#extensions-test-templates">providers</a>. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@DisplayName</code></td>
<td>Declares a custom display name for the test class or test method. Such annotations are not <em>inherited</em>.</td>
</tr>
<tr>
<td><code>@BeforeEach</code></td>
<td>Denotes that the annotated method should be executed <em>before</em> <strong>each</strong> <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, or <code>@TestFactory</code> method in the current class; analogous to JUnit 4â€™s <code>@Before</code>. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@AfterEach</code></td>
<td>Denotes that the annotated method should be executed <em>after</em> <strong>each</strong> <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, or <code>@TestFactory</code> method in the current class; analogous to JUnit 4â€™s <code>@After</code>. Such methods are <em>inherited</em> unless they are <em>overridden</em>.</td>
</tr>
<tr>
<td><code>@BeforeAll</code></td>
<td>Denotes that the annotated method should be executed <em>before</em> <strong>all</strong> <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, and <code>@TestFactory</code> methods in the current class; analogous to JUnit 4â€™s <code>@BeforeClass</code>. Such methods are <em>inherited</em> (unless they are <em>hidden</em> or <em>overridden</em>) and must be <code>static</code> (unless the â€œper-classâ€ <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-instance-lifecycle">test instance lifecycle</a> is used).</td>
</tr>
<tr>
<td><code>@AfterAll</code></td>
<td>Denotes that the annotated method should be executed <em>after</em> <strong>all</strong> <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, and <code>@TestFactory</code> methods in the current class; analogous to JUnit 4â€™s <code>@AfterClass</code>. Such methods are <em>inherited</em> (unless they are <em>hidden</em> or <em>overridden</em>) and must be <code>static</code> (unless the â€œper-classâ€ <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-instance-lifecycle">test instance lifecycle</a> is used).</td>
</tr>
<tr>
<td><code>@Nested</code></td>
<td>Denotes that the annotated class is a nested, non-static test class. <code>@BeforeAll</code> and <code>@AfterAll</code>methods cannot be used directly in a <code>@Nested</code> test class unless the â€œper-classâ€ <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-instance-lifecycle">test instance lifecycle</a> is used. Such annotations are not <em>inherited</em>.</td>
</tr>
<tr>
<td><code>@Tag</code></td>
<td>Used to declare <em>tags</em> for filtering tests, either at the class or method level; analogous to test groups in TestNG or Categories in JUnit 4. Such annotations are <em>inherited</em> at the class level but not at the method level.</td>
</tr>
<tr>
<td><code>@Disabled</code></td>
<td>Used to <em>disable</em> a test class or test method; analogous to JUnit 4â€™s <code>@Ignore</code>. Such annotations are not <em>inherited</em>.</td>
</tr>
<tr>
<td><code>@ExtendWith</code></td>
<td>Used to register custom <a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#extensions">extensions</a>. Such annotations are <em>inherited</em>.</td>
</tr>
</tbody></table>
<h2 id="JUnit5-ç¤ºä¾‹"><a href="#JUnit5-ç¤ºä¾‹" class="headerlink" title="JUnit5 ç¤ºä¾‹"></a>JUnit5 ç¤ºä¾‹</h2><blockquote>
<p>æˆ‘å°†ä¸€éƒ¨åˆ†å®˜æ–¹ç¤ºä¾‹æ”¾åœ¨äº†æˆ‘çš„ä¸ªäººé¡¹ç›®ä¸­ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½æµ‹è¯•ã€‚</p>
<p>ç¤ºä¾‹æºç è·¯å¾„ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/java-tutorial/tree/master/codes/javatech/javatech-lib/src/test/java/io/github/dunwu/javatech/test/junit5">https://github.com/dunwu/java-tutorial/tree/master/codes/javatech/javatech-lib/src/test/java/io/github/dunwu/javatech/test/junit5</a></p>
</blockquote>
<h3 id="åŸºæœ¬çš„å•å…ƒæµ‹è¯•ç±»å’Œæ–¹æ³•"><a href="#åŸºæœ¬çš„å•å…ƒæµ‹è¯•ç±»å’Œæ–¹æ³•" class="headerlink" title="åŸºæœ¬çš„å•å…ƒæµ‹è¯•ç±»å’Œæ–¹æ³•"></a>åŸºæœ¬çš„å•å…ƒæµ‹è¯•ç±»å’Œæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.*;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Junit5StandardTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">LOGGER</span> <span class="operator">=</span> LoggerFactory.getLogger(Junit5StandardTests.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeAll</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">beforeAll</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call beforeAll()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">beforeEach</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call beforeEach()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">succeedingTest</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call succeedingTest()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">failingTest</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call failingTest()&quot;</span>);</span><br><span class="line">        <span class="comment">// fail(&quot;a failing test&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Disabled(&quot;for demonstration purposes&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">skippedTest</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call skippedTest()&quot;</span>);</span><br><span class="line">        <span class="comment">// not executed</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">afterEach</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call afterEach()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterAll</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">afterAll</span><span class="params">()</span> &#123;</span><br><span class="line">        LOGGER.info(<span class="string">&quot;call afterAll()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®šåˆ¶æµ‹è¯•ç±»å’Œæ–¹æ³•çš„æ˜¾ç¤ºåç§°"><a href="#å®šåˆ¶æµ‹è¯•ç±»å’Œæ–¹æ³•çš„æ˜¾ç¤ºåç§°" class="headerlink" title="å®šåˆ¶æµ‹è¯•ç±»å’Œæ–¹æ³•çš„æ˜¾ç¤ºåç§°"></a>å®šåˆ¶æµ‹è¯•ç±»å’Œæ–¹æ³•çš„æ˜¾ç¤ºåç§°</h3><p>æ”¯æŒæ™®é€šå­—ç¬¦ã€ç‰¹æ®Šç¬¦å·ã€emoji</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.DisplayName;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="meta">@DisplayName(&quot;A special test case&quot;)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JunitDisplayNameDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;Custom test name containing spaces&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testWithDisplayNameContainingSpaces</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;â•¯Â°â–¡Â°ï¼‰â•¯&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testWithDisplayNameContainingSpecialCharacters</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;ğŸ˜±&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testWithDisplayNameContainingEmoji</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ–­è¨€ï¼ˆAssertionsï¼‰"><a href="#æ–­è¨€ï¼ˆAssertionsï¼‰" class="headerlink" title="æ–­è¨€ï¼ˆAssertionsï¼‰"></a>æ–­è¨€ï¼ˆAssertionsï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.BeforeAll;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.time.Duration.ofMillis;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.time.Duration.ofMinutes;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AssertionsDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Person person;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeAll</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">beforeAll</span><span class="params">()</span> &#123;</span><br><span class="line">        person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Doe&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">standardAssertions</span><span class="params">()</span> &#123;</span><br><span class="line">        assertEquals(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">        assertEquals(<span class="number">4</span>, <span class="number">4</span>, <span class="string">&quot;The optional assertion message is now the last parameter.&quot;</span>);</span><br><span class="line">        assertTrue(<span class="string">&#x27;a&#x27;</span> &lt; <span class="string">&#x27;b&#x27;</span>, () -&gt; <span class="string">&quot;Assertion messages can be lazily evaluated -- &quot;</span></span><br><span class="line">            + <span class="string">&quot;to avoid constructing complex messages unnecessarily.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">groupedAssertions</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// In a grouped assertion all assertions are executed, and any</span></span><br><span class="line">        <span class="comment">// failures will be reported together.</span></span><br><span class="line">        assertAll(<span class="string">&quot;person&quot;</span>, () -&gt; assertEquals(<span class="string">&quot;John&quot;</span>, person.getFirstName()),</span><br><span class="line">            () -&gt; assertEquals(<span class="string">&quot;Doe&quot;</span>, person.getLastName()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">dependentAssertions</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Within a code block, if an assertion fails the</span></span><br><span class="line">        <span class="comment">// subsequent code in the same block will be skipped.</span></span><br><span class="line">        assertAll(<span class="string">&quot;properties&quot;</span>, () -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">firstName</span> <span class="operator">=</span> person.getFirstName();</span><br><span class="line">            assertNotNull(firstName);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Executed only if the previous assertion is valid.</span></span><br><span class="line">            assertAll(<span class="string">&quot;first name&quot;</span>, () -&gt; assertTrue(firstName.startsWith(<span class="string">&quot;J&quot;</span>)),</span><br><span class="line">                () -&gt; assertTrue(firstName.endsWith(<span class="string">&quot;n&quot;</span>)));</span><br><span class="line">        &#125;, () -&gt; &#123;</span><br><span class="line">            <span class="comment">// Grouped assertion, so processed independently</span></span><br><span class="line">            <span class="comment">// of results of first name assertions.</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">lastName</span> <span class="operator">=</span> person.getLastName();</span><br><span class="line">            assertNotNull(lastName);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Executed only if the previous assertion is valid.</span></span><br><span class="line">            assertAll(<span class="string">&quot;last name&quot;</span>, () -&gt; assertTrue(lastName.startsWith(<span class="string">&quot;D&quot;</span>)),</span><br><span class="line">                () -&gt; assertTrue(lastName.endsWith(<span class="string">&quot;e&quot;</span>)));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">exceptionTesting</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Throwable</span> <span class="variable">exception</span> <span class="operator">=</span> assertThrows(IllegalArgumentException.class, () -&gt; &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;a message&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        assertEquals(<span class="string">&quot;a message&quot;</span>, exception.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">timeoutNotExceeded</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// The following assertion succeeds.</span></span><br><span class="line">        assertTimeout(ofMinutes(<span class="number">2</span>), () -&gt; &#123;</span><br><span class="line">            <span class="comment">// Perform task that takes less than 2 minutes.</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">timeoutNotExceededWithResult</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// The following assertion succeeds, and returns the supplied object.</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">actualResult</span> <span class="operator">=</span> assertTimeout(ofMinutes(<span class="number">2</span>), () -&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;a result&quot;</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        assertEquals(<span class="string">&quot;a result&quot;</span>, actualResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">timeoutNotExceededWithMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// The following assertion invokes a method reference and returns an object.</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">actualGreeting</span> <span class="operator">=</span> assertTimeout(ofMinutes(<span class="number">2</span>), AssertionsDemo::greeting);</span><br><span class="line">        assertEquals(<span class="string">&quot;Hello, World!&quot;</span>, actualGreeting);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">timeoutExceeded</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// The following assertion fails with an error message similar to:</span></span><br><span class="line">        <span class="comment">// execution exceeded timeout of 10 ms by 91 ms</span></span><br><span class="line">        assertTimeout(ofMillis(<span class="number">10</span>), () -&gt; &#123;</span><br><span class="line">            <span class="comment">// Simulate task that takes more than 10 ms.</span></span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">timeoutExceededWithPreemptiveTermination</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// The following assertion fails with an error message similar to:</span></span><br><span class="line">        <span class="comment">// execution timed out after 10 ms</span></span><br><span class="line">        assertTimeoutPreemptively(ofMillis(<span class="number">10</span>), () -&gt; &#123;</span><br><span class="line">            <span class="comment">// Simulate task that takes more than 10 ms.</span></span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">greeting</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å‡æƒ³ï¼ˆAssumptionsï¼‰"><a href="#å‡æƒ³ï¼ˆAssumptionsï¼‰" class="headerlink" title="å‡æƒ³ï¼ˆAssumptionsï¼‰"></a>å‡æƒ³ï¼ˆAssumptionsï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertEquals;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assumptions.assumeTrue;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assumptions.assumingThat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AssumptionsDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testOnlyOnCiServer</span><span class="params">()</span> &#123;</span><br><span class="line">        assumeTrue(<span class="string">&quot;CI&quot;</span>.equals(System.getenv(<span class="string">&quot;ENV&quot;</span>)));</span><br><span class="line">        <span class="comment">// remainder of test</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testOnlyOnDeveloperWorkstation</span><span class="params">()</span> &#123;</span><br><span class="line">        assumeTrue(<span class="string">&quot;DEV&quot;</span>.equals(System.getenv(<span class="string">&quot;ENV&quot;</span>)),</span><br><span class="line">            () -&gt; <span class="string">&quot;Aborting test: not on developer workstation&quot;</span>);</span><br><span class="line">        <span class="comment">// remainder of test</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testInAllEnvironments</span><span class="params">()</span> &#123;</span><br><span class="line">        assumingThat(<span class="string">&quot;CI&quot;</span>.equals(System.getenv(<span class="string">&quot;ENV&quot;</span>)),</span><br><span class="line">            () -&gt; &#123;</span><br><span class="line">                <span class="comment">// perform these assertions only on the CI server</span></span><br><span class="line">                assertEquals(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// perform these assertions in all environments</span></span><br><span class="line">        assertEquals(<span class="string">&quot;a string&quot;</span>, <span class="string">&quot;a string&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¦ç”¨"><a href="#ç¦ç”¨" class="headerlink" title="ç¦ç”¨"></a>ç¦ç”¨</h3><p>ç¦ç”¨å•å…ƒæµ‹è¯•ç±»ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Disabled;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Disabled</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DisabledClassDemo</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testWillBeSkipped</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¦ç”¨å•å…ƒæµ‹è¯•æ–¹æ³•ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Disabled;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DisabledTestsDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Disabled</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testWillBeSkipped</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testWillBeExecuted</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•æ¡ä»¶"><a href="#æµ‹è¯•æ¡ä»¶" class="headerlink" title="æµ‹è¯•æ¡ä»¶"></a>æµ‹è¯•æ¡ä»¶</h3><h4 id="æ“ä½œç³»ç»Ÿæ¡ä»¶"><a href="#æ“ä½œç³»ç»Ÿæ¡ä»¶" class="headerlink" title="æ“ä½œç³»ç»Ÿæ¡ä»¶"></a>æ“ä½œç³»ç»Ÿæ¡ä»¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@EnabledOnOs(MAC)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">onlyOnMacOs</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TestOnMac</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testOnMac</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@EnabledOnOs(&#123; LINUX, MAC &#125;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">onLinuxOrMac</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisabledOnOs(WINDOWS)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">notOnWindows</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@EnabledOnOs(MAC)</span></span><br><span class="line"><span class="meta">@interface</span> TestOnMac &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Java-è¿è¡Œæ—¶ç‰ˆæœ¬æ¡ä»¶"><a href="#Java-è¿è¡Œæ—¶ç‰ˆæœ¬æ¡ä»¶" class="headerlink" title="Java è¿è¡Œæ—¶ç‰ˆæœ¬æ¡ä»¶"></a>Java è¿è¡Œæ—¶ç‰ˆæœ¬æ¡ä»¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@EnabledOnJre(JAVA_8)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">onlyOnJava8</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@EnabledOnJre(&#123; JAVA_9, JAVA_10 &#125;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">onJava9Or10</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisabledOnJre(JAVA_9)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">notOnJava9</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç³»ç»Ÿå±æ€§æ¡ä»¶"><a href="#ç³»ç»Ÿå±æ€§æ¡ä»¶" class="headerlink" title="ç³»ç»Ÿå±æ€§æ¡ä»¶"></a>ç³»ç»Ÿå±æ€§æ¡ä»¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@EnabledIfSystemProperty(named = &quot;os.arch&quot;, matches = &quot;.*64.*&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">onlyOn64BitArchitectures</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisabledIfSystemProperty(named = &quot;ci-server&quot;, matches = &quot;true&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">notOnCiServer</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åµŒå¥—æµ‹è¯•"><a href="#åµŒå¥—æµ‹è¯•" class="headerlink" title="åµŒå¥—æµ‹è¯•"></a>åµŒå¥—æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertEquals;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertFalse;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertThrows;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertTrue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.EmptyStackException;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.BeforeEach;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.DisplayName;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Nested;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="meta">@DisplayName(&quot;A stack&quot;)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestingAStackDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    Stack&lt;Object&gt; stack;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;is instantiated with new Stack()&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">isInstantiatedWithNew</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nested</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;when new&quot;)</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">WhenNew</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@BeforeEach</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">createNewStack</span><span class="params">()</span> &#123;</span><br><span class="line">            stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;is empty&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">            assertTrue(stack.isEmpty());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;throws EmptyStackException when popped&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">throwsExceptionWhenPopped</span><span class="params">()</span> &#123;</span><br><span class="line">            assertThrows(EmptyStackException.class, () -&gt; stack.pop());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;throws EmptyStackException when peeked&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">throwsExceptionWhenPeeked</span><span class="params">()</span> &#123;</span><br><span class="line">            assertThrows(EmptyStackException.class, () -&gt; stack.peek());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Nested</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;after pushing an element&quot;)</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">AfterPushing</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">anElement</span> <span class="operator">=</span> <span class="string">&quot;an element&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@BeforeEach</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">pushAnElement</span><span class="params">()</span> &#123;</span><br><span class="line">                stack.push(anElement);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Test</span></span><br><span class="line">            <span class="meta">@DisplayName(&quot;it is no longer empty&quot;)</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">isNotEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">                assertFalse(stack.isEmpty());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Test</span></span><br><span class="line">            <span class="meta">@DisplayName(&quot;returns the element when popped and is empty&quot;)</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">returnElementWhenPopped</span><span class="params">()</span> &#123;</span><br><span class="line">                assertEquals(anElement, stack.pop());</span><br><span class="line">                assertTrue(stack.isEmpty());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Test</span></span><br><span class="line">            <span class="meta">@DisplayName(&quot;returns the element when peeked but remains not empty&quot;)</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">returnElementWhenPeeked</span><span class="params">()</span> &#123;</span><br><span class="line">                assertEquals(anElement, stack.peek());</span><br><span class="line">                assertFalse(stack.isEmpty());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é‡å¤æµ‹è¯•"><a href="#é‡å¤æµ‹è¯•" class="headerlink" title="é‡å¤æµ‹è¯•"></a>é‡å¤æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertEquals;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.logging.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.BeforeEach;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.DisplayName;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.RepeatedTest;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.RepetitionInfo;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.TestInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RepeatedTestsDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">beforeEach</span><span class="params">(TestInfo testInfo, RepetitionInfo repetitionInfo)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">currentRepetition</span> <span class="operator">=</span> repetitionInfo.getCurrentRepetition();</span><br><span class="line">        <span class="type">int</span> <span class="variable">totalRepetitions</span> <span class="operator">=</span> repetitionInfo.getTotalRepetitions();</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> testInfo.getTestMethod().get().getName();</span><br><span class="line">        logger.info(String.format(<span class="string">&quot;About to execute repetition %d of %d for %s&quot;</span>, <span class="comment">//</span></span><br><span class="line">            currentRepetition, totalRepetitions, methodName));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RepeatedTest(10)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">repeatedTest</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RepeatedTest(5)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">repeatedTestWithRepetitionInfo</span><span class="params">(RepetitionInfo repetitionInfo)</span> &#123;</span><br><span class="line">        assertEquals(<span class="number">5</span>, repetitionInfo.getTotalRepetitions());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RepeatedTest(value = 1, name = &quot;&#123;displayName&#125; &#123;currentRepetition&#125;/&#123;totalRepetitions&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;Repeat!&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">customDisplayName</span><span class="params">(TestInfo testInfo)</span> &#123;</span><br><span class="line">        assertEquals(testInfo.getDisplayName(), <span class="string">&quot;Repeat! 1/1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RepeatedTest(value = 1, name = RepeatedTest.LONG_DISPLAY_NAME)</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;Details...&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">customDisplayNameWithLongPattern</span><span class="params">(TestInfo testInfo)</span> &#123;</span><br><span class="line">        assertEquals(testInfo.getDisplayName(), <span class="string">&quot;Details... :: repetition 1 of 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RepeatedTest(value = 5, name = &quot;Wiederholung &#123;currentRepetition&#125; von &#123;totalRepetitions&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">repeatedTestInGerman</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å‚æ•°åŒ–æµ‹è¯•"><a href="#å‚æ•°åŒ–æµ‹è¯•" class="headerlink" title="å‚æ•°åŒ–æµ‹è¯•"></a>å‚æ•°åŒ–æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ParameterizedTest</span></span><br><span class="line"><span class="meta">@ValueSource(strings = &#123; &quot;racecar&quot;, &quot;radar&quot;, &quot;able was I ere I saw elba&quot; &#125;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">palindromes</span><span class="params">(String candidate)</span> &#123;</span><br><span class="line">    assertTrue(isPalindrome(candidate));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/junit-team/junit5">Junit5 Github</a></li>
<li><a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/">Junit5 å®˜æ–¹ç”¨æˆ·æ‰‹å†Œ</a></li>
<li><a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/api/">Junit5 Javadoc</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/junit-team/junit5-samples">Junit5 å®˜æ–¹ç¤ºä¾‹</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/f2c6f5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/f2c6f5/" class="post-title-link" itemprop="url">Mockito å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">æµ‹è¯•</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>11 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Mockito-å¿«é€Ÿå…¥é—¨"><a href="#Mockito-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Mockito å¿«é€Ÿå…¥é—¨"></a>Mockito å¿«é€Ÿå…¥é—¨</h1><blockquote>
<p>Mockito æ˜¯ä¸€ä¸ªé’ˆå¯¹ Java çš„ mock æ¡†æ¶ã€‚</p>
</blockquote>
<h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><p>å¦‚æœéœ€è¦å¾€ä¸‹å­¦ä¹ ï¼Œä½ éœ€è¦å…ˆç†è§£ Junit æ¡†æ¶ä¸­çš„å•å…ƒæµ‹è¯•ã€‚</p>
<p>å¦‚æœä½ ä¸ç†Ÿæ‚‰ JUnitï¼Œè¯·çœ‹ <a target="_blank" rel="noopener" href="http://www.vogella.com/tutorials/JUnit/article.html">Junit æ•™ç¨‹</a></p>
<h2 id="ä½¿ç”¨-mock-å¯¹è±¡æ¥è¿›è¡Œæµ‹è¯•"><a href="#ä½¿ç”¨-mock-å¯¹è±¡æ¥è¿›è¡Œæµ‹è¯•" class="headerlink" title="ä½¿ç”¨ mock å¯¹è±¡æ¥è¿›è¡Œæµ‹è¯•"></a>ä½¿ç”¨ mock å¯¹è±¡æ¥è¿›è¡Œæµ‹è¯•</h2><h3 id="å•å…ƒæµ‹è¯•çš„ç›®æ ‡å’ŒæŒ‘æˆ˜"><a href="#å•å…ƒæµ‹è¯•çš„ç›®æ ‡å’ŒæŒ‘æˆ˜" class="headerlink" title="å•å…ƒæµ‹è¯•çš„ç›®æ ‡å’ŒæŒ‘æˆ˜"></a>å•å…ƒæµ‹è¯•çš„ç›®æ ‡å’ŒæŒ‘æˆ˜</h3><p>å•å…ƒæµ‹è¯•çš„æ€è·¯æ˜¯åœ¨ä¸æ¶‰åŠä¾èµ–å…³ç³»çš„æƒ…å†µä¸‹æµ‹è¯•ä»£ç ï¼ˆéš”ç¦»æ€§ï¼‰ï¼Œæ‰€ä»¥æµ‹è¯•ä»£ç ä¸å…¶ä»–ç±»æˆ–è€…ç³»ç»Ÿçš„å…³ç³»åº”è¯¥å°½é‡è¢«æ¶ˆé™¤ã€‚ä¸€ä¸ªå¯è¡Œçš„æ¶ˆé™¤æ–¹æ³•æ˜¯æ›¿æ¢æ‰ä¾èµ–ç±»ï¼ˆæµ‹è¯•æ›¿æ¢ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›¿èº«æ¥æ›¿æ¢æ‰çœŸæ­£çš„ä¾èµ–å¯¹è±¡ã€‚</p>
<h3 id="æµ‹è¯•ç±»çš„åˆ†ç±»"><a href="#æµ‹è¯•ç±»çš„åˆ†ç±»" class="headerlink" title="æµ‹è¯•ç±»çš„åˆ†ç±»"></a>æµ‹è¯•ç±»çš„åˆ†ç±»</h3><ul>
<li><strong>dummy object</strong> åšä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ä½†æ˜¯ç»å¯¹ä¸ä¼šè¢«ä½¿ç”¨ã€‚è­¬å¦‚è¯´ï¼Œè¿™ç§æµ‹è¯•ç±»å†…éƒ¨çš„æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼Œæˆ–è€…æ˜¯ç”¨æ¥å¡«å……æŸä¸ªæ–¹æ³•çš„å‚æ•°ã€‚</li>
<li><strong>Fake</strong> æ˜¯çœŸæ­£æ¥å£æˆ–æŠ½è±¡ç±»çš„å®ç°ä½“ï¼Œä½†ç»™å¯¹è±¡å†…éƒ¨å®ç°å¾ˆç®€å•ã€‚è­¬å¦‚è¯´ï¼Œå®ƒå­˜åœ¨å†…å­˜ä¸­è€Œä¸æ˜¯çœŸæ­£çš„æ•°æ®åº“ä¸­ã€‚ï¼ˆè¯‘è€…æ³¨ï¼š<strong>Fake</strong> å®ç°äº†çœŸæ­£çš„é€»è¾‘ï¼Œä½†å®ƒçš„å­˜åœ¨åªæ˜¯ä¸ºäº†æµ‹è¯•ï¼Œè€Œä¸é€‚åˆäºç”¨åœ¨äº§å“ä¸­ã€‚ï¼‰</li>
<li><strong>stub</strong> ç±»æ˜¯ä¾èµ–ç±»çš„éƒ¨åˆ†æ–¹æ³•å®ç°ï¼Œè€Œè¿™äº›æ–¹æ³•åœ¨ä½ æµ‹è¯•ç±»å’Œæ¥å£çš„æ—¶å€™ä¼šè¢«ç”¨åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´ <strong>stub</strong> ç±»åœ¨æµ‹è¯•ä¸­ä¼šè¢«å®ä¾‹åŒ–ã€‚<strong>stub</strong> ç±»ä¼šå›åº”ä»»ä½•å¤–éƒ¨æµ‹è¯•çš„è°ƒç”¨ã€‚<strong>stub</strong> ç±»æœ‰æ—¶å€™è¿˜ä¼šè®°å½•è°ƒç”¨çš„ä¸€äº›ä¿¡æ¯ã€‚</li>
<li><strong>mock object</strong> æ˜¯æŒ‡ç±»æˆ–è€…æ¥å£çš„æ¨¡æ‹Ÿå®ç°ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰è¿™ä¸ªå¯¹è±¡ä¸­æŸä¸ªæ–¹æ³•çš„è¾“å‡ºç»“æœã€‚</li>
</ul>
<p>æµ‹è¯•æ›¿ä»£æŠ€æœ¯èƒ½å¤Ÿåœ¨æµ‹è¯•ä¸­æ¨¡æ‹Ÿæµ‹è¯•ç±»ä»¥å¤–å¯¹è±¡ã€‚å› æ­¤ä½ å¯ä»¥éªŒè¯æµ‹è¯•ç±»æ˜¯å¦å“åº”æ­£å¸¸ã€‚è­¬å¦‚è¯´ï¼Œä½ å¯ä»¥éªŒè¯åœ¨ Mock å¯¹è±¡çš„æŸä¸€ä¸ªæ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ã€‚è¿™å¯ä»¥ç¡®ä¿éš”ç¦»äº†å¤–éƒ¨ä¾èµ–çš„å¹²æ‰°åªæµ‹è¯•æµ‹è¯•ç±»ã€‚</p>
<p>æˆ‘ä»¬é€‰æ‹© Mock å¯¹è±¡çš„åŸå› æ˜¯å› ä¸º Mock å¯¹è±¡åªéœ€è¦å°‘é‡ä»£ç çš„é…ç½®ã€‚</p>
<h3 id="Mock-å¯¹è±¡çš„äº§ç”Ÿ"><a href="#Mock-å¯¹è±¡çš„äº§ç”Ÿ" class="headerlink" title="Mock å¯¹è±¡çš„äº§ç”Ÿ"></a>Mock å¯¹è±¡çš„äº§ç”Ÿ</h3><p>ä½ å¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª Mock å¯¹è±¡æˆ–è€…ä½¿ç”¨ Mock æ¡†æ¶æ¥æ¨¡æ‹Ÿè¿™äº›ç±»ï¼ŒMock æ¡†æ¶å…è®¸ä½ åœ¨è¿è¡Œæ—¶åˆ›å»º Mock å¯¹è±¡å¹¶ä¸”å®šä¹‰å®ƒçš„è¡Œä¸ºã€‚</p>
<p>ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯æŠŠ Mock å¯¹è±¡æ¨¡æ‹Ÿæˆæ•°æ®çš„æä¾›è€…ã€‚åœ¨æ­£å¼çš„ç”Ÿäº§ç¯å¢ƒä¸­å®ƒä¼šè¢«å®ç°ç”¨æ¥è¿æ¥æ•°æ®æºã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™ Mock å¯¹è±¡å°†ä¼šæ¨¡æ‹Ÿæˆæ•°æ®æä¾›è€…æ¥ç¡®ä¿æˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒå§‹ç»ˆæ˜¯ç›¸åŒçš„ã€‚</p>
<p>Mock å¯¹è±¡å¯ä»¥è¢«æä¾›æ¥è¿›è¡Œæµ‹è¯•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æµ‹è¯•çš„ç±»åº”è¯¥é¿å…ä»»ä½•å¤–éƒ¨æ•°æ®çš„å¼ºä¾èµ–ã€‚</p>
<p>é€šè¿‡ Mock å¯¹è±¡æˆ–è€… Mock æ¡†æ¶ï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä»£ç ä¸­æœŸæœ›çš„è¡Œä¸ºã€‚è­¬å¦‚è¯´ï¼ŒéªŒè¯åªæœ‰æŸä¸ªå­˜åœ¨ Mock å¯¹è±¡çš„æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨äº†ã€‚</p>
<h3 id="ä½¿ç”¨-Mockito-ç”Ÿæˆ-Mock-å¯¹è±¡"><a href="#ä½¿ç”¨-Mockito-ç”Ÿæˆ-Mock-å¯¹è±¡" class="headerlink" title="ä½¿ç”¨ Mockito ç”Ÿæˆ Mock å¯¹è±¡"></a>ä½¿ç”¨ Mockito ç”Ÿæˆ Mock å¯¹è±¡</h3><p><em>Mockito</em> æ˜¯ä¸€ä¸ªæµè¡Œ mock æ¡†æ¶ï¼Œå¯ä»¥å’Œ JUnit ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚Mockito å…è®¸ä½ åˆ›å»ºå’Œé…ç½® mock å¯¹è±¡ã€‚ä½¿ç”¨ Mockito å¯ä»¥æ˜æ˜¾çš„ç®€åŒ–å¯¹å¤–éƒ¨ä¾èµ–çš„æµ‹è¯•ç±»çš„å¼€å‘ã€‚</p>
<p>ä¸€èˆ¬ä½¿ç”¨ Mockito éœ€è¦æ‰§è¡Œä¸‹é¢ä¸‰æ­¥</p>
<ol>
<li>æ¨¡æ‹Ÿå¹¶æ›¿æ¢æµ‹è¯•ä»£ç ä¸­å¤–éƒ¨ä¾èµ–</li>
<li>æ‰§è¡Œæµ‹è¯•ä»£ç </li>
<li>éªŒè¯æµ‹è¯•ä»£ç æ˜¯å¦è¢«æ­£ç¡®çš„æ‰§è¡Œ 0</li>
</ol>
<h2 id="ä¸ºè‡ªå·±çš„é¡¹ç›®æ·»åŠ -Mockito-ä¾èµ–"><a href="#ä¸ºè‡ªå·±çš„é¡¹ç›®æ·»åŠ -Mockito-ä¾èµ–" class="headerlink" title="ä¸ºè‡ªå·±çš„é¡¹ç›®æ·»åŠ  Mockito ä¾èµ–"></a>ä¸ºè‡ªå·±çš„é¡¹ç›®æ·»åŠ  Mockito ä¾èµ–</h2><h3 id="åœ¨-Gradle-æ·»åŠ -Mockito-ä¾èµ–"><a href="#åœ¨-Gradle-æ·»åŠ -Mockito-ä¾èµ–" class="headerlink" title="åœ¨ Gradle æ·»åŠ  Mockito ä¾èµ–"></a>åœ¨ Gradle æ·»åŠ  Mockito ä¾èµ–</h3><p>å¦‚æœä½ çš„é¡¹ç›®ä½¿ç”¨ Gradle æ„å»ºï¼Œå°†ä¸‹é¢ä»£ç åŠ å…¥ Gradle çš„æ„å»ºæ–‡ä»¶ä¸­ä¸ºè‡ªå·±é¡¹ç›®æ·»åŠ  Mockito ä¾èµ–</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">repositories</span> &#123; jcenter() &#125;</span><br><span class="line"><span class="keyword">dependencies</span> &#123; testCompile <span class="string">&quot;org.mockito:mockito-core:2.0.57-beta&quot;</span> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="åœ¨-Maven-æ·»åŠ -Mockito-ä¾èµ–"><a href="#åœ¨-Maven-æ·»åŠ -Mockito-ä¾èµ–" class="headerlink" title="åœ¨ Maven æ·»åŠ  Mockito ä¾èµ–"></a>åœ¨ Maven æ·»åŠ  Mockito ä¾èµ–</h3><p>éœ€è¦åœ¨ Maven å£°æ˜ä¾èµ–ï¼Œæ‚¨å¯ä»¥åœ¨ <a target="_blank" rel="noopener" href="http://search.maven.org/">http://search.maven.org</a> ç½‘ç«™ä¸­æœç´¢ <code>g:&quot;org.mockito&quot;, a:&quot;mockito-core&quot;</code> æ¥å¾—åˆ°å…·ä½“çš„å£°æ˜æ–¹å¼ã€‚</p>
<h3 id="åœ¨-Eclipse-IDE-ä½¿ç”¨-Mockito"><a href="#åœ¨-Eclipse-IDE-ä½¿ç”¨-Mockito" class="headerlink" title="åœ¨ Eclipse IDE ä½¿ç”¨ Mockito"></a>åœ¨ Eclipse IDE ä½¿ç”¨ Mockito</h3><p>Eclipse IDE æ”¯æŒ Gradle å’Œ Maven ä¸¤ç§æ„å»ºå·¥å…·ï¼Œæ‰€ä»¥åœ¨ Eclipse IDE æ·»åŠ ä¾èµ–å–å†³ä½ ä½¿ç”¨çš„æ˜¯å“ªä¸€ä¸ªæ„å»ºå·¥å…·ã€‚</p>
<h3 id="ä»¥-OSGi-æˆ–è€…-Eclipse-æ’ä»¶å½¢å¼æ·»åŠ -Mockito-ä¾èµ–"><a href="#ä»¥-OSGi-æˆ–è€…-Eclipse-æ’ä»¶å½¢å¼æ·»åŠ -Mockito-ä¾èµ–" class="headerlink" title="ä»¥ OSGi æˆ–è€… Eclipse æ’ä»¶å½¢å¼æ·»åŠ  Mockito ä¾èµ–"></a>ä»¥ OSGi æˆ–è€… Eclipse æ’ä»¶å½¢å¼æ·»åŠ  Mockito ä¾èµ–</h3><p>åœ¨ Eclipse RCP åº”ç”¨ä¾èµ–é€šå¸¸å¯ä»¥åœ¨ p2 update ä¸Šå¾—åˆ°ã€‚Orbit æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç¬¬ä¸‰æ–¹ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢å¯»æ‰¾èƒ½åœ¨ Eclipse ä¸Šä½¿ç”¨çš„åº”ç”¨å’Œæ’ä»¶ã€‚</p>
<p>Orbit ä»“åº“åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://download.eclipse.org/tools/orbit/downloads">http://download.eclipse.org/tools/orbit/downloads</a></p>
<h2 id="ä½¿ç”¨-Mockito-API"><a href="#ä½¿ç”¨-Mockito-API" class="headerlink" title="ä½¿ç”¨ Mockito API"></a>ä½¿ç”¨ Mockito API</h2><h3 id="é™æ€å¼•ç”¨"><a href="#é™æ€å¼•ç”¨" class="headerlink" title="é™æ€å¼•ç”¨"></a>é™æ€å¼•ç”¨</h3><p>å¦‚æœåœ¨ä»£ç ä¸­é™æ€å¼•ç”¨äº†<code>org.mockito.Mockito.*;</code>ï¼Œé‚£ä½ ä½ å°±å¯ä»¥ç›´æ¥è°ƒç”¨é™æ€æ–¹æ³•å’Œé™æ€å˜é‡è€Œä¸ç”¨åˆ›å»ºå¯¹è±¡ï¼Œè­¬å¦‚ç›´æ¥è°ƒç”¨ mock() æ–¹æ³•ã€‚</p>
<h3 id="ä½¿ç”¨-Mockito-åˆ›å»ºå’Œé…ç½®-mock-å¯¹è±¡"><a href="#ä½¿ç”¨-Mockito-åˆ›å»ºå’Œé…ç½®-mock-å¯¹è±¡" class="headerlink" title="ä½¿ç”¨ Mockito åˆ›å»ºå’Œé…ç½® mock å¯¹è±¡"></a>ä½¿ç”¨ Mockito åˆ›å»ºå’Œé…ç½® mock å¯¹è±¡</h3><p>é™¤äº†ä¸Šé¢æ‰€è¯´çš„ä½¿ç”¨ mock() é™æ€æ–¹æ³•å¤–ï¼ŒMockito è¿˜æ”¯æŒé€šè¿‡ <code>@Mock</code> æ³¨è§£çš„æ–¹å¼æ¥åˆ›å»º mock å¯¹è±¡ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨æ³¨è§£ï¼Œé‚£ä¹ˆå¿…é¡»è¦å®ä¾‹åŒ– mock å¯¹è±¡ã€‚Mockito åœ¨é‡åˆ°ä½¿ç”¨æ³¨è§£çš„å­—æ®µçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨<code>MockitoAnnotations.initMocks(this)</code> æ¥åˆå§‹åŒ–è¯¥ mock å¯¹è±¡ã€‚å¦å¤–ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨<code>@RunWith(MockitoJUnitRunner.class)</code>æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚</p>
<p>é€šè¿‡ä¸‹é¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ä½¿ç”¨<code>@Mock</code> çš„æ–¹æ³•å’Œ<code>MockitoRule</code>è§„åˆ™ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MockitoTest</span>  &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Mock</span></span><br><span class="line">        MyDatabase databaseMock; (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Rule</span> <span class="keyword">public</span> <span class="type">MockitoRule</span> <span class="variable">mockitoRule</span> <span class="operator">=</span> MockitoJUnit.rule(); (<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQuery</span><span class="params">()</span>  &#123;</span><br><span class="line">                <span class="type">ClassToTest</span> <span class="variable">t</span>  <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassToTest</span>(databaseMock); (<span class="number">3</span>)</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">check</span> <span class="operator">=</span> t.query(<span class="string">&quot;* from t&quot;</span>); (<span class="number">4</span>)</span><br><span class="line">                assertTrue(check); (<span class="number">5</span>)</span><br><span class="line">                verify(databaseMock).query(<span class="string">&quot;* from t&quot;</span>); (<span class="number">6</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>å‘Šè¯‰ Mockito æ¨¡æ‹Ÿ databaseMock å®ä¾‹</li>
<li>Mockito é€šè¿‡ @mock æ³¨è§£åˆ›å»º mock å¯¹è±¡</li>
<li>ä½¿ç”¨å·²ç»åˆ›å»ºçš„ mock åˆå§‹åŒ–è¿™ä¸ªç±»</li>
<li>åœ¨æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œæ‰§è¡Œæµ‹è¯•ç±»ä¸­çš„ä»£ç </li>
<li>ä½¿ç”¨æ–­è¨€ç¡®ä¿è°ƒç”¨çš„æ–¹æ³•è¿”å›å€¼ä¸º true</li>
<li>éªŒè¯ query æ–¹æ³•æ˜¯å¦è¢« <code>MyDatabase</code> çš„ mock å¯¹è±¡è°ƒç”¨</li>
</ol>
<h3 id="é…ç½®-mock"><a href="#é…ç½®-mock" class="headerlink" title="é…ç½® mock"></a>é…ç½® mock</h3><p>å½“æˆ‘ä»¬éœ€è¦é…ç½®æŸä¸ªæ–¹æ³•çš„è¿”å›å€¼çš„æ—¶å€™ï¼ŒMockito æä¾›äº†é“¾å¼çš„ API ä¾›æˆ‘ä»¬æ–¹ä¾¿çš„è°ƒç”¨</p>
<p><code>when(â€¦.).thenReturn(â€¦.)</code>å¯ä»¥è¢«ç”¨æ¥å®šä¹‰å½“æ¡ä»¶æ»¡è¶³æ—¶å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœä½ éœ€è¦å®šä¹‰å¤šä¸ªè¿”å›å€¼ï¼Œå¯ä»¥å¤šæ¬¡å®šä¹‰ã€‚å½“ä½ å¤šæ¬¡è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼ŒMockito ä¼šæ ¹æ®ä½ å®šä¹‰çš„å…ˆåé¡ºåºæ¥è¿”å›è¿”å›å€¼ã€‚Mocks è¿˜å¯ä»¥æ ¹æ®ä¼ å…¥å‚æ•°çš„ä¸åŒæ¥å®šä¹‰ä¸åŒçš„è¿”å›å€¼ã€‚è­¬å¦‚è¯´ä½ çš„å‡½æ•°å¯ä»¥å°†<code>anyString</code> æˆ–è€… <code>anyInt</code>ä½œä¸ºè¾“å…¥å‚æ•°ï¼Œç„¶åå®šä¹‰å…¶ç‰¹å®šçš„æ”¾å›å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>  &#123;</span><br><span class="line">        <span class="comment">//  åˆ›å»º mock</span></span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">test</span> <span class="operator">=</span> Mockito.mock(MyClass.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰ getUniqueId() çš„è¿”å›å€¼</span></span><br><span class="line">        when(test.getUniqueId()).thenReturn(<span class="number">43</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æµ‹è¯•ä¸­ä½¿ç”¨mockå¯¹è±¡</span></span><br><span class="line">        assertEquals(test.getUniqueId(), <span class="number">43</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›å¤šä¸ªå€¼</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMoreThanOneReturnValue</span><span class="params">()</span>  &#123;</span><br><span class="line">        Iterator i= mock(Iterator.class);</span><br><span class="line">        when(i.next()).thenReturn(<span class="string">&quot;Mockito&quot;</span>).thenReturn(<span class="string">&quot;rocks&quot;</span>);</span><br><span class="line">        String result=i.next()+<span class="string">&quot; &quot;</span>+i.next();</span><br><span class="line">        <span class="comment">// æ–­è¨€</span></span><br><span class="line">        assertEquals(<span class="string">&quot;Mockito rocks&quot;</span>, result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚ä½•æ ¹æ®è¾“å…¥æ¥è¿”å›å€¼</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReturnValueDependentOnMethodParameter</span><span class="params">()</span>  &#123;</span><br><span class="line">        Comparable c= mock(Comparable.class);</span><br><span class="line">        when(c.compareTo(<span class="string">&quot;Mockito&quot;</span>)).thenReturn(<span class="number">1</span>);</span><br><span class="line">        when(c.compareTo(<span class="string">&quot;Eclipse&quot;</span>)).thenReturn(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">// æ–­è¨€</span></span><br><span class="line">        assertEquals(<span class="number">1</span>,c.compareTo(<span class="string">&quot;Mockito&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚ä½•è®©è¿”å›å€¼ä¸ä¾èµ–äºè¾“å…¥</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReturnValueInDependentOnMethodParameter</span><span class="params">()</span>  &#123;</span><br><span class="line">        Comparable c= mock(Comparable.class);</span><br><span class="line">        when(c.compareTo(anyInt())).thenReturn(-<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// æ–­è¨€</span></span><br><span class="line">        assertEquals(-<span class="number">1</span> ,c.compareTo(<span class="number">9</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®å‚æ•°ç±»å‹æ¥è¿”å›å€¼</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReturnValueInDependentOnMethodParameter</span><span class="params">()</span>  &#123;</span><br><span class="line">        Comparable c= mock(Comparable.class);</span><br><span class="line">        when(c.compareTo(isA(Todo.class))).thenReturn(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// æ–­è¨€</span></span><br><span class="line">        <span class="type">Todo</span> <span class="variable">todo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Todo</span>(<span class="number">5</span>);</span><br><span class="line">        assertEquals(todo ,c.compareTo(<span class="keyword">new</span> <span class="title class_">Todo</span>(<span class="number">1</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹äºæ— è¿”å›å€¼çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>doReturn(â€¦).when(â€¦).methodCall</code>æ¥è·å¾—ç±»ä¼¼çš„æ•ˆæœã€‚ä¾‹å¦‚æˆ‘ä»¬æƒ³åœ¨è°ƒç”¨æŸäº›æ— è¿”å›å€¼å‡½æ•°çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>doThrow</code> æ–¹æ³•ã€‚å¦‚ä¸‹é¢ä»£ç ç‰‡æ®µæ‰€ç¤º</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢æµ‹è¯•ç”¨ä¾‹æè¿°äº†å¦‚ä½•ä½¿ç”¨doThrow()æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test(expected=IOException.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testForIOException</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºå¹¶é…ç½® mock å¯¹è±¡</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">mockStream</span> <span class="operator">=</span> mock(OutputStream.class);</span><br><span class="line">        doThrow(<span class="keyword">new</span> <span class="title class_">IOException</span>()).when(mockStream).close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨ mock</span></span><br><span class="line">        OutputStreamWriter streamWriter= <span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(mockStream);</span><br><span class="line">        streamWriter.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="éªŒè¯-mock-å¯¹è±¡æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨"><a href="#éªŒè¯-mock-å¯¹è±¡æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨" class="headerlink" title="éªŒè¯ mock å¯¹è±¡æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨"></a>éªŒè¯ mock å¯¹è±¡æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨</h3><p>Mockito ä¼šè·Ÿè¸ª mock å¯¹è±¡é‡Œé¢æ‰€æœ‰çš„æ–¹æ³•å’Œå˜é‡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨æ¥éªŒè¯å‡½æ•°åœ¨ä¼ å…¥ç‰¹å®šå‚æ•°çš„æ—¶å€™æ˜¯å¦è¢«è°ƒç”¨ã€‚è¿™ç§æ–¹å¼çš„æµ‹è¯•ç§°è¡Œä¸ºæµ‹è¯•ï¼Œè¡Œä¸ºæµ‹è¯•å¹¶ä¸ä¼šæ£€æŸ¥å‡½æ•°çš„è¿”å›å€¼ï¼Œè€Œæ˜¯æ£€æŸ¥åœ¨ä¼ å…¥æ­£ç¡®å‚æ•°æ—¶å€™å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testVerify</span><span class="params">()</span>  &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºå¹¶é…ç½® mock å¯¹è±¡</span></span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">test</span> <span class="operator">=</span> Mockito.mock(MyClass.class);</span><br><span class="line">        when(test.getUniqueId()).thenReturn(<span class="number">43</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨mockå¯¹è±¡é‡Œé¢çš„æ–¹æ³•å¹¶ä¼ å…¥å‚æ•°ä¸º12</span></span><br><span class="line">        test.testing(<span class="number">12</span>);</span><br><span class="line">        test.getUniqueId();</span><br><span class="line">        test.getUniqueId();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŸ¥çœ‹åœ¨ä¼ å…¥å‚æ•°ä¸º12çš„æ—¶å€™æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨</span></span><br><span class="line">        verify(test).testing(Matchers.eq(<span class="number">12</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ä¸¤æ¬¡</span></span><br><span class="line">        verify(test, times(<span class="number">2</span>)).getUniqueId();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…¶ä»–ç”¨æ¥éªŒè¯å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">        verify(mock, never()).someMethod(<span class="string">&quot;never called&quot;</span>);</span><br><span class="line">        verify(mock, atLeastOnce()).someMethod(<span class="string">&quot;called at least once&quot;</span>);</span><br><span class="line">        verify(mock, atLeast(<span class="number">2</span>)).someMethod(<span class="string">&quot;called at least twice&quot;</span>);</span><br><span class="line">        verify(mock, times(<span class="number">5</span>)).someMethod(<span class="string">&quot;called five times&quot;</span>);</span><br><span class="line">        verify(mock, atMost(<span class="number">3</span>)).someMethod(<span class="string">&quot;called at most 3 times&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-Spy-å°è£…-java-å¯¹è±¡"><a href="#ä½¿ç”¨-Spy-å°è£…-java-å¯¹è±¡" class="headerlink" title="ä½¿ç”¨ Spy å°è£… java å¯¹è±¡"></a>ä½¿ç”¨ Spy å°è£… java å¯¹è±¡</h3><p>@Spy æˆ–è€…<code>spy()</code>æ–¹æ³•å¯ä»¥è¢«ç”¨æ¥å°è£… java å¯¹è±¡ã€‚è¢«å°è£…åï¼Œé™¤éç‰¹æ®Šå£°æ˜ï¼ˆæ‰“æ¡© _stub_ï¼‰ï¼Œå¦åˆ™éƒ½ä¼šçœŸæ­£çš„è°ƒç”¨å¯¹è±¡é‡Œé¢çš„æ¯ä¸€ä¸ªæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lets mock a LinkedList</span></span><br><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>();</span><br><span class="line"><span class="type">List</span> <span class="variable">spy</span> <span class="operator">=</span> spy(list);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ç”¨ doReturn() æ¥æ‰“æ¡©</span></span><br><span class="line">doReturn(<span class="string">&quot;foo&quot;</span>).when(spy).get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢ä»£ç ä¸ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment">// çœŸæ­£çš„æ–¹æ³•ä¼šè¢«è°ƒç”¨</span></span><br><span class="line"><span class="comment">// å°†ä¼šæŠ›å‡º IndexOutOfBoundsException çš„å¼‚å¸¸ï¼Œå› ä¸º List ä¸ºç©º</span></span><br><span class="line">when(spy.get(<span class="number">0</span>)).thenReturn(<span class="string">&quot;foo&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•<code>verifyNoMoreInteractions()</code>å…è®¸ä½ æ£€æŸ¥æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•è¢«è°ƒç”¨äº†ã€‚</p>
<h3 id="ä½¿ç”¨-InjectMocks-åœ¨-Mockito-ä¸­è¿›è¡Œä¾èµ–æ³¨å…¥"><a href="#ä½¿ç”¨-InjectMocks-åœ¨-Mockito-ä¸­è¿›è¡Œä¾èµ–æ³¨å…¥" class="headerlink" title="ä½¿ç”¨ @InjectMocks åœ¨ Mockito ä¸­è¿›è¡Œä¾èµ–æ³¨å…¥"></a>ä½¿ç”¨ @InjectMocks åœ¨ Mockito ä¸­è¿›è¡Œä¾èµ–æ³¨å…¥</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>@InjectMocks</code> æ³¨è§£æ¥åˆ›å»ºå¯¹è±¡ï¼Œå®ƒä¼šæ ¹æ®ç±»å‹æ¥æ³¨å…¥å¯¹è±¡é‡Œé¢çš„æˆå‘˜æ–¹æ³•å’Œå˜é‡ã€‚å‡å®šæˆ‘ä»¬æœ‰ ArticleManager ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArticleManager</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">    <span class="keyword">private</span> ArticleDatabase database;</span><br><span class="line"></span><br><span class="line">    ArticleManager(User user) &#123;</span><br><span class="line">     <span class="built_in">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setDatabase</span><span class="params">(ArticleDatabase database)</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç±»ä¼šè¢« Mockito æ„é€ ï¼Œè€Œç±»çš„æˆå‘˜æ–¹æ³•å’Œå˜é‡éƒ½ä¼šè¢« mock å¯¹è±¡æ‰€ä»£æ›¿ï¼Œæ­£å¦‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(MockitoJUnitRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArticleManagerTest</span>  &#123;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Mock</span> ArticleCalculator calculator;</span><br><span class="line">       <span class="meta">@Mock</span> ArticleDatabase database;</span><br><span class="line">       <span class="meta">@Most</span> User user;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Spy</span> <span class="keyword">private</span> <span class="type">UserProvider</span> <span class="variable">userProvider</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConsumerUserProvider</span>();</span><br><span class="line"></span><br><span class="line">       <span class="meta">@InjectMocks</span> <span class="keyword">private</span> ArticleManager manager; (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Test</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shouldDoSomething</span><span class="params">()</span> &#123;</span><br><span class="line">               <span class="comment">// å‡å®š ArticleManager æœ‰ä¸€ä¸ªå« initialize() çš„æ–¹æ³•è¢«è°ƒç”¨äº†</span></span><br><span class="line">               <span class="comment">// ä½¿ç”¨ ArticleListener æ¥è°ƒç”¨ addListener æ–¹æ³•</span></span><br><span class="line">               manager.initialize();</span><br><span class="line"></span><br><span class="line">               <span class="comment">// éªŒè¯ addListener æ–¹æ³•è¢«è°ƒç”¨</span></span><br><span class="line">               verify(database).addListener(any(ArticleListener.class));</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ›å»º ArticleManager å®ä¾‹å¹¶æ³¨å…¥ Mock å¯¹è±¡</li>
</ol>
<p>æ›´å¤šçš„è¯¦æƒ…å¯ä»¥æŸ¥çœ‹ <a target="_blank" rel="noopener" href="http://docs.mockito.googlecode.com/hg/1.9.5/org/mockito/InjectMocks.html">http://docs.mockito.googlecode.com/hg/1.9.5/org/mockito/InjectMocks.html</a></p>
<h3 id="æ•æ‰å‚æ•°"><a href="#æ•æ‰å‚æ•°" class="headerlink" title="æ•æ‰å‚æ•°"></a>æ•æ‰å‚æ•°</h3><p><code>ArgumentCaptor</code>ç±»å…è®¸æˆ‘ä»¬åœ¨ verification æœŸé—´è®¿é—®æ–¹æ³•çš„å‚æ•°ã€‚å¾—åˆ°æ–¹æ³•çš„å‚æ•°åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒè¿›è¡Œæµ‹è¯•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.hamcrest.Matchers.hasItem;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertThat;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.mock;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.verify;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Rule;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.mockito.ArgumentCaptor;</span><br><span class="line"><span class="keyword">import</span> org.mockito.Captor;</span><br><span class="line"><span class="keyword">import</span> org.mockito.junit.MockitoJUnit;</span><br><span class="line"><span class="keyword">import</span> org.mockito.junit.MockitoRule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MockitoTests</span> &#123;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">MockitoRule</span> <span class="variable">rule</span> <span class="operator">=</span> MockitoJUnit.rule();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Captor</span></span><br><span class="line">    <span class="keyword">private</span> ArgumentCaptor&lt;List&lt;String&gt;&gt; captor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">shouldContainCertainListItem</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; asList = Arrays.asList(<span class="string">&quot;someElement_test&quot;</span>, <span class="string">&quot;someElement&quot;</span>);</span><br><span class="line">        <span class="keyword">final</span> List&lt;String&gt; mockedList = mock(List.class);</span><br><span class="line">        mockedList.addAll(asList);</span><br><span class="line"></span><br><span class="line">        verify(mockedList).addAll(captor.capture());</span><br><span class="line">        <span class="keyword">final</span> List&lt;String&gt; capturedArgument = captor.getValue();</span><br><span class="line">        assertThat(capturedArgument, hasItem(<span class="string">&quot;someElement&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Mockito-çš„é™åˆ¶"><a href="#Mockito-çš„é™åˆ¶" class="headerlink" title="Mockito çš„é™åˆ¶"></a>Mockito çš„é™åˆ¶</h3><p>Mockito å½“ç„¶ä¹Ÿæœ‰ä¸€å®šçš„é™åˆ¶ã€‚è€Œä¸‹é¢ä¸‰ç§æ•°æ®ç±»å‹åˆ™ä¸èƒ½å¤Ÿè¢«æµ‹è¯•</p>
<ul>
<li>final classes</li>
<li>anonymous classes</li>
<li>primitive types</li>
</ul>
<h2 id="åœ¨-Android-ä¸­ä½¿ç”¨-Mockito"><a href="#åœ¨-Android-ä¸­ä½¿ç”¨-Mockito" class="headerlink" title="åœ¨ Android ä¸­ä½¿ç”¨ Mockito"></a>åœ¨ Android ä¸­ä½¿ç”¨ Mockito</h2><p>åœ¨ Android ä¸­çš„ Gradle æ„å»ºæ–‡ä»¶ä¸­åŠ å…¥ Mockito ä¾èµ–åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ Mockito äº†ã€‚è‹¥æƒ³ä½¿ç”¨ Android Instrumented tests çš„è¯ï¼Œè¿˜éœ€è¦æ·»åŠ  dexmaker å’Œ dexmaker-mockito ä¾èµ–åˆ° Gradle çš„æ„å»ºæ–‡ä»¶ä¸­ã€‚ï¼ˆéœ€è¦ Mockito 1.9.5 ç‰ˆæœ¬ä»¥ä¸Šï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    testCompile <span class="string">&#x27;junit:junit:4.12&#x27;</span></span><br><span class="line">    <span class="comment">// Mockito unit test çš„ä¾èµ–</span></span><br><span class="line">    testCompile <span class="string">&#x27;org.mockito:mockito-core:1.+&#x27;</span></span><br><span class="line">    <span class="comment">// Mockito Android instrumentation tests çš„ä¾èµ–</span></span><br><span class="line">    androidTestCompile <span class="string">&#x27;org.mockito:mockito-core:1.+&#x27;</span></span><br><span class="line">    androidTestCompile <span class="string">&quot;com.google.dexmaker:dexmaker:1.2&quot;</span></span><br><span class="line">    androidTestCompile <span class="string">&quot;com.google.dexmaker:dexmaker-mockito:1.2&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®ä¾‹ï¼šä½¿ç”¨-Mockito-å†™ä¸€ä¸ª-Instrumented-Unit-Test"><a href="#å®ä¾‹ï¼šä½¿ç”¨-Mockito-å†™ä¸€ä¸ª-Instrumented-Unit-Test" class="headerlink" title="å®ä¾‹ï¼šä½¿ç”¨ Mockito å†™ä¸€ä¸ª Instrumented Unit Test"></a>å®ä¾‹ï¼šä½¿ç”¨ Mockito å†™ä¸€ä¸ª Instrumented Unit Test</h2><h3 id="åˆ›å»ºä¸€ä¸ªæµ‹è¯•çš„-Android-åº”ç”¨"><a href="#åˆ›å»ºä¸€ä¸ªæµ‹è¯•çš„-Android-åº”ç”¨" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæµ‹è¯•çš„ Android åº”ç”¨"></a>åˆ›å»ºä¸€ä¸ªæµ‹è¯•çš„ Android åº”ç”¨</h3><p>åˆ›å»ºä¸€ä¸ªåŒ…åä¸º<code>com.vogella.android.testing.mockito.contextmock</code>çš„ Android åº”ç”¨ï¼Œæ·»åŠ ä¸€ä¸ªé™æ€æ–¹æ³• ï¼Œæ–¹æ³•é‡Œé¢åˆ›å»ºä¸€ä¸ªåŒ…å«å‚æ•°çš„ Intentï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Intent <span class="title function_">createQuery</span><span class="params">(Context context, String query, String value)</span> &#123;</span><br><span class="line">    <span class="comment">// ç®€å•èµ·è§ï¼Œé‡ç”¨MainActivity</span></span><br><span class="line">    <span class="type">Intent</span> <span class="variable">i</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, MainActivity.class);</span><br><span class="line">    i.putExtra(<span class="string">&quot;QUERY&quot;</span>, query);</span><br><span class="line">    i.putExtra(<span class="string">&quot;VALUE&quot;</span>, value);</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åœ¨-app-build-gradle-æ–‡ä»¶ä¸­æ·»åŠ -Mockito-ä¾èµ–"><a href="#åœ¨-app-build-gradle-æ–‡ä»¶ä¸­æ·»åŠ -Mockito-ä¾èµ–" class="headerlink" title="åœ¨ app&#x2F;build.gradle æ–‡ä»¶ä¸­æ·»åŠ  Mockito ä¾èµ–"></a>åœ¨ app&#x2F;build.gradle æ–‡ä»¶ä¸­æ·»åŠ  Mockito ä¾èµ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">// Mockito å’Œ JUnit çš„ä¾èµ–</span></span><br><span class="line">    <span class="comment">// instrumentation unit tests on the JVM</span></span><br><span class="line">    androidTestCompile <span class="string">&#x27;junit:junit:4.12&#x27;</span></span><br><span class="line">    androidTestCompile <span class="string">&#x27;org.mockito:mockito-core:2.0.57-beta&#x27;</span></span><br><span class="line">    androidTestCompile <span class="string">&#x27;com.android.support.test:runner:0.3&#x27;</span></span><br><span class="line">    androidTestCompile <span class="string">&quot;com.google.dexmaker:dexmaker:1.2&quot;</span></span><br><span class="line">    androidTestCompile <span class="string">&quot;com.google.dexmaker:dexmaker-mockito:1.2&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Mockito å’Œ JUnit çš„ä¾èµ–</span></span><br><span class="line">    <span class="comment">// tests on the JVM</span></span><br><span class="line">    testCompile <span class="string">&#x27;junit:junit:4.12&#x27;</span></span><br><span class="line">    testCompile <span class="string">&#x27;org.mockito:mockito-core:1.+&#x27;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºæµ‹è¯•"><a href="#åˆ›å»ºæµ‹è¯•" class="headerlink" title="åˆ›å»ºæµ‹è¯•"></a>åˆ›å»ºæµ‹è¯•</h3><p>ä½¿ç”¨ Mockito åˆ›å»ºä¸€ä¸ªå•å…ƒæµ‹è¯•æ¥éªŒè¯åœ¨ä¼ é€’æ­£ç¡® extra data çš„æƒ…å†µä¸‹ï¼Œintent æ˜¯å¦è¢«è§¦å‘ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ Mockito æ¥ mock ä¸€ä¸ª<code>Context</code>å¯¹è±¡ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.vogella.android.testing.mockitocontextmock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.mockito.Mockito;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertEquals;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertNotNull;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextIntentCreation</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testIntentShouldBeCreated</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> Mockito.mock(Context.class);</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> MainActivity.createQuery(context, <span class="string">&quot;query&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        assertNotNull(intent);</span><br><span class="line">        <span class="type">Bundle</span> <span class="variable">extras</span> <span class="operator">=</span> intent.getExtras();</span><br><span class="line">        assertNotNull(extras);</span><br><span class="line">        assertEquals(<span class="string">&quot;query&quot;</span>, extras.getString(<span class="string">&quot;QUERY&quot;</span>));</span><br><span class="line">        assertEquals(<span class="string">&quot;value&quot;</span>, extras.getString(<span class="string">&quot;VALUE&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®ä¾‹ï¼šä½¿ç”¨-Mockito-åˆ›å»ºä¸€ä¸ª-mock-å¯¹è±¡"><a href="#å®ä¾‹ï¼šä½¿ç”¨-Mockito-åˆ›å»ºä¸€ä¸ª-mock-å¯¹è±¡" class="headerlink" title="å®ä¾‹ï¼šä½¿ç”¨ Mockito åˆ›å»ºä¸€ä¸ª mock å¯¹è±¡"></a>å®ä¾‹ï¼šä½¿ç”¨ Mockito åˆ›å»ºä¸€ä¸ª mock å¯¹è±¡</h2><h3 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>åˆ›å»ºä¸€ä¸ª Apiï¼Œå®ƒå¯ä»¥è¢« Mockito æ¥æ¨¡æ‹Ÿå¹¶åšä¸€äº›å·¥ä½œ</p>
<h3 id="åˆ›å»ºä¸€ä¸ª-Twitter-API-çš„ä¾‹å­"><a href="#åˆ›å»ºä¸€ä¸ª-Twitter-API-çš„ä¾‹å­" class="headerlink" title="åˆ›å»ºä¸€ä¸ª Twitter API çš„ä¾‹å­"></a>åˆ›å»ºä¸€ä¸ª Twitter API çš„ä¾‹å­</h3><p>å®ç° <code>TwitterClient</code>ç±»ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨åˆ°äº† <code>ITweet</code> çš„å®ç°ã€‚ä½†æ˜¯<code>ITweet</code>å®ä¾‹å¾ˆéš¾å¾—åˆ°ï¼Œè­¬å¦‚è¯´ä»–éœ€è¦å¯åŠ¨ä¸€ä¸ªå¾ˆå¤æ‚çš„æœåŠ¡æ¥å¾—åˆ°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ITweet</span> &#123;</span><br><span class="line"></span><br><span class="line">        String <span class="title function_">getMessage</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TwitterClient</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendTweet</span><span class="params">(ITweet tweet)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> tweet.getMessage();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// send the message to Twitter</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¨¡æ‹Ÿ-ITweet-çš„å®ä¾‹"><a href="#æ¨¡æ‹Ÿ-ITweet-çš„å®ä¾‹" class="headerlink" title="æ¨¡æ‹Ÿ ITweet çš„å®ä¾‹"></a>æ¨¡æ‹Ÿ ITweet çš„å®ä¾‹</h3><p>ä¸ºäº†èƒ½å¤Ÿä¸å¯åŠ¨å¤æ‚çš„æœåŠ¡æ¥å¾—åˆ° <code>ITweet</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Mockito æ¥æ¨¡æ‹Ÿå¾—åˆ°è¯¥å®ä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSendingTweet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">TwitterClient</span> <span class="variable">twitterClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TwitterClient</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">ITweet</span> <span class="variable">iTweet</span> <span class="operator">=</span> mock(ITweet.class);</span><br><span class="line"></span><br><span class="line">        when(iTweet.getMessage()).thenReturn(<span class="string">&quot;Using mockito is great&quot;</span>);</span><br><span class="line"></span><br><span class="line">        twitterClient.sendTweet(iTweet);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ <code>TwitterClient</code> å¯ä»¥ä½¿ç”¨ <code>ITweet</code> æ¥å£çš„å®ç°ï¼Œå½“è°ƒç”¨ <code>getMessage()</code> æ–¹æ³•çš„æ—¶å€™å°†ä¼šæ‰“å° â€œUsing Mockito is greatâ€ ä¿¡æ¯ã€‚</p>
<h3 id="éªŒè¯æ–¹æ³•è°ƒç”¨"><a href="#éªŒè¯æ–¹æ³•è°ƒç”¨" class="headerlink" title="éªŒè¯æ–¹æ³•è°ƒç”¨"></a>éªŒè¯æ–¹æ³•è°ƒç”¨</h3><p>ç¡®ä¿ getMessage() æ–¹æ³•è‡³å°‘è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSendingTweet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">TwitterClient</span> <span class="variable">twitterClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TwitterClient</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">ITweet</span> <span class="variable">iTweet</span> <span class="operator">=</span> mock(ITweet.class);</span><br><span class="line"></span><br><span class="line">        when(iTweet.getMessage()).thenReturn(<span class="string">&quot;Using mockito is great&quot;</span>);</span><br><span class="line"></span><br><span class="line">        twitterClient.sendTweet(iTweet);</span><br><span class="line"></span><br><span class="line">        verify(iTweet, atLeastOnce()).getMessage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><p>è¿è¡Œæµ‹è¯•ï¼ŒæŸ¥çœ‹ä»£ç æ˜¯å¦æµ‹è¯•é€šè¿‡ã€‚</p>
<h2 id="æ¨¡æ‹Ÿé™æ€æ–¹æ³•"><a href="#æ¨¡æ‹Ÿé™æ€æ–¹æ³•" class="headerlink" title="æ¨¡æ‹Ÿé™æ€æ–¹æ³•"></a>æ¨¡æ‹Ÿé™æ€æ–¹æ³•</h2><h3 id="ä½¿ç”¨-Powermock-æ¥æ¨¡æ‹Ÿé™æ€æ–¹æ³•"><a href="#ä½¿ç”¨-Powermock-æ¥æ¨¡æ‹Ÿé™æ€æ–¹æ³•" class="headerlink" title="ä½¿ç”¨ Powermock æ¥æ¨¡æ‹Ÿé™æ€æ–¹æ³•"></a>ä½¿ç”¨ Powermock æ¥æ¨¡æ‹Ÿé™æ€æ–¹æ³•</h3><p>å› ä¸º Mockito ä¸èƒ½å¤Ÿ mock é™æ€æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Powermock</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">NetworkReader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getLocalHostname</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hostname</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InetAddress</span> <span class="variable">addr</span> <span class="operator">=</span> InetAddress.getLocalHost();</span><br><span class="line">            <span class="comment">// Get hostname</span></span><br><span class="line">            hostname = addr.getHostName();</span><br><span class="line">        &#125; <span class="keyword">catch</span> ( UnknownHostException e ) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hostname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ¨¡æ‹Ÿäº† NetworkReader çš„ä¾èµ–ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.powermock.core.classloader.annotations.PrepareForTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith( PowerMockRunner.class )</span></span><br><span class="line"><span class="meta">@PrepareForTest( NetworkReader.class )</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•ä»£ç </span></span><br><span class="line"></span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSomething</span><span class="params">()</span> &#123;</span><br><span class="line">    mockStatic( NetworkUtil.class );</span><br><span class="line">    when( NetworkReader.getLocalHostname() ).andReturn( <span class="string">&quot;localhost&quot;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ NetworkReader åä½œçš„æµ‹è¯•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç”¨å°è£…çš„æ–¹æ³•ä»£æ›¿-Powermock"><a href="#ç”¨å°è£…çš„æ–¹æ³•ä»£æ›¿-Powermock" class="headerlink" title="ç”¨å°è£…çš„æ–¹æ³•ä»£æ›¿ Powermock"></a>ç”¨å°è£…çš„æ–¹æ³•ä»£æ›¿ Powermock</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨é™æ€æ–¹æ³•å‘¨å›´åŒ…å«éé™æ€çš„æ–¹æ³•æ¥è¾¾åˆ°å’Œ Powermock åŒæ ·çš„æ•ˆæœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FooWraper</span> &#123;</span><br><span class="line">      <span class="keyword">void</span> <span class="title function_">someMethod</span><span class="params">()</span> &#123;</span><br><span class="line">           Foo.someStaticMethod()</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¼•ç”¨å’Œå¼•ç”³"><a href="#å¼•ç”¨å’Œå¼•ç”³" class="headerlink" title="å¼•ç”¨å’Œå¼•ç”³"></a>å¼•ç”¨å’Œå¼•ç”³</h2><ul>
<li><a target="_blank" rel="noopener" href="https://site.mockito.org/">å®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mockito/mockito">Github</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/xitu/gold-miner/blob/master/TODO/Unit-tests-with-Mockito.md">ä½¿ç”¨å¼ºå¤§çš„ Mockito æµ‹è¯•æ¡†æ¶æ¥æµ‹è¯•ä½ çš„ä»£ç </a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/0e5ab1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/0e5ab1/" class="post-title-link" itemprop="url">JMeter å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">æµ‹è¯•</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>2.6k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>2 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="JMeter-å¿«é€Ÿå…¥é—¨"><a href="#JMeter-å¿«é€Ÿå…¥é—¨" class="headerlink" title="JMeter å¿«é€Ÿå…¥é—¨"></a>JMeter å¿«é€Ÿå…¥é—¨</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/apache/jmeter">Jmeter</a> æ˜¯ä¸€æ¬¾åŸºäº Java å¼€å‘çš„åŠŸèƒ½å’Œæ€§èƒ½æµ‹è¯•è½¯ä»¶ã€‚</p>
<p>ğŸ æœ¬æ–‡ç¼–è¾‘æ—¶çš„æœ€æ–°ç‰ˆæœ¬ä¸ºï¼š5.1.1</p>
</blockquote>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><a target="_blank" rel="noopener" href="https://github.com/apache/jmeter">Jmeter</a> æ˜¯ä¸€æ¬¾ä½¿ç”¨ Java å¼€å‘çš„åŠŸèƒ½å’Œæ€§èƒ½æµ‹è¯•è½¯ä»¶ã€‚</p>
<h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><p>Jmeter èƒ½å¤ŸåŠ è½½å’Œæ€§èƒ½æµ‹è¯•è®¸å¤šä¸åŒçš„åº”ç”¨ç¨‹åº&#x2F;æœåŠ¡å™¨&#x2F;åè®®ç±»å‹ï¼š</p>
<ul>
<li>ç½‘ç»œ - HTTPï¼ŒHTTPS(Javaï¼ŒNodeJSï¼ŒPHPï¼ŒASP.NET ç­‰)</li>
<li>SOAP &#x2F; REST Web æœåŠ¡</li>
<li>FTP æ–‡ä»¶</li>
<li>é€šè¿‡ JDBC çš„æ•°æ®åº“</li>
<li>LDAP</li>
<li>é€šè¿‡ JMS çš„é¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶(MOM)</li>
<li>é‚®ä»¶-SMTP(S)ï¼ŒPOP3(S)å’Œ IMAP(S)</li>
<li>æœ¬æœºå‘½ä»¤æˆ– Shell è„šæœ¬</li>
<li>TCP åè®®</li>
<li>Java å¯¹è±¡</li>
</ul>
<h3 id="å·¥ä½œæµ"><a href="#å·¥ä½œæµ" class="headerlink" title="å·¥ä½œæµ"></a>å·¥ä½œæµ</h3><p>Jmeter çš„å·¥ä½œåŸç†æ˜¯ä»¿çœŸç”¨æˆ·å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶æ”¶é›†æœåŠ¡å™¨åº”ç­”ä¿¡æ¯å¹¶è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p>Jmeter çš„å·¥ä½œæµå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javaweb/technology/test/jmeter-workflow.png" alt="img"></p>
<h3 id="ä¸»è¦å…ƒç´ "><a href="#ä¸»è¦å…ƒç´ " class="headerlink" title="ä¸»è¦å…ƒç´ "></a>ä¸»è¦å…ƒç´ </h3><p>Jmeter çš„ä¸»è¦å…ƒç´ å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong><code>æµ‹è¯•è®¡åˆ’(Test Plan)</code></strong> - å¯ä»¥å°†æµ‹è¯•è®¡åˆ’è§†ä¸º JMeter çš„æµ‹è¯•è„šæœ¬ ã€‚æµ‹è¯•è®¡åˆ’ç”±æµ‹è¯•å…ƒç´ ç»„æˆï¼Œä¾‹å¦‚çº¿ç¨‹ç»„ï¼Œé€»è¾‘æ§åˆ¶å™¨ï¼Œæ ·æœ¬ç”Ÿæˆæ§åˆ¶å™¨ï¼Œç›‘å¬å™¨ï¼Œå®šæ—¶å™¨ï¼Œæ–­è¨€å’Œé…ç½®å…ƒç´ ã€‚</li>
<li><strong><code>çº¿ç¨‹ç»„(Thread Group)</code></strong> - çº¿ç¨‹ç»„çš„ä½œç”¨æ˜¯ï¼šæ¨¡æ‹Ÿå¤§é‡ç”¨æˆ·è´Ÿè½½çš„è¿è¡Œåœºæ™¯ã€‚<ul>
<li>è®¾ç½®çº¿ç¨‹æ•°</li>
<li>è®¾ç½®åŠ é€ŸæœŸ</li>
<li>è®¾ç½®æ‰§è¡Œæµ‹è¯•çš„æ¬¡æ•°</li>
</ul>
</li>
<li><strong><code>æ§åˆ¶å™¨(Controllers)</code></strong> - å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š<ul>
<li><strong><code>é‡‡æ ·å™¨ï¼ˆSamplerï¼‰</code></strong> - é‡‡æ ·å™¨çš„ä½œç”¨æ˜¯æ¨¡æ‹Ÿç”¨æˆ·å¯¹ç›®æ ‡æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚ é‡‡æ ·å™¨æ˜¯å¿…é¡»å°†ç»„ä»¶æ·»åŠ åˆ°æµ‹è¯•è®¡åˆ’ä¸­çš„ï¼Œå› ä¸ºå®ƒåªèƒ½è®© JMeter çŸ¥é“éœ€è¦å°†å“ªç§ç±»å‹çš„è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚ è¯·æ±‚å¯ä»¥æ˜¯ HTTPï¼ŒHTTP(s)ï¼ŒFTPï¼ŒTCPï¼ŒSMTPï¼ŒSOAP ç­‰ã€‚</li>
<li><strong><code>é€»è¾‘æ§åˆ¶å™¨</code></strong> - é€»è¾‘æ§åˆ¶å™¨çš„ä½œç”¨æ˜¯ï¼šæ§åˆ¶å¤šä¸ªè¯·æ±‚å‘é€çš„å¾ªç¯æ¬¡æ•°åŠé¡ºåºç­‰ã€‚</li>
</ul>
</li>
<li><strong><code>ç›‘å¬å™¨(Listeners)</code></strong> - ç›‘å¬å™¨çš„ä½œç”¨æ˜¯ï¼šæ”¶é›†æµ‹è¯•ç»“æœä¿¡æ¯ã€‚å¦‚æŸ¥çœ‹ç»“æœæ ‘ã€æ±‡æ€»æŠ¥å‘Šç­‰ã€‚</li>
<li><strong><code>è®¡æ—¶å™¨(Timers)</code></strong> - è®¡æ—¶å™¨çš„ä½œç”¨æ˜¯ï¼šæ§åˆ¶å¤šä¸ªè¯·æ±‚å‘é€çš„æ—¶é—´é¢‘æ¬¡ã€‚</li>
<li><strong><code>é…ç½®å…ƒç´ (Configuration Elements)</code></strong> - é…ç½®å…ƒç´ çš„å·¥ä½œä¸é‡‡æ ·å™¨çš„å·¥ä½œç±»ä¼¼ã€‚ä½†æ˜¯ï¼Œå®ƒä¸å‘é€è¯·æ±‚ï¼Œè€Œæ˜¯æä¾›é¢„å¤‡çš„æ•°æ®ç­‰ï¼Œå¦‚ CSVã€å‡½æ•°åŠ©æ‰‹ã€‚</li>
<li><strong><code>é¢„å¤„ç†å™¨å…ƒç´ (Pre-Processor Elements)</code></strong> - é¢„å¤„ç†å™¨å…ƒç´ åœ¨é‡‡æ ·å™¨å‘å‡ºè¯·æ±‚ä¹‹å‰æ‰§è¡Œï¼Œå¦‚æœé¢„å¤„ç†å™¨é™„åŠ åˆ°é‡‡æ ·å™¨å…ƒç´ ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨è¯¥é‡‡æ ·å™¨å…ƒç´ è¿è¡Œä¹‹å‰æ‰§è¡Œã€‚é¢„å¤„ç†å™¨å…ƒç´ ç”¨äºåœ¨è¿è¡Œä¹‹å‰å‡†å¤‡ç¯å¢ƒåŠå‚æ•°ã€‚</li>
<li><strong><code>åå¤„ç†å™¨å…ƒç´ (Post-Processor Elements)</code></strong> - åå¤„ç†å™¨å…ƒç´ æ˜¯åœ¨å‘é€é‡‡æ ·å™¨è¯·æ±‚ä¹‹åæ‰§è¡Œçš„å…ƒç´ ï¼Œå¸¸ç”¨äºå¤„ç†å“åº”æ•°æ®ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javaweb/technology/test/jmeter-elements.png" alt="img"></p>
<blockquote>
<p>ğŸ“Œ æç¤ºï¼š</p>
<p>Jmeter å…ƒç´ çš„æ•°é‡å…³ç³»å¤§è‡´å¦‚ä¸‹ï¼š</p>
<ol>
<li>è„šæœ¬ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªæµ‹è¯•è®¡åˆ’ã€‚</li>
<li>æµ‹è¯•è®¡åˆ’ä¸­è‡³å°‘è¦æœ‰ä¸€ä¸ªçº¿ç¨‹ç»„ã€‚</li>
<li>çº¿ç¨‹ç»„ä¸­è‡³å°‘è¦æœ‰ä¸€ä¸ªå–æ ·å™¨ã€‚</li>
<li>çº¿ç¨‹ç»„ä¸­è‡³å°‘è¦æœ‰ä¸€ä¸ªç›‘å¬å™¨ã€‚</li>
</ol>
</blockquote>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="ç¯å¢ƒè¦æ±‚"><a href="#ç¯å¢ƒè¦æ±‚" class="headerlink" title="ç¯å¢ƒè¦æ±‚"></a>ç¯å¢ƒè¦æ±‚</h3><ul>
<li><p>å¿…è¦çš„ã€‚Jmeter åŸºäº JDK8 å¼€å‘ï¼Œæ‰€ä»¥å¿…é¡»è¿è¡Œåœ¨ JDK8 ç¯å¢ƒã€‚</p>
<ul>
<li>JDK8</li>
</ul>
</li>
<li><p>å¯é€‰çš„ã€‚æœ‰äº› jar åŒ…ä¸æ˜¯ Jmeter æä¾›çš„ï¼Œå¦‚æœéœ€è¦ç›¸åº”çš„åŠŸèƒ½ï¼Œéœ€è¦è‡ªè¡Œä¸‹è½½å¹¶ç½®äº <code>lib</code> ç›®å½•ã€‚</p>
<ul>
<li>JDBC</li>
<li>JMS</li>
<li><a target="_blank" rel="noopener" href="http://www.bouncycastle.org/test_releases.html">Bouncy Castle</a></li>
</ul>
</li>
</ul>
<h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>è¿›å…¥ <a target="_blank" rel="noopener" href="https://jmeter.apache.org/download_jmeter.cgi"><strong>Jmeter å®˜ç½‘ä¸‹è½½åœ°å€</strong></a> é€‰æ‹©éœ€è¦ç‰ˆæœ¬è¿›è¡Œä¸‹è½½ã€‚</p>
<h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p>è§£å‹ Jmeter å‹ç¼©åŒ…ï¼Œè¿›å…¥ bin ç›®å½•</p>
<p>Unix ç±»ç³»ç»Ÿè¿è¡Œ <code>jmeter</code> ï¼›Windows ç³»ç»Ÿè¿è¡Œ <code>jmeter.bat</code></p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024104517721.png" alt="image-20191024104517721"></p>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="åˆ›å»ºæµ‹è¯•è®¡åˆ’"><a href="#åˆ›å»ºæµ‹è¯•è®¡åˆ’" class="headerlink" title="åˆ›å»ºæµ‹è¯•è®¡åˆ’"></a>åˆ›å»ºæµ‹è¯•è®¡åˆ’</h3><blockquote>
<p>ğŸ”” æ³¨æ„ï¼š</p>
<ul>
<li><p>åœ¨è¿è¡Œæ•´ä¸ªæµ‹è¯•è®¡åˆ’ä¹‹å‰ï¼Œåº”ä¿å­˜æµ‹è¯•è®¡åˆ’ã€‚</p>
</li>
<li><p>JMeter çš„æµ‹è¯•è®¡åˆ’ä»¥ <code>.jmx</code> æ‰©å±•æ–‡ä»¶çš„å½¢å¼ä¿å­˜ã€‚</p>
</li>
</ul>
</blockquote>
<h4 id="åˆ›å»ºçº¿ç¨‹ç»„"><a href="#åˆ›å»ºçº¿ç¨‹ç»„" class="headerlink" title="åˆ›å»ºçº¿ç¨‹ç»„"></a>åˆ›å»ºçº¿ç¨‹ç»„</h4><ul>
<li><p>åœ¨â€œæµ‹è¯•è®¡åˆ’â€ä¸Šå³é”® ã€æ·»åŠ ã€‘&#x3D;&gt;ã€çº¿ç¨‹ï¼ˆç”¨æˆ·ï¼‰ã€‘&#x3D;&gt;ã€çº¿ç¨‹ç»„ã€‘ã€‚</p>
</li>
<li><p>è®¾ç½®çº¿ç¨‹æ•°å’Œå¾ªç¯æ¬¡æ•°</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024105545736.png" alt="image-20191024105545736"></p>
<h4 id="é…ç½®åŸä»¶"><a href="#é…ç½®åŸä»¶" class="headerlink" title="é…ç½®åŸä»¶"></a>é…ç½®åŸä»¶</h4><ul>
<li><p>åœ¨æ–°å»ºçš„çº¿ç¨‹ç»„ä¸Šå³é”® ã€æ·»åŠ ã€‘&#x3D;&gt;ã€é…ç½®å…ƒä»¶ã€‘&#x3D;&gt;ã€HTTP è¯·æ±‚é»˜è®¤å€¼ã€‘ã€‚</p>
</li>
<li><p>å¡«å†™åè®®ã€æœåŠ¡å™¨åç§°æˆ– IPã€ç«¯å£å·</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024110016264.png" alt="image-20191024110016264"></p>
<h4 id="æ„é€ -HTTP-è¯·æ±‚"><a href="#æ„é€ -HTTP-è¯·æ±‚" class="headerlink" title="æ„é€  HTTP è¯·æ±‚"></a>æ„é€  HTTP è¯·æ±‚</h4><ul>
<li><p>åœ¨â€œçº¿ç¨‹ç»„â€ä¸Šå³é”® ã€æ·»åŠ -ã€‘&#x3D;&gt;ã€å–æ ·å™¨ã€‘&#x3D;&gt;ã€HTTP è¯·æ±‚ã€‘ã€‚</p>
</li>
<li><p>å¡«å†™åè®®ã€æœåŠ¡å™¨åç§°æˆ– IPã€ç«¯å£å·ï¼ˆå¦‚æœé…ç½®äº† HTTP è¯·æ±‚é»˜è®¤å€¼å¯ä»¥å¿½ç•¥ï¼‰</p>
</li>
<li><p>å¡«å†™æ–¹æ³•ã€è·¯å¾„</p>
</li>
<li><p>å¡«å†™å‚æ•°ã€æ¶ˆæ¯ä½“æ•°æ®ã€æ–‡ä»¶ä¸Šä¼ </p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024110953063.png" alt="image-20191024110953063"></p>
<h4 id="æ·»åŠ -HTTP-è¯·æ±‚å¤´"><a href="#æ·»åŠ -HTTP-è¯·æ±‚å¤´" class="headerlink" title="æ·»åŠ  HTTP è¯·æ±‚å¤´"></a>æ·»åŠ  HTTP è¯·æ±‚å¤´</h4><ul>
<li>åœ¨â€œçº¿ç¨‹ç»„â€ä¸Šå³é”® ã€æ·»åŠ ã€‘&#x3D;&gt;ã€é…ç½®å…ƒä»¶ã€‘&#x3D;&gt;ã€HTTP ä¿¡æ¯å¤´ç®¡ç†å™¨ã€‘</li>
<li>ç”±äºæˆ‘çš„æµ‹è¯•ä¾‹ä¸­ä¼ è¾“çš„æ•°æ®ä¸º json å½¢å¼ï¼Œæ‰€ä»¥è®¾ç½®é”®å€¼å¯¹ <code>Content-Type</code>ï¼š<code>application/json</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024111825226.png" alt="image-20191024111825226"></p>
<h4 id="æ·»åŠ æ–­è¨€"><a href="#æ·»åŠ æ–­è¨€" class="headerlink" title="æ·»åŠ æ–­è¨€"></a>æ·»åŠ æ–­è¨€</h4><ul>
<li>åœ¨â€œçº¿ç¨‹ç»„â€ä¸Šå³é”® ã€æ·»åŠ ã€‘&#x3D;&gt;ã€æ–­è¨€ã€‘&#x3D;&gt;ã€ å“åº”æ–­è¨€ ã€‘</li>
<li>åœ¨æˆ‘çš„æ¡ˆä¾‹ä¸­ï¼Œä»¥ HTTP åº”ç­”çŠ¶æ€ç ä¸º 200 æ¥åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024112335130.png" alt="image-20191024112335130"></p>
<h4 id="æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘"><a href="#æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘" class="headerlink" title="æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘"></a>æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘</h4><ul>
<li>åœ¨â€œçº¿ç¨‹ç»„â€ä¸Šå³é”® ã€æ·»åŠ ã€‘&#x3D;&gt;ã€ç›‘å¬å™¨ã€‘&#x3D;&gt;ã€å¯Ÿçœ‹ç»“æœæ ‘ã€‘</li>
<li>ç›´æ¥ç‚¹å‡»è¿è¡Œï¼Œå°±å¯ä»¥æŸ¥çœ‹æµ‹è¯•ç»“æœ</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024113849270.png" alt="image-20191024113849270"></p>
<h4 id="æ·»åŠ æ±‡æ€»æŠ¥å‘Š"><a href="#æ·»åŠ æ±‡æ€»æŠ¥å‘Š" class="headerlink" title="æ·»åŠ æ±‡æ€»æŠ¥å‘Š"></a>æ·»åŠ æ±‡æ€»æŠ¥å‘Š</h4><ul>
<li>åœ¨â€œçº¿ç¨‹ç»„â€ä¸Šå³é”® ã€æ·»åŠ ã€‘&#x3D;&gt;ã€ç›‘å¬å™¨ã€‘&#x3D;&gt;ã€æ±‡æ€»æŠ¥å‘Šã€‘</li>
<li>ç›´æ¥ç‚¹å‡»è¿è¡Œï¼Œå°±å¯ä»¥æŸ¥çœ‹æµ‹è¯•ç»“æœ</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024114016424.png" alt="image-20191024114016424"></p>
<h4 id="ä¿å­˜æµ‹è¯•è®¡åˆ’"><a href="#ä¿å­˜æµ‹è¯•è®¡åˆ’" class="headerlink" title="ä¿å­˜æµ‹è¯•è®¡åˆ’"></a>ä¿å­˜æµ‹è¯•è®¡åˆ’</h4><p>æ‰§è¡Œæµ‹è¯•è®¡åˆ’å‰ï¼ŒGUI ä¼šæç¤ºå…ˆä¿å­˜é…ç½®ä¸º <code>jmx</code> æ–‡ä»¶ã€‚</p>
<h3 id="æ‰§è¡Œæµ‹è¯•è®¡åˆ’"><a href="#æ‰§è¡Œæµ‹è¯•è®¡åˆ’" class="headerlink" title="æ‰§è¡Œæµ‹è¯•è®¡åˆ’"></a>æ‰§è¡Œæµ‹è¯•è®¡åˆ’</h3><p>å®˜æ–¹å»ºè®®ä¸è¦ç›´æ¥ä½¿ç”¨ GUI æ¥æ‰§è¡Œæµ‹è¯•è®¡åˆ’ï¼Œè¿™ç§æ¨¡å¼æŒ‡é€‚ç”¨äºåˆ›å»ºæµ‹è¯•è®¡åˆ’å’Œ debugã€‚</p>
<p>æ‰§è¡Œæµ‹è¯•è®¡åˆ’åº”è¯¥ä½¿ç”¨å‘½ä»¤è¡Œæ¨¡å¼ï¼Œè¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmeter -n -t [jmx file] -l [results file] -e -o [Path to web report folder]</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæµ‹è¯•è®¡åˆ’åï¼Œåœ¨ <code>-e -o</code> å‚æ•°åæŒ‡å®šçš„ web æŠ¥å‘Šç›®å½•ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°æµ‹è¯•æŠ¥å‘Šå†…å®¹ã€‚åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>index.html</code> æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æŠ¥å‘Šï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/jmeter/image-20191024120233058.png" alt="image-20191024120233058"></p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="å¦‚ä½•è¯»å–æœ¬åœ°-txt-csv-æ–‡ä»¶ä½œä¸ºè¯·æ±‚å‚æ•°"><a href="#å¦‚ä½•è¯»å–æœ¬åœ°-txt-csv-æ–‡ä»¶ä½œä¸ºè¯·æ±‚å‚æ•°" class="headerlink" title="å¦‚ä½•è¯»å–æœ¬åœ° txt&#x2F;csv æ–‡ä»¶ä½œä¸ºè¯·æ±‚å‚æ•°"></a>å¦‚ä½•è¯»å–æœ¬åœ° txt&#x2F;csv æ–‡ä»¶ä½œä¸ºè¯·æ±‚å‚æ•°</h3><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/3b2d3b643415">Jmeter è¯»å–æœ¬åœ° txt&#x2F;csv æ–‡ä»¶ä½œä¸ºè¯·æ±‚å‚æ•°ï¼Œå®ç°æ¥å£è‡ªåŠ¨åŒ–</a></p>
<p>ï¼ˆ1ï¼‰ä¾æ¬¡ç‚¹å‡»ã€æ·»åŠ ã€‘&#x3D;&gt;ã€é…ç½®å…ƒä»¶ã€‘&#x3D;&gt;ã€CSV æ•°æ®æ–‡ä»¶è®¾ç½®ã€‘</p>
<p>é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/image-20191127175820747.png" alt="image-20191127175820747"></p>
<p>é‡è¦é…ç½®è¯´æ˜ï¼ˆå…¶ä»–é…ç½®æ ¹æ®å®é™…æƒ…å†µå¡«ï¼‰ï¼š</p>
<ul>
<li>æ–‡ä»¶åï¼šè¾“å…¥éœ€è¦å¯¼å…¥çš„æ•°æ®æ–‡ä»¶ä½ç½®ã€‚</li>
<li>æ–‡ä»¶ç¼–ç ï¼šè®¾ä¸º UTF-8ï¼Œé¿å…ä¹±ç ã€‚</li>
<li>å˜é‡åç§°ï¼šä½¿ç”¨ <code>,</code> åˆ†éš”è¾“å…¥å˜é‡åˆ—è¡¨ã€‚å¦‚æˆªå›¾ä¸­è®¾ç½®äº†ä¸¤ä¸ªå˜é‡ <code>a</code> å’Œ <code>b</code></li>
</ul>
<p>ï¼ˆ2ï¼‰åœ¨ HTTP è¯·æ±‚çš„æ¶ˆæ¯ä½“æ•°æ®ä¸­é…ç½®å‚æ•°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="string">&quot;a&quot;</span>:<span class="string">&quot;<span class="variable">$&#123;a&#125;</span>&quot;</span>,<span class="string">&quot;b&quot;</span>:<span class="string">&quot;<span class="variable">$&#123;b&#125;</span>&quot;</span>&#125;]</span><br></pre></td></tr></table></figure>

<h3 id="å¦‚ä½•æœ‰åºå‘é€æ•°æ®"><a href="#å¦‚ä½•æœ‰åºå‘é€æ•°æ®" class="headerlink" title="å¦‚ä½•æœ‰åºå‘é€æ•°æ®"></a>å¦‚ä½•æœ‰åºå‘é€æ•°æ®</h3><p>ä¾æ¬¡ç‚¹å‡»ã€æ·»åŠ ã€‘&#x3D;&gt;ã€é€»è¾‘æ§åˆ¶å™¨ã€‘&#x3D;&gt;ã€äº‹åŠ¡æ§åˆ¶å™¨ã€‘</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://jmeter.apache.org/">Jmeter å®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/jmeter">Jmeter Github</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/TankXiao/p/4045439.html">Jmeter æ€§èƒ½æµ‹è¯•å…¥é—¨</a></li>
<li><a target="_blank" rel="noopener" href="https://www.yiibai.com/jmeter">æ˜“ç™¾æ•™ç¨‹ - Jmeter æ•™ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/3b2d3b643415">Jmeter è¯»å–æœ¬åœ° txt&#x2F;csv æ–‡ä»¶ä½œä¸ºè¯·æ±‚å‚æ•°ï¼Œå®ç°æ¥å£è‡ªåŠ¨åŒ–</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/9c6402/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/9c6402/" class="post-title-link" itemprop="url">JMH å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">æµ‹è¯•</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>8.3k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>8 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="JMH-å¿«é€Ÿå…¥é—¨"><a href="#JMH-å¿«é€Ÿå…¥é—¨" class="headerlink" title="JMH å¿«é€Ÿå…¥é—¨"></a>JMH å¿«é€Ÿå…¥é—¨</h1><h2 id="åŸºå‡†æµ‹è¯•ç®€ä»‹"><a href="#åŸºå‡†æµ‹è¯•ç®€ä»‹" class="headerlink" title="åŸºå‡†æµ‹è¯•ç®€ä»‹"></a>åŸºå‡†æµ‹è¯•ç®€ä»‹</h2><h3 id="ä»€ä¹ˆæ˜¯åŸºå‡†æµ‹è¯•"><a href="#ä»€ä¹ˆæ˜¯åŸºå‡†æµ‹è¯•" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸºå‡†æµ‹è¯•"></a>ä»€ä¹ˆæ˜¯åŸºå‡†æµ‹è¯•</h3><p>åŸºå‡†æµ‹è¯•æ˜¯æŒ‡é€šè¿‡è®¾è®¡ç§‘å­¦çš„æµ‹è¯•æ–¹æ³•ã€æµ‹è¯•å·¥å…·å’Œæµ‹è¯•ç³»ç»Ÿï¼Œå®ç°å¯¹ä¸€ç±»æµ‹è¯•å¯¹è±¡çš„æŸé¡¹æ€§èƒ½æŒ‡æ ‡è¿›è¡Œå®šé‡çš„å’Œå¯å¯¹æ¯”çš„æµ‹è¯•ã€‚</p>
<p>ç°ä»£è½¯ä»¶å¸¸å¸¸éƒ½æŠŠé«˜æ€§èƒ½ä½œä¸ºç›®æ ‡ã€‚é‚£ä¹ˆï¼Œä½•ä¸ºé«˜æ€§èƒ½ï¼Œæ€§èƒ½å°±æ˜¯å¿«ï¼Œæ›´å¿«å—ï¼Ÿæ˜¾ç„¶ï¼Œå¦‚æœæ²¡æœ‰ä¸€ä¸ªé‡åŒ–çš„æ ‡å‡†ï¼Œéš¾ä»¥è¡¡é‡æ€§èƒ½çš„å¥½åã€‚</p>
<p>ä¸åŒçš„åŸºå‡†æµ‹è¯•å…¶å…·ä½“å†…å®¹å’ŒèŒƒå›´ä¹Ÿå­˜åœ¨å¾ˆå¤§çš„ä¸åŒã€‚å¦‚æœæ˜¯ä¸“ä¸šçš„æ€§èƒ½å·¥ç¨‹å¸ˆï¼Œæ›´åŠ ç†Ÿæ‚‰çš„å¯èƒ½æ˜¯ç±»ä¼¼ SPEC æä¾›çš„å·¥ä¸šæ ‡å‡†çš„ç³»ç»Ÿçº§æµ‹è¯•ï¼›è€Œå¯¹äºå¤§å¤šæ•° Java å¼€å‘è€…ï¼Œæ›´ç†Ÿæ‚‰çš„åˆ™æ˜¯èŒƒå›´ç›¸å¯¹è¾ƒå°ã€å…³æ³¨ç‚¹æ›´åŠ ç»†èŠ‚çš„å¾®åŸºå‡†æµ‹è¯•ï¼ˆMicro-Benchmarkï¼‰ã€‚ä½•è°“ Micro Benchmark å‘¢ï¼Ÿ ç®€å•åœ°è¯´å°±æ˜¯åœ¨ method å±‚é¢ä¸Šçš„ benchmarkï¼Œç²¾åº¦å¯ä»¥ç²¾ç¡®åˆ° <strong>å¾®ç§’çº§</strong>ã€‚</p>
<h3 id="ä½•æ—¶éœ€è¦å¾®åŸºå‡†æµ‹è¯•"><a href="#ä½•æ—¶éœ€è¦å¾®åŸºå‡†æµ‹è¯•" class="headerlink" title="ä½•æ—¶éœ€è¦å¾®åŸºå‡†æµ‹è¯•"></a>ä½•æ—¶éœ€è¦å¾®åŸºå‡†æµ‹è¯•</h3><p>å¾®åŸºå‡†æµ‹è¯•å¤§å¤šæ˜¯ API çº§åˆ«çš„æ€§èƒ½æµ‹è¯•ã€‚</p>
<p>å¾®åŸºå‡†æµ‹è¯•çš„é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>å¦‚æœå¼€å‘å…¬å…±ç±»åº“ã€ä¸­é—´ä»¶ï¼Œä¼šè¢«å…¶ä»–æ¨¡å—ç»å¸¸è°ƒç”¨çš„ APIã€‚</li>
<li>å¯¹äºæ€§èƒ½ï¼Œå¦‚å“åº”å»¶è¿Ÿã€ååé‡æœ‰ä¸¥æ ¼è¦æ±‚çš„æ ¸å¿ƒ APIã€‚</li>
</ul>
<h2 id="JMH-ç®€ä»‹"><a href="#JMH-ç®€ä»‹" class="headerlink" title="JMH ç®€ä»‹"></a>JMH ç®€ä»‹</h2><p><a target="_blank" rel="noopener" href="http://openjdk.java.net/projects/code-tools/jmh/">JMH(å³ Java Microbenchmark Harness)</a>ï¼Œæ˜¯ç›®å‰ä¸»æµçš„å¾®åŸºå‡†æµ‹è¯•æ¡†æ¶ã€‚JMH æ˜¯ç”± Hotspot JVM å›¢é˜Ÿä¸“å®¶å¼€å‘çš„ï¼Œé™¤äº†æ”¯æŒå®Œæ•´çš„åŸºå‡†æµ‹è¯•è¿‡ç¨‹ï¼ŒåŒ…æ‹¬é¢„çƒ­ã€è¿è¡Œã€ç»Ÿè®¡å’ŒæŠ¥å‘Šç­‰ï¼Œè¿˜æ”¯æŒ Java å’Œå…¶ä»– JVM è¯­è¨€ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒé’ˆå¯¹ Hotspot JVM æä¾›äº†å„ç§ç‰¹æ€§ï¼Œä»¥ä¿è¯åŸºå‡†æµ‹è¯•çš„æ­£ç¡®æ€§ï¼Œæ•´ä½“å‡†ç¡®æ€§å¤§å¤§ä¼˜äºå…¶ä»–æ¡†æ¶ï¼Œå¹¶ä¸”ï¼ŒJMH è¿˜æä¾›äº†ç”¨è¿‘ä¹ç™½ç›’çš„æ–¹å¼è¿›è¡Œ Profiling ç­‰å·¥ä½œçš„èƒ½åŠ›ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦-JMH"><a href="#ä¸ºä»€ä¹ˆéœ€è¦-JMH" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ JMH"></a>ä¸ºä»€ä¹ˆéœ€è¦ JMH</h3><h4 id="æ­»ç æ¶ˆé™¤"><a href="#æ­»ç æ¶ˆé™¤" class="headerlink" title="æ­»ç æ¶ˆé™¤"></a>æ­»ç æ¶ˆé™¤</h4><p>æ‰€è°“æ­»ç ï¼Œæ˜¯æŒ‡æ³¨é‡Šçš„ä»£ç ï¼Œä¸å¯è¾¾çš„ä»£ç å—ï¼Œå¯è¾¾ä½†ä¸è¢«ä½¿ç”¨çš„ä»£ç ç­‰ç­‰ ã€‚</p>
<h4 id="å¸¸é‡æŠ˜å ä¸å¸¸é‡ä¼ æ’­"><a href="#å¸¸é‡æŠ˜å ä¸å¸¸é‡ä¼ æ’­" class="headerlink" title="å¸¸é‡æŠ˜å ä¸å¸¸é‡ä¼ æ’­"></a>å¸¸é‡æŠ˜å ä¸å¸¸é‡ä¼ æ’­</h4><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%B8%B8%E6%95%B8%E6%8A%98%E7%96%8A#%E5%B8%B8%E6%95%B8%E5%82%B3%E6%92%AD">å¸¸é‡æŠ˜å </a> (Constant folding) æ˜¯ä¸€ä¸ªåœ¨ç¼–è¯‘æ—¶æœŸç®€åŒ–å¸¸æ•°çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå¸¸æ•°åœ¨è¡¨ç¤ºå¼ä¸­ä»…ä»…ä»£è¡¨ä¸€ä¸ªç®€å•çš„æ•°å€¼ï¼Œå°±åƒæ˜¯æ•´æ•° <code>2</code>ï¼Œè‹¥æ˜¯ä¸€ä¸ªå˜æ•°ä»æœªè¢«ä¿®æ”¹ä¹Ÿå¯ä½œä¸ºå¸¸æ•°ï¼Œæˆ–è€…ç›´æ¥å°†ä¸€ä¸ªå˜æ•°è¢«æ˜ç¡®åœ°è¢«æ ‡æ³¨ä¸ºå¸¸æ•°ï¼Œä¾‹å¦‚ä¸‹é¢çš„æè¿°ï¼š</p>
<h3 id="JMH-çš„æ³¨æ„ç‚¹"><a href="#JMH-çš„æ³¨æ„ç‚¹" class="headerlink" title="JMH çš„æ³¨æ„ç‚¹"></a>JMH çš„æ³¨æ„ç‚¹</h3><ul>
<li>æµ‹è¯•å‰éœ€è¦é¢„çƒ­ã€‚</li>
<li>é˜²æ­¢æ— ç”¨ä»£ç è¿›å…¥æµ‹è¯•æ–¹æ³•ä¸­ã€‚</li>
<li>å¹¶å‘æµ‹è¯•ã€‚</li>
<li>æµ‹è¯•ç»“æœå‘ˆç°ã€‚</li>
</ul>
<h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><ol>
<li>å½“ä½ å·²ç»æ‰¾å‡ºäº†çƒ­ç‚¹å‡½æ•°ï¼Œè€Œéœ€è¦å¯¹çƒ­ç‚¹å‡½æ•°è¿›è¡Œè¿›ä¸€æ­¥çš„ä¼˜åŒ–æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ JMH å¯¹ä¼˜åŒ–çš„æ•ˆæœè¿›è¡Œå®šé‡çš„åˆ†æã€‚</li>
<li>æƒ³å®šé‡åœ°çŸ¥é“æŸä¸ªå‡½æ•°éœ€è¦æ‰§è¡Œå¤šé•¿æ—¶é—´ï¼Œä»¥åŠæ‰§è¡Œæ—¶é—´å’Œè¾“å…¥ n çš„ç›¸å…³æ€§</li>
<li>ä¸€ä¸ªå‡½æ•°æœ‰ä¸¤ç§ä¸åŒå®ç°ï¼ˆä¾‹å¦‚ JSON åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–æœ‰ Jackson å’Œ Gson å®ç°ï¼‰ï¼Œä¸çŸ¥é“å“ªç§å®ç°æ€§èƒ½æ›´å¥½</li>
</ol>
<h3 id="JMH-æ¦‚å¿µ"><a href="#JMH-æ¦‚å¿µ" class="headerlink" title="JMH æ¦‚å¿µ"></a>JMH æ¦‚å¿µ</h3><ul>
<li><code>Iteration</code> - iteration æ˜¯ JMH è¿›è¡Œæµ‹è¯•çš„æœ€å°å•ä½ï¼ŒåŒ…å«ä¸€ç»„ invocationsã€‚</li>
<li><code>Invocation</code> - ä¸€æ¬¡ benchmark æ–¹æ³•è°ƒç”¨ã€‚</li>
<li><code>Operation</code> - benchmark æ–¹æ³•ä¸­ï¼Œè¢«æµ‹é‡æ“ä½œçš„æ‰§è¡Œã€‚å¦‚æœè¢«æµ‹è¯•çš„æ“ä½œåœ¨ benchmark æ–¹æ³•ä¸­å¾ªç¯æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>@OperationsPerInvocation</code>è¡¨æ˜å¾ªç¯æ¬¡æ•°ï¼Œä½¿æµ‹è¯•ç»“æœä¸ºå•æ¬¡ operation çš„æ€§èƒ½ã€‚</li>
<li><code>Warmup</code> - åœ¨å®é™…è¿›è¡Œ benchmark å‰å…ˆè¿›è¡Œé¢„çƒ­ã€‚å› ä¸ºæŸä¸ªå‡½æ•°è¢«è°ƒç”¨å¤šæ¬¡ä¹‹åï¼ŒJIT ä¼šå¯¹å…¶è¿›è¡Œç¼–è¯‘ï¼Œé€šè¿‡é¢„çƒ­å¯ä»¥ä½¿æµ‹é‡ç»“æœæ›´åŠ æ¥è¿‘çœŸå®æƒ…å†µã€‚</li>
</ul>
<h2 id="JMH-å¿«é€Ÿå…¥é—¨-1"><a href="#JMH-å¿«é€Ÿå…¥é—¨-1" class="headerlink" title="JMH å¿«é€Ÿå…¥é—¨"></a>JMH å¿«é€Ÿå…¥é—¨</h2><h3 id="æ·»åŠ -maven-ä¾èµ–"><a href="#æ·»åŠ -maven-ä¾èµ–" class="headerlink" title="æ·»åŠ  maven ä¾èµ–"></a>æ·»åŠ  maven ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjdk.jmh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jmh-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jmh.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjdk.jmh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jmh-generator-annprocess<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jmh.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.openjdk.jmh.annotations.*;</span><br><span class="line"><span class="keyword">import</span> org.openjdk.jmh.runner.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@BenchmarkMode(Mode.Throughput)</span></span><br><span class="line"><span class="meta">@Warmup(iterations = 3)</span></span><br><span class="line"><span class="meta">@Measurement(iterations = 10, time = 5, timeUnit = TimeUnit.SECONDS)</span></span><br><span class="line"><span class="meta">@Threads(8)</span></span><br><span class="line"><span class="meta">@Fork(2)</span></span><br><span class="line"><span class="meta">@OutputTimeUnit(TimeUnit.MILLISECONDS)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringBuilderBenchmark</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Benchmark</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testStringAdd</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            a += i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// System.out.println(a);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Benchmark</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testStringBuilderAdd</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            sb.append(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// System.out.println(sb.toString());</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RunnerException &#123;</span><br><span class="line">        <span class="type">Options</span> <span class="variable">options</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OptionsBuilder</span>()</span><br><span class="line">            .include(StringBuilderBenchmark.class.getSimpleName())</span><br><span class="line">            .output(<span class="string">&quot;d:/Benchmark.log&quot;</span>)</span><br><span class="line">            .build();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Runner</span>(options).run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‰§è¡Œ-JMH"><a href="#æ‰§è¡Œ-JMH" class="headerlink" title="æ‰§è¡Œ JMH"></a>æ‰§è¡Œ JMH</h3><h4 id="å‘½ä»¤è¡Œ"><a href="#å‘½ä»¤è¡Œ" class="headerlink" title="å‘½ä»¤è¡Œ"></a>å‘½ä»¤è¡Œ</h4><p>ï¼ˆ1ï¼‰åˆå§‹åŒ– <strong>benchmarking</strong> å·¥ç¨‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mvn archetype:generate \</span></span><br><span class="line"><span class="language-bash">          -DinteractiveMode=<span class="literal">false</span> \</span></span><br><span class="line"><span class="language-bash">          -DarchetypeGroupId=org.openjdk.jmh \</span></span><br><span class="line"><span class="language-bash">          -DarchetypeArtifactId=jmh-java-benchmark-archetype \</span></span><br><span class="line"><span class="language-bash">          -DgroupId=org.sample \</span></span><br><span class="line"><span class="language-bash">          -DartifactId=<span class="built_in">test</span> \</span></span><br><span class="line"><span class="language-bash">          -Dversion=1.0</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æ„å»º benchmark</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd test/</span><br><span class="line">mvn clean install</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰è¿è¡Œ benchmark</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/benchmarks.jar</span><br></pre></td></tr></table></figure>

<h4 id="æ‰§è¡Œ-main-æ–¹æ³•"><a href="#æ‰§è¡Œ-main-æ–¹æ³•" class="headerlink" title="æ‰§è¡Œ main æ–¹æ³•"></a>æ‰§è¡Œ main æ–¹æ³•</h4><p>æ‰§è¡Œ main æ–¹æ³•ï¼Œè€å¿ƒç­‰å¾…æµ‹è¯•ç»“æœï¼Œæœ€ç»ˆä¼šç”Ÿæˆä¸€ä¸ªæµ‹è¯•æŠ¥å‘Šï¼Œå†…å®¹å¤§è‡´å¦‚ä¸‹ï¼›</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">JMH version: 1.22</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VM version: JDK 1.8.0_181, Java HotSpot(TM) 64-Bit Server VM, 25.181-b13</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VM invoker: C:\Program Files\Java\jdk1.8.0_181\jre\bin\java.exe</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VM options: -javaagent:D:\Program Files\JetBrains\IntelliJ IDEA 2019.2.3\lib\idea_rt.jar=58635:D:\Program Files\JetBrains\IntelliJ IDEA 2019.2.3\bin -Dfile.encoding=UTF-8</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup: 3 iterations, 10 s each</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Measurement: 10 iterations, 5 s each</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Timeout: 10 min per iteration</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Threads: 8 threads, will synchronize iterations</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Benchmark mode: Throughput, ops/time</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Benchmark: io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringAdd</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Run progress: 0.00% complete, ETA 00:05:20</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fork: 1 of 2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   1: 21803.050 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   2: 22501.860 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   3: 20953.944 ops/ms</span></span><br><span class="line">Iteration   1: 21627.645 ops/ms</span><br><span class="line">Iteration   2: 21215.269 ops/ms</span><br><span class="line">Iteration   3: 20863.282 ops/ms</span><br><span class="line">Iteration   4: 21617.715 ops/ms</span><br><span class="line">Iteration   5: 21695.645 ops/ms</span><br><span class="line">Iteration   6: 21886.784 ops/ms</span><br><span class="line">Iteration   7: 21986.899 ops/ms</span><br><span class="line">Iteration   8: 22389.540 ops/ms</span><br><span class="line">Iteration   9: 22507.313 ops/ms</span><br><span class="line">Iteration  10: 22124.133 ops/ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Run progress: 25.00% complete, ETA 00:04:02</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fork: 2 of 2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   1: 22262.108 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   2: 21567.804 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   3: 21787.002 ops/ms</span></span><br><span class="line">Iteration   1: 21598.970 ops/ms</span><br><span class="line">Iteration   2: 22486.133 ops/ms</span><br><span class="line">Iteration   3: 22157.834 ops/ms</span><br><span class="line">Iteration   4: 22321.827 ops/ms</span><br><span class="line">Iteration   5: 22477.063 ops/ms</span><br><span class="line">Iteration   6: 22154.760 ops/ms</span><br><span class="line">Iteration   7: 21561.095 ops/ms</span><br><span class="line">Iteration   8: 22194.863 ops/ms</span><br><span class="line">Iteration   9: 22493.844 ops/ms</span><br><span class="line">Iteration  10: 22568.078 ops/ms</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Result &quot;io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringAdd&quot;:</span><br><span class="line">  21996.435 Â±(99.9%) 412.955 ops/ms [Average]</span><br><span class="line">  (min, avg, max) = (20863.282, 21996.435, 22568.078), stdev = 475.560</span><br><span class="line">  CI (99.9%): [21583.480, 22409.390] (assumes normal distribution)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">JMH version: 1.22</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VM version: JDK 1.8.0_181, Java HotSpot(TM) 64-Bit Server VM, 25.181-b13</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VM invoker: C:\Program Files\Java\jdk1.8.0_181\jre\bin\java.exe</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VM options: -javaagent:D:\Program Files\JetBrains\IntelliJ IDEA 2019.2.3\lib\idea_rt.jar=58635:D:\Program Files\JetBrains\IntelliJ IDEA 2019.2.3\bin -Dfile.encoding=UTF-8</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup: 3 iterations, 10 s each</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Measurement: 10 iterations, 5 s each</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Timeout: 10 min per iteration</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Threads: 8 threads, will synchronize iterations</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Benchmark mode: Throughput, ops/time</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Benchmark: io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringBuilderAdd</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Run progress: 50.00% complete, ETA 00:02:41</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fork: 1 of 2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   1: 241500.886 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   2: 134206.032 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   3: 86907.846 ops/ms</span></span><br><span class="line">Iteration   1: 86143.339 ops/ms</span><br><span class="line">Iteration   2: 74725.356 ops/ms</span><br><span class="line">Iteration   3: 72316.121 ops/ms</span><br><span class="line">Iteration   4: 77319.716 ops/ms</span><br><span class="line">Iteration   5: 83469.256 ops/ms</span><br><span class="line">Iteration   6: 87712.360 ops/ms</span><br><span class="line">Iteration   7: 79421.899 ops/ms</span><br><span class="line">Iteration   8: 80867.839 ops/ms</span><br><span class="line">Iteration   9: 82619.163 ops/ms</span><br><span class="line">Iteration  10: 87026.928 ops/ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Run progress: 75.00% complete, ETA 00:01:20</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fork: 2 of 2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   1: 228342.337 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   2: 124737.248 ops/ms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Warmup Iteration   3: 82598.851 ops/ms</span></span><br><span class="line">Iteration   1: 86877.318 ops/ms</span><br><span class="line">Iteration   2: 89388.624 ops/ms</span><br><span class="line">Iteration   3: 88523.558 ops/ms</span><br><span class="line">Iteration   4: 87547.332 ops/ms</span><br><span class="line">Iteration   5: 88376.087 ops/ms</span><br><span class="line">Iteration   6: 88848.837 ops/ms</span><br><span class="line">Iteration   7: 85998.124 ops/ms</span><br><span class="line">Iteration   8: 86796.998 ops/ms</span><br><span class="line">Iteration   9: 87994.726 ops/ms</span><br><span class="line">Iteration  10: 87784.453 ops/ms</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Result &quot;io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringBuilderAdd&quot;:</span><br><span class="line">  84487.902 Â±(99.9%) 4355.525 ops/ms [Average]</span><br><span class="line">  (min, avg, max) = (72316.121, 84487.902, 89388.624), stdev = 5015.829</span><br><span class="line">  CI (99.9%): [80132.377, 88843.427] (assumes normal distribution)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Run complete. Total time: 00:05:23</span></span><br><span class="line"></span><br><span class="line">REMEMBER: The numbers below are just data. To gain reusable insights, you need to follow up on</span><br><span class="line">why the numbers are the way they are. Use profilers (see -prof, -lprof), design factorial</span><br><span class="line">experiments, perform baseline and negative tests that provide experimental control, make sure</span><br><span class="line">the benchmarking environment is safe on JVM/OS/HW level, ask for reviews from the domain experts.</span><br><span class="line">Do not assume the numbers tell you what you want them to tell.</span><br><span class="line"></span><br><span class="line">Benchmark                                     Mode  Cnt      Score      Error   Units</span><br><span class="line">StringBuilderBenchmark.testStringAdd         thrpt   20  21996.435 Â±  412.955  ops/ms</span><br><span class="line">StringBuilderBenchmark.testStringBuilderAdd  thrpt   20  84487.902 Â± 4355.525  ops/ms</span><br></pre></td></tr></table></figure>

<h2 id="JMH-API"><a href="#JMH-API" class="headerlink" title="JMH API"></a>JMH API</h2><p>ä¸‹é¢æ¥äº†è§£ä¸€ä¸‹ jmh å¸¸ç”¨ API</p>
<h3 id="BenchmarkMode"><a href="#BenchmarkMode" class="headerlink" title="@BenchmarkMode"></a>@BenchmarkMode</h3><p>åŸºå‡†æµ‹è¯•ç±»å‹ã€‚è¿™é‡Œé€‰æ‹©çš„æ˜¯ <code>Throughput</code> ä¹Ÿå°±æ˜¯ååé‡ã€‚æ ¹æ®æºç ç‚¹è¿›å»ï¼Œæ¯ç§ç±»å‹åé¢éƒ½æœ‰å¯¹åº”çš„è§£é‡Šï¼Œæ¯”è¾ƒå¥½ç†è§£ï¼Œååé‡ä¼šå¾—åˆ°å•ä½æ—¶é—´å†…å¯ä»¥è¿›è¡Œçš„æ“ä½œæ•°ã€‚</p>
<ul>
<li><code>Throughput</code> - æ•´ä½“ååé‡ï¼Œä¾‹å¦‚â€œ1 ç§’å†…å¯ä»¥æ‰§è¡Œå¤šå°‘æ¬¡è°ƒç”¨â€ã€‚</li>
<li><code>AverageTime</code> - è°ƒç”¨çš„å¹³å‡æ—¶é—´ï¼Œä¾‹å¦‚â€œæ¯æ¬¡è°ƒç”¨å¹³å‡è€—æ—¶ xxx æ¯«ç§’â€ã€‚</li>
<li><code>SampleTime</code> - éšæœºå–æ ·ï¼Œæœ€åè¾“å‡ºå–æ ·ç»“æœçš„åˆ†å¸ƒï¼Œä¾‹å¦‚â€œ99%çš„è°ƒç”¨åœ¨ xxx æ¯«ç§’ä»¥å†…ï¼Œ99.99%çš„è°ƒç”¨åœ¨ xxx æ¯«ç§’ä»¥å†…â€</li>
<li><code>SingleShotTime</code> - ä»¥ä¸Šæ¨¡å¼éƒ½æ˜¯é»˜è®¤ä¸€æ¬¡ iteration æ˜¯ 1sï¼Œå”¯æœ‰ SingleShotTime æ˜¯åªè¿è¡Œä¸€æ¬¡ã€‚å¾€å¾€åŒæ—¶æŠŠ warmup æ¬¡æ•°è®¾ä¸º 0ï¼Œç”¨äºæµ‹è¯•å†·å¯åŠ¨æ—¶çš„æ€§èƒ½ã€‚</li>
<li><code>All</code> - æ‰€æœ‰æ¨¡å¼</li>
</ul>
<h3 id="Warmup"><a href="#Warmup" class="headerlink" title="@Warmup"></a>@Warmup</h3><p>ä¸Šé¢æˆ‘ä»¬æåˆ°äº†ï¼Œè¿›è¡ŒåŸºå‡†æµ‹è¯•å‰éœ€è¦è¿›è¡Œé¢„çƒ­ã€‚ä¸€èˆ¬æˆ‘ä»¬å‰å‡ æ¬¡è¿›è¡Œç¨‹åºæµ‹è¯•çš„æ—¶å€™éƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œ æ‰€ä»¥è¦è®©ç¨‹åºè¿›è¡Œå‡ è½®é¢„çƒ­ï¼Œä¿è¯æµ‹è¯•çš„å‡†ç¡®æ€§ã€‚å…¶ä¸­çš„å‚æ•° iterations ä¹Ÿå°±éå¸¸å¥½ç†è§£äº†ï¼Œå°±æ˜¯é¢„çƒ­è½®æ•°ã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦é¢„çƒ­ï¼Ÿå› ä¸º JVM çš„ JIT æœºåˆ¶çš„å­˜åœ¨ï¼Œå¦‚æœæŸä¸ªå‡½æ•°è¢«è°ƒç”¨å¤šæ¬¡ä¹‹åï¼ŒJVM ä¼šå°è¯•å°†å…¶ç¼–è¯‘æˆä¸ºæœºå™¨ç ä»è€Œæé«˜æ‰§è¡Œé€Ÿåº¦ã€‚æ‰€ä»¥ä¸ºäº†è®© benchmark çš„ç»“æœæ›´åŠ æ¥è¿‘çœŸå®æƒ…å†µå°±éœ€è¦è¿›è¡Œé¢„çƒ­ã€‚</p>
<h3 id="Measurement"><a href="#Measurement" class="headerlink" title="@Measurement"></a>@Measurement</h3><p>åº¦é‡ï¼Œå…¶å®å°±æ˜¯ä¸€äº›åŸºæœ¬çš„æµ‹è¯•å‚æ•°ã€‚</p>
<ul>
<li><code>iterations</code> - è¿›è¡Œæµ‹è¯•çš„è½®æ¬¡</li>
<li><code>time</code> - æ¯è½®è¿›è¡Œçš„æ—¶é•¿</li>
<li><code>timeUnit</code> - æ—¶é•¿å•ä½</li>
</ul>
<p>éƒ½æ˜¯ä¸€äº›åŸºæœ¬çš„å‚æ•°ï¼Œå¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ã€‚ä¸€èˆ¬æ¯”è¾ƒé‡çš„ä¸œè¥¿å¯ä»¥è¿›è¡Œå¤§é‡çš„æµ‹è¯•ï¼Œæ”¾åˆ°æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚</p>
<h3 id="Threads"><a href="#Threads" class="headerlink" title="@Threads"></a>@Threads</h3><p>æ¯ä¸ªè¿›ç¨‹ä¸­çš„æµ‹è¯•çº¿ç¨‹ï¼Œè¿™ä¸ªéå¸¸å¥½ç†è§£ï¼Œæ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©ï¼Œä¸€èˆ¬ä¸º cpu ä¹˜ä»¥ 2ã€‚</p>
<h3 id="Fork"><a href="#Fork" class="headerlink" title="@Fork"></a>@Fork</h3><p>è¿›è¡Œ fork çš„æ¬¡æ•°ã€‚å¦‚æœ fork æ•°æ˜¯ 2 çš„è¯ï¼Œåˆ™ JMH ä¼š fork å‡ºä¸¤ä¸ªè¿›ç¨‹æ¥è¿›è¡Œæµ‹è¯•ã€‚</p>
<h3 id="OutputTimeUnit"><a href="#OutputTimeUnit" class="headerlink" title="@OutputTimeUnit"></a>@OutputTimeUnit</h3><p>è¿™ä¸ªæ¯”è¾ƒç®€å•äº†ï¼ŒåŸºå‡†æµ‹è¯•ç»“æœçš„æ—¶é—´ç±»å‹ã€‚ä¸€èˆ¬é€‰æ‹©ç§’ã€æ¯«ç§’ã€å¾®ç§’ã€‚</p>
<h3 id="Benchmark"><a href="#Benchmark" class="headerlink" title="@Benchmark"></a>@Benchmark</h3><p>æ–¹æ³•çº§æ³¨è§£ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯éœ€è¦è¿›è¡Œ benchmark çš„å¯¹è±¡ï¼Œç”¨æ³•å’Œ JUnit çš„ @Test ç±»ä¼¼ã€‚</p>
<h3 id="Param"><a href="#Param" class="headerlink" title="@Param"></a>@Param</h3><p>å±æ€§çº§æ³¨è§£ï¼Œ@Param å¯ä»¥ç”¨æ¥æŒ‡å®šæŸé¡¹å‚æ•°çš„å¤šç§æƒ…å†µã€‚ç‰¹åˆ«é€‚åˆç”¨æ¥æµ‹è¯•ä¸€ä¸ªå‡½æ•°åœ¨ä¸åŒçš„å‚æ•°è¾“å…¥çš„æƒ…å†µä¸‹çš„æ€§èƒ½ã€‚</p>
<h3 id="Setup"><a href="#Setup" class="headerlink" title="@Setup"></a>@Setup</h3><p>æ–¹æ³•çº§æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£çš„ä½œç”¨å°±æ˜¯æˆ‘ä»¬éœ€è¦åœ¨æµ‹è¯•ä¹‹å‰è¿›è¡Œä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ¯”å¦‚å¯¹ä¸€äº›æ•°æ®çš„åˆå§‹åŒ–ä¹‹ç±»çš„ã€‚</p>
<h3 id="TearDown"><a href="#TearDown" class="headerlink" title="@TearDown"></a>@TearDown</h3><p>æ–¹æ³•çº§æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£çš„ä½œç”¨å°±æ˜¯æˆ‘ä»¬éœ€è¦åœ¨æµ‹è¯•ä¹‹åè¿›è¡Œä¸€äº›ç»“æŸå·¥ä½œï¼Œæ¯”å¦‚å…³é—­çº¿ç¨‹æ± ï¼Œæ•°æ®åº“è¿æ¥ç­‰çš„ï¼Œä¸»è¦ç”¨äºèµ„æºçš„å›æ”¶ç­‰ã€‚</p>
<h3 id="State"><a href="#State" class="headerlink" title="@State"></a>@State</h3><p>å½“ä½¿ç”¨ @Setup å‚æ•°çš„æ—¶å€™ï¼Œå¿…é¡»åœ¨ç±»ä¸ŠåŠ è¿™ä¸ªå‚æ•°ï¼Œä¸ç„¶ä¼šæç¤ºæ— æ³•è¿è¡Œã€‚</p>
<p>State ç”¨äºå£°æ˜æŸä¸ªç±»æ˜¯ä¸€ä¸ªâ€œçŠ¶æ€â€ï¼Œç„¶åæ¥å—ä¸€ä¸ª Scope å‚æ•°ç”¨æ¥è¡¨ç¤ºè¯¥çŠ¶æ€çš„å…±äº«èŒƒå›´ã€‚ å› ä¸ºå¾ˆå¤š benchmark ä¼šéœ€è¦ä¸€äº›è¡¨ç¤ºçŠ¶æ€çš„ç±»ï¼ŒJMH å…è®¸ä½ æŠŠè¿™äº›ç±»ä»¥ä¾èµ–æ³¨å…¥çš„æ–¹å¼æ³¨å…¥åˆ° benchmark å‡½æ•°é‡Œã€‚Scope ä¸»è¦åˆ†ä¸ºä¸‰ç§ã€‚</p>
<ul>
<li><code>Thread</code> - è¯¥çŠ¶æ€ä¸ºæ¯ä¸ªçº¿ç¨‹ç‹¬äº«ã€‚</li>
<li><code>Group</code> - è¯¥çŠ¶æ€ä¸ºåŒä¸€ä¸ªç»„é‡Œé¢æ‰€æœ‰çº¿ç¨‹å…±äº«ã€‚</li>
<li><code>Benchmark</code> - è¯¥çŠ¶æ€åœ¨æ‰€æœ‰çº¿ç¨‹é—´å…±äº«ã€‚</li>
</ul>
<p>å…³äº State çš„ç”¨æ³•ï¼Œå®˜æ–¹çš„ code sample é‡Œæœ‰æ¯”è¾ƒå¥½çš„<a target="_blank" rel="noopener" href="http://hg.openjdk.java.net/code-tools/jmh/file/cb9aa824b55a/jmh-samples/src/main/java/org/openjdk/jmh/samples/JMHSample_03_States.java">ä¾‹å­</a>ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="http://hg.openjdk.java.net/code-tools/jmh/file/tip/jmh-samples/src/main/java/org/openjdk/jmh/samples/">jmh å®˜æ–¹ç¤ºä¾‹</a></li>
<li><a target="_blank" rel="noopener" href="https://www.xncoding.com/2018/01/07/java/jmh.html">Java å¾®åŸºå‡†æµ‹è¯•æ¡†æ¶ JMH</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnkirito.moe/java-jmh/">JAVA æ‹¾é— â€” JMH ä¸ 8 ä¸ªæµ‹è¯•é™·é˜±</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/a60ccf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/a60ccf/" class="post-title-link" itemprop="url">Freemark å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/" itemprop="url" rel="index"><span itemprop="name">æ¨¡æ¿å¼•æ“</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>2.9k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>3 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Freemark-å¿«é€Ÿå…¥é—¨"><a href="#Freemark-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Freemark å¿«é€Ÿå…¥é—¨"></a>Freemark å¿«é€Ÿå…¥é—¨</h1><blockquote>
<p>FreeMarker æ˜¯ä¸€æ¬¾æ¨¡æ¿å¼•æ“ï¼š å³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œ å¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬(HTML ç½‘é¡µï¼Œç”µå­é‚®ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼Œæºä»£ç ç­‰)çš„é€šç”¨å·¥å…·ã€‚ å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ª Java ç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚</p>
</blockquote>
<h2 id="Freemark-ç®€ä»‹"><a href="#Freemark-ç®€ä»‹" class="headerlink" title="Freemark ç®€ä»‹"></a>Freemark ç®€ä»‹</h2><p>Freemark æ¨¡æ¿ç¼–å†™ä¸º FreeMarker Template Language (FTL)ã€‚å®ƒæ˜¯ç®€å•çš„ï¼Œä¸“ç”¨çš„è¯­è¨€ï¼Œ <em>ä¸æ˜¯</em> åƒ PHP é‚£æ ·æˆç†Ÿçš„ç¼–ç¨‹è¯­è¨€ã€‚åœ¨æ¨¡æ¿ä¸­ï¼Œä½ å¯ä»¥ä¸“æ³¨äºå¦‚ä½•å±•ç°æ•°æ®ï¼Œ è€Œåœ¨æ¨¡æ¿ä¹‹å¤–å¯ä»¥ä¸“æ³¨äºè¦å±•ç¤ºä»€ä¹ˆæ•°æ®ã€‚</p>
<p><img src="http://freemarker.foofun.cn/figures/overview.png" alt="img"></p>
<p>è¿™ç§æ–¹å¼é€šå¸¸è¢«ç§°ä¸º <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.MVC">MVC (æ¨¡å‹ è§†å›¾ æ§åˆ¶å™¨) æ¨¡å¼</a>ï¼Œå¯¹äºåŠ¨æ€ç½‘é¡µæ¥è¯´ï¼Œæ˜¯ä¸€ç§ç‰¹åˆ«æµè¡Œçš„æ¨¡å¼ã€‚ å®ƒå¸®åŠ©ä»å¼€å‘äººå‘˜(Java ç¨‹åºå‘˜)ä¸­åˆ†ç¦»å‡ºç½‘é¡µè®¾è®¡å¸ˆ(HTML è®¾è®¡å¸ˆ)ã€‚è®¾è®¡å¸ˆæ— éœ€é¢å¯¹æ¨¡æ¿ä¸­çš„å¤æ‚é€»è¾‘ï¼Œ åœ¨æ²¡æœ‰ç¨‹åºå‘˜æ¥ä¿®æ”¹æˆ–é‡æ–°ç¼–è¯‘ä»£ç æ—¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹é¡µé¢çš„æ ·å¼ã€‚</p>
<p>Freemark æ¨¡æ¿ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š**_<code>æ¨¡æ¿ + æ•°æ®æ¨¡å‹ = è¾“å‡º</code>_**</p>
<h2 id="æ€»ä½“ç»“æ„"><a href="#æ€»ä½“ç»“æ„" class="headerlink" title="æ€»ä½“ç»“æ„"></a>æ€»ä½“ç»“æ„</h2><ul>
<li><strong>æ–‡æœ¬</strong>ï¼šæ–‡æœ¬ä¼šç…§ç€åŸæ ·æ¥è¾“å‡ºã€‚</li>
<li><strong>æ’å€¼</strong>ï¼šè¿™éƒ¨åˆ†çš„è¾“å‡ºä¼šè¢«è®¡ç®—çš„å€¼æ¥æ›¿æ¢ã€‚æ’å€¼ç”± <code>$&#123;</code> and <code>&#125;</code> æ‰€åˆ†éš”(æˆ–è€… <code>#&#123;</code> and <code>&#125;</code>ï¼Œè¿™ç§é£æ ¼å·²ç»ä¸å»ºè®®å†ä½¿ç”¨äº†ï¼›<a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_depr_numerical_interpolation.html">ç‚¹å‡»æŸ¥çœ‹æ›´å¤š</a>)ã€‚</li>
<li><strong>FTL æ ‡ç­¾</strong>ï¼šFTL æ ‡ç­¾å’Œ HTML æ ‡ç­¾å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬å´æ˜¯ç»™ FreeMarker çš„æŒ‡ç¤ºï¼Œ è€Œä¸”ä¸ä¼šæ‰“å°åœ¨è¾“å‡ºå†…å®¹ä¸­ã€‚</li>
<li><strong>æ³¨é‡Š</strong>ï¼šæ³¨é‡Šå’Œ HTML çš„æ³¨é‡Šä¹Ÿå¾ˆç›¸ä¼¼ï¼Œä½†å®ƒä»¬æ˜¯ç”± <code>&lt;#--</code> å’Œ <code>--&gt;</code>æ¥åˆ†éš”çš„ã€‚æ³¨é‡Šä¼šè¢« FreeMarker ç›´æ¥å¿½ç•¥ï¼Œ æ›´ä¸ä¼šåœ¨è¾“å‡ºå†…å®¹ä¸­æ˜¾ç¤ºã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/ftl-template.png" alt="img"></p>
<blockquote>
<p>ğŸ”” æ³¨æ„ï¼š</p>
<ul>
<li>FTL æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚</li>
<li><code>æ’å€¼</code> ä»…ä»…å¯ä»¥åœ¨ <code>æ–‡æœ¬</code> ä¸­ä½¿ç”¨ã€‚</li>
<li><code>FTL æ ‡ç­¾</code> ä¸å¯ä»¥åœ¨å…¶ä»– <code>FTL æ ‡ç­¾</code> å’Œ <code>æ’å€¼</code> ä¸­ä½¿ç”¨ã€‚</li>
<li><code>æ³¨é‡Š</code> å¯ä»¥æ”¾åœ¨ <code>FTL æ ‡ç­¾</code> å’Œ <code>æ’å€¼</code> ä¸­ã€‚</li>
</ul>
</blockquote>
<h3 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h3><p>FTL æŒ‡ä»¤æœ‰ä¸¤ç§ç±»å‹ï¼š <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.predefinedDirective">é¢„å®šä¹‰æŒ‡ä»¤</a> å’Œ <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.userDefinedDirective">ç”¨æˆ·è‡ªå®šä¹‰æŒ‡ä»¤</a>ã€‚ å¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„æŒ‡ä»¤ä½¿ç”¨ <code>@</code> æ¥ä»£æ›¿ <code>#</code>ã€‚</p>
<blockquote>
<p>ğŸ”” æ³¨æ„ï¼š</p>
<ul>
<li>FreeMarker ä»…ä»…å…³å¿ƒ FTL æ ‡ç­¾çš„åµŒå¥—è€Œä¸å…³å¿ƒ HTML æ ‡ç­¾çš„åµŒå¥—ã€‚ å®ƒåªä¼šæŠŠ HTML çœ‹åšæ˜¯æ–‡æœ¬ï¼Œä¸ä¼šæ¥è§£é‡Š HTMLã€‚</li>
<li>å¦‚æœä½ å°è¯•ä½¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡ä»¤(æ¯”å¦‚ï¼Œè¾“é”™äº†æŒ‡ä»¤çš„åç§°)ï¼Œ FreeMarker å°±ä¼šæ‹’ç»æ‰§è¡Œæ¨¡æ¿ï¼ŒåŒæ—¶æŠ›å‡ºé”™è¯¯ä¿¡æ¯ã€‚</li>
<li>FreeMarker ä¼šå¿½ç•¥ FTL æ ‡ç­¾ä¸­å¤šä½™çš„ <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.whiteSpace">ç©ºç™½æ ‡è®°</a>ã€‚</li>
</ul>
</blockquote>
<h3 id="è¡¨è¾¾å¼"><a href="#è¡¨è¾¾å¼" class="headerlink" title="è¡¨è¾¾å¼"></a>è¡¨è¾¾å¼</h3><p>ä»¥ä¸‹ä¸ºå¿«é€Ÿæµè§ˆæ¸…å•ï¼Œå¦‚æœéœ€è¦äº†è§£æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è€ƒ<a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html"><strong>è¿™é‡Œ</strong></a>ã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct">ç›´æ¥æŒ‡å®šå€¼</a><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_string">å­—ç¬¦ä¸²</a>ï¼š <code>&quot;Foo&quot;</code> æˆ–è€… <code>&#39;Foo&#39;</code> æˆ–è€… <code>&quot;It&#39;s \&quot;quoted\&quot;&quot;</code> æˆ–è€… <code>&#39;It\&#39;s &quot;quoted&quot;&#39;</code> æˆ–è€… <code>r&quot;C:\raw\string&quot;</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_number">æ•°å­—</a>ï¼š <code>123.45</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_boolean">å¸ƒå°”å€¼</a>ï¼š <code>true</code>ï¼Œ <code>false</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_seuqence">åºåˆ—</a>ï¼š <code>[&quot;foo&quot;, &quot;bar&quot;, 123.45]</code>ï¼› å€¼åŸŸï¼š <code>0..9</code>, <code>0..&lt;10</code> (æˆ– <code>0..!10</code>), <code>0..</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_hash">å“ˆå¸Œè¡¨</a>ï¼š <code>&#123;&quot;name&quot;:&quot;green mouse&quot;, &quot;price&quot;:150&#125;</code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var">æ£€ç´¢å˜é‡</a><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_toplevel">é¡¶å±‚å˜é‡</a>ï¼š <code>user</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_hash">ä»å“ˆå¸Œè¡¨ä¸­æ£€ç´¢æ•°æ®</a>ï¼š <code>user.name</code>ï¼Œ <code>user[&quot;name&quot;]</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_sequence">ä»åºåˆ—ä¸­æ£€ç´¢æ•°æ®</a>ï¼š <code>products[5]</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_special">ç‰¹æ®Šå˜é‡</a>ï¼š <code>.main</code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_stringop">å­—ç¬¦ä¸²æ“ä½œ</a><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_stringop_interpolation">æ’å€¼(æˆ–è¿æ¥)</a>ï¼š <code>&quot;Hello $&#123;user&#125;!&quot;</code> (æˆ– <code>&quot;Hello &quot; + user + &quot;!&quot;</code>)</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_get_character">è·å–ä¸€ä¸ªå­—ç¬¦</a>ï¼š <code>name[0]</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_stringop_slice">å­—ç¬¦ä¸²åˆ‡åˆ†ï¼š</a> åŒ…å«ç»“å°¾ï¼š <code>name[0..4]</code>ï¼Œä¸åŒ…å«ç»“å°¾ï¼š <code>name[0..&lt;5]</code>ï¼ŒåŸºäºé•¿åº¦(å®½å®¹å¤„ç†)ï¼š <code>name[0..*5]</code>ï¼Œå»é™¤å¼€å¤´ï¼š<code>name[5..]</code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_sequenceop">åºåˆ—æ“ä½œ</a><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_sequenceop_cat">è¿æ¥</a>ï¼š <code>users + [&quot;guest&quot;]</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_seqenceop_slice">åºåˆ—åˆ‡åˆ†</a>ï¼šåŒ…å«ç»“å°¾ï¼š <code>products[20..29]</code>ï¼Œ ä¸åŒ…å«ç»“å°¾ï¼š <code>products[20..&lt;30]</code>ï¼ŒåŸºäºé•¿åº¦(å®½å®¹å¤„ç†)ï¼š<code>products[20..*10]</code>ï¼Œå»é™¤å¼€å¤´ï¼š <code>products[20..]</code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_hashop">å“ˆå¸Œè¡¨æ“ä½œ</a><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_hashop_cat">è¿æ¥</a>ï¼š <code>passwords + &#123; &quot;joe&quot;: &quot;secret42&quot; &#125;</code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_arit">ç®—æœ¯è¿ç®—</a>ï¼š <code>(x * 1.5 + 10) / 2 - y % 100</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_comparison">æ¯”è¾ƒè¿ç®—</a>ï¼š <code>x == y</code>ï¼Œ <code>x != y</code>ï¼Œ <code>x &lt; y</code>ï¼Œ <code>x &gt; y</code>ï¼Œ <code>x &gt;= y</code>ï¼Œ <code>x &lt;= y</code>ï¼Œ <code>x lt y</code>ï¼Œ <code>x lte y</code>ï¼Œ <code>x gt y</code>ï¼Œ <code>x gte y</code>ï¼Œ ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_logicalop">é€»è¾‘æ“ä½œ</a>ï¼š <code>!registered &amp;&amp; (firstVisit || fromEurope)</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_builtin">å†…å»ºå‡½æ•°</a>ï¼š <code>name?upper_case</code>, <code>path?ensure_starts_with(&#39;/&#39;)</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_methodcall">æ–¹æ³•è°ƒç”¨</a>ï¼š <code>repeat(&quot;What&quot;, 3)</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_missing">å¤„ç†ä¸å­˜åœ¨çš„å€¼</a><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_missing_default">é»˜è®¤å€¼</a>ï¼š <code>name!&quot;unknown&quot;</code> æˆ–è€… <code>(user.name)!&quot;unknown&quot;</code> æˆ–è€… <code>name!</code> æˆ–è€… <code>(user.name)!</code></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_missing_test">æ£€æµ‹ä¸å­˜åœ¨çš„å€¼</a>ï¼š <code>name??</code> æˆ–è€… <code>(user.name)??</code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_assignment">èµ‹å€¼æ“ä½œ</a>ï¼š <code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>%=</code>, <code>++</code>, <code>--</code></li>
</ul>
<h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>æ³¨æ„ï¼šå˜é‡ <em>ä»…ä»…</em> åœ¨ <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_overallstructure.html">æ–‡æœ¬åŒº</a> (æ¯”å¦‚ <code>&lt;h1&gt;Hello $&#123;name&#125;!&lt;/h1&gt;</code>) å’Œ <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_string">å­—ç¬¦ä¸²</a> ä¸­èµ·ä½œç”¨ã€‚</p>
<p>æ­£ç¡®ç¤ºä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;/footer/$&#123;company&#125;.html&quot;</span>&gt;</span></span><br><span class="line">&lt;<span class="meta">#<span class="keyword">if</span> big&gt;...<span class="string">&lt;/#if&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>é”™è¯¯ç¤ºä¾‹ï¼š</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;#if $&#123;big&#125;&gt;<span class="params">...</span>&lt;/#if&gt;</span><br><span class="line">&lt;#if <span class="string">&quot;$&#123;big&#125;&quot;</span>&gt;<span class="params">...</span>&lt;/#if&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><p>Freemark æ”¯æŒçš„ç±»å‹æœ‰ï¼š</p>
<h3 id="æ ‡é‡"><a href="#æ ‡é‡" class="headerlink" title="æ ‡é‡"></a>æ ‡é‡</h3><p>å­—ç¬¦ä¸²</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;<span class="string">&quot;Hello $&#123;user&#125;&quot;</span>&#125;</span><br><span class="line">$&#123;<span class="string">&quot;I can escape with \\ $&#123;user&#125;&quot;</span>&#125;</span><br><span class="line">$&#123;<span class="string">r&quot;Now I can read dollar signs $&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello deister</span><br><span class="line">I can <span class="built_in">escape</span> <span class="keyword">with</span> <span class="string">\</span> deister</span><br><span class="line">Now I can read dollar signs $</span><br></pre></td></tr></table></figure>

<p>æ•°å­—</p>
<p>å¸ƒå°”å€¼</p>
<p>æ—¥æœŸ&#x2F;æ—¶é—´ (æ—¥æœŸï¼Œæ—¶é—´æˆ–æ—¥æœŸæ—¶é—´)</p>
<h3 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h3><ul>
<li>å“ˆå¸Œè¡¨</li>
<li>åºåˆ—</li>
<li>é›†åˆ</li>
</ul>
<h3 id="å­ç¨‹åº"><a href="#å­ç¨‹åº" class="headerlink" title="å­ç¨‹åº"></a>å­ç¨‹åº</h3><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_datamodel_types.html#dgui_datamodel_method">æ–¹æ³•å’Œå‡½æ•°</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_datamodel_types.html#dgui_datamodel_userdefdir">ç”¨æˆ·è‡ªå®šä¹‰æŒ‡ä»¤</a></li>
</ul>
<h3 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h3><ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/dgui_datamodel_types.html#dgui_datamodel_node">ç»“ç‚¹</a></li>
</ul>
<h2 id="è½¬ä¹‰ç¬¦"><a href="#è½¬ä¹‰ç¬¦" class="headerlink" title="è½¬ä¹‰ç¬¦"></a>è½¬ä¹‰ç¬¦</h2><p>FTL æ”¯æŒçš„æ‰€æœ‰è½¬ä¹‰å­—ç¬¦ï¼š</p>
<table>
<thead>
<tr>
<th align="left">è½¬ä¹‰åºåˆ—</th>
<th align="left">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>\&quot;</code></td>
<td align="left">å¼•å· (u0022)</td>
</tr>
<tr>
<td align="left"><code>\&#39;</code></td>
<td align="left">å•å¼•å·(åˆç§°ä¸ºæ’‡å·) (u0027)</td>
</tr>
<tr>
<td align="left"><code>\&#123;</code></td>
<td align="left">èµ·å§‹èŠ±æ‹¬å·ï¼š<code>&#123;</code></td>
</tr>
<tr>
<td align="left"><code>\\</code></td>
<td align="left">åæ–œæ  (u005C)</td>
</tr>
<tr>
<td align="left"><code>\n</code></td>
<td align="left">æ¢è¡Œç¬¦ (u000A)</td>
</tr>
<tr>
<td align="left"><code>\r</code></td>
<td align="left">å›è½¦ (u000D)</td>
</tr>
<tr>
<td align="left"><code>\t</code></td>
<td align="left">æ°´å¹³åˆ¶è¡¨ç¬¦(åˆç§°ä¸º tab) (u0009)</td>
</tr>
<tr>
<td align="left"><code>\b</code></td>
<td align="left">é€€æ ¼ (u0008)</td>
</tr>
<tr>
<td align="left"><code>\f</code></td>
<td align="left">æ¢é¡µ (u000C)</td>
</tr>
<tr>
<td align="left"><code>\l</code></td>
<td align="left">å°äºå·ï¼š<code>&lt;</code></td>
</tr>
<tr>
<td align="left"><code>\g</code></td>
<td align="left">å¤§äºå·ï¼š<code>&gt;</code></td>
</tr>
<tr>
<td align="left"><code>\a</code></td>
<td align="left">&amp;ç¬¦ï¼š<code>&amp;</code></td>
</tr>
<tr>
<td align="left"><code>\xCode</code></td>
<td align="left">å­—ç¬¦çš„ 16 è¿›åˆ¶ <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.unicode">Unicode</a> ç  (<a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.UCS">UCS</a> ç )</td>
</tr>
</tbody></table>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/freemarker">Freemark Github</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/">Freemark ä¸­æ–‡æ•™ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://try.freemarker.apache.org/">åœ¨çº¿ Freemark å·¥å…·</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/3ba0ff/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/3ba0ff/" class="post-title-link" itemprop="url">Velocity å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/" itemprop="url" rel="index"><span itemprop="name">æ¨¡æ¿å¼•æ“</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>4.2k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>4 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Velocity-å¿«é€Ÿå…¥é—¨"><a href="#Velocity-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Velocity å¿«é€Ÿå…¥é—¨"></a>Velocity å¿«é€Ÿå…¥é—¨</h1><p><strong>Velocity ï¼ˆç®€ç§° VTLï¼‰æ˜¯ä¸€ä¸ªåŸºäº Java çš„æ¨¡ç‰ˆå¼•æ“</strong>ã€‚å®ƒå…è®¸ web é¡µé¢è®¾è®¡è€…å¼•ç”¨ JAVA ä»£ç é¢„å®šä¹‰çš„æ–¹æ³•ã€‚Web è®¾è®¡è€…å¯ä»¥æ ¹æ® MVC æ¨¡å¼å’Œ JAVA ç¨‹åºå‘˜å¹¶è¡Œå·¥ä½œï¼Œè¿™æ„å‘³ç€ Web è®¾è®¡è€…å¯ä»¥å•ç‹¬ä¸“æ³¨äºè®¾è®¡è‰¯å¥½çš„ç«™ç‚¹ï¼Œè€Œç¨‹åºå‘˜åˆ™å¯å•ç‹¬ä¸“æ³¨äºç¼–å†™åº•å±‚ä»£ç ã€‚Velocity å°† Java ä»£ç ä» web é¡µé¢ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½¿ç«™ç‚¹åœ¨é•¿æ—¶é—´è¿è¡Œåä»ç„¶å…·æœ‰å¾ˆå¥½çš„å¯ç»´æŠ¤æ€§ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªé™¤ JSP å’Œ PHP ä¹‹å¤–çš„å¯è¡Œçš„è¢«é€‰æ–¹æ¡ˆã€‚</p>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>å•è¡Œæ³¨é‡Šä»¥##å¼€å§‹ï¼Œå¹¶åœ¨æœ¬è¡Œç»“æŸã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## This is a single line comment.</span><br></pre></td></tr></table></figure>

<p>å¤šè¡Œæ³¨é‡Šï¼Œä»¥ <code>#</code> å¼€å§‹å¹¶ä»¥ <code>#</code> ç»“æŸå¯ä»¥å¤„ç†è¿™ç§æƒ…å†µã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#*</span><br><span class="line"> Thus begins a multi-line comment. Online visitors won&#x27;t</span><br><span class="line"> see this text because the Velocity Templating Engine will</span><br><span class="line"> ignore it.</span><br><span class="line">*#</span><br></pre></td></tr></table></figure>

<p>æ³¨é‡Šå— ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨è¯¸å¦‚æ–‡æ¡£ä½œè€…ã€ç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#**</span><br><span class="line">This is a VTL comment block and</span><br><span class="line">may be used to store such information</span><br><span class="line">as the document author and versioning</span><br><span class="line">information:</span><br><span class="line">@author</span><br><span class="line">@version 5</span><br><span class="line">*#</span><br></pre></td></tr></table></figure>

<h2 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h2><p>VTL ä¸­æœ‰ä¸‰ç§ç±»å‹çš„å¼•ç”¨ï¼šå˜é‡ï¼Œå±æ€§å’Œæ–¹æ³•ã€‚</p>
<h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>å˜é‡ï¼ˆVariablesï¼‰çš„ç®€ç•¥æ ‡è®°æ˜¯æœ‰ä¸€ä¸ªå‰å¯¼ <code>$</code> å­—ç¬¦åè·Ÿä¸€ä¸ª VTL æ ‡è¯†ç¬¦ï¼ˆIdentifier.ï¼‰ç»„æˆã€‚ä¸€ä¸ª VTL æ ‡è¯†ç¬¦å¿…é¡»ä»¥ä¸€ä¸ªå­—æ¯å¼€å§‹(a .. z æˆ– A .. Z)ã€‚</p>
<p>å‰©ä¸‹çš„å­—ç¬¦å°†ç”±ä»¥ä¸‹ç±»å‹çš„å­—ç¬¦ç»„æˆï¼š</p>
<ul>
<li>å­—æ¯ (a .. z, A .. Z)</li>
<li>æ•°å­— (0 .. 9)</li>
<li>è¿å­—ç¬¦(â€œ-â€œ)</li>
<li>ä¸‹åˆ’çº¿ (â€œ_â€œ)</li>
</ul>
<p>ç¤ºä¾‹ï¼šæœ‰æ•ˆå˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">## æœ‰æ•ˆå˜é‡å˜é‡å</span><br><span class="line">$foo</span><br><span class="line">$mudSlinger</span><br><span class="line">$mud-slinger</span><br><span class="line">$mud_slinger</span><br><span class="line">$mudSlinger1</span><br><span class="line"></span><br><span class="line">## ç»™å˜é‡èµ‹å€¼</span><br><span class="line">#set( $foo = &quot;bar&quot; )</span><br></pre></td></tr></table></figure>

<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><p>VTL å¼•ç”¨çš„ç¬¬äºŒç§å…ƒç´ æ˜¯å±æ€§ï¼Œè€Œå±æ€§å…·æœ‰ç‹¬ç‰¹çš„æ ¼å¼ã€‚å±æ€§çš„ç®€ç•¥æ ‡è®°è¯†å‰å¯¼ç¬¦ <code>$</code> åè·Ÿä¸€ä¸ª VTL æ ‡è¯†ç¬¦ï¼Œåœ¨åè·Ÿä¸€ä¸ªç‚¹å·(â€œ.â€)æœ€ååˆæ˜¯ä¸€ä¸ª VTL æ ‡è¯†ç¬¦ã€‚</p>
<p>ç¤ºä¾‹ï¼šæœ‰æ•ˆå±æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$customer.Address</span><br><span class="line">$purchase.Total</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>æ–¹æ³•åœ¨ JAVA ä»£ç ä¸­å®šä¹‰ï¼Œå¹¶ä½œä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¿è¡Œä¸€ä¸ªè®¡ç®—å™¨æˆ–è€…ä½œå‡ºä¸€ä¸ªå†³å®šã€‚æ–¹æ³•æ˜¯å®é™…ä¸Šä¹Ÿæ˜¯å¼•ç”¨ï¼Œç”±å‰å¯¼ç¬¦ <code>$</code> åè·Ÿä¸€ä¸ª VTL æ ‡è¯†ç¬¦ï¼Œåè·Ÿä¸€ä¸ª VTL æ–¹æ³•ä½“ï¼ˆMethod Bodyï¼‰ã€‚ VTL æ–¹æ³•ä½“ç”±ä¸€ä¸ª VTL æ ‡è¯†ç¬¦åè·Ÿä¸€ä¸ªå·¦æ‹¬å·ï¼Œå†è·Ÿå¯é€‰çš„å‚æ•°åˆ—è¡¨ï¼Œæœ€åæ˜¯å³æ‹¬å·ã€‚</p>
<p>ç¤ºä¾‹ï¼šæœ‰æ•ˆæ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$customer.getAddress()</span><br><span class="line">$purchase.getTotal()</span><br><span class="line">$page.setTitle( &quot;My Home Page&quot; )</span><br><span class="line">$person.setAttributes( [&quot;Strange&quot;, &quot;Weird&quot;, &quot;Excited&quot;] )</span><br></pre></td></tr></table></figure>

<h2 id="èµ‹å€¼"><a href="#èµ‹å€¼" class="headerlink" title="èµ‹å€¼"></a>èµ‹å€¼</h2><p><code>#set</code> æŒ‡ä»¤ç”¨æ¥ä¸ºå¼•ç”¨è®¾ç½®ç›¸åº”çš„å€¼ã€‚å€¼å¯ä»¥è¢«å€¼æ´¾ç»™å˜é‡å¼•ç”¨æˆ–è€…æ˜¯å±æ€§å¼•ç”¨ï¼Œè€Œä¸”èµ‹å€¼è¦åœ¨æ‹¬å·é‡Œæ‹¬èµ·æ¥ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#set( $monkey = $bill ) ## variable reference</span><br><span class="line">#set( $monkey.Friend = &quot;monica&quot; ) ## string literal</span><br><span class="line">#set( $monkey.Blame = $whitehouse.Leak ) ## property reference</span><br><span class="line">#set( $monkey.Plan = $spindoctor.weave($web) ) ## method reference</span><br><span class="line">#set( $monkey.Number = 123 ) ##number literal</span><br><span class="line">#set( $monkey.Say = [&quot;Not&quot;, $my, &quot;fault&quot;] ) ## ArrayList</span><br></pre></td></tr></table></figure>

<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>ä½¿ç”¨ <code>#set</code> æŒ‡ä»¤æ—¶ï¼Œæ‹¬åœ¨åŒå¼•å·ä¸­çš„å­—é¢å­—ç¬¦ä¸²å°†è§£æå’Œé‡æ–°è§£é‡Š ã€‚ ç„¶è€Œï¼Œå½“å­—é¢å­—ç¬¦ä¸²æ‹¬åœ¨å•å¼•å·ä¸­æ—¶ï¼Œä¸è¢«è§£æï¼š</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#set( $foo = &quot;bar&quot; )</span><br><span class="line">$foo</span><br><span class="line">#set( $blargh = &#x27;$foo&#x27; )</span><br><span class="line">$blargh</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Bar</span><br><span class="line"> $foo</span><br></pre></td></tr></table></figure>

<h2 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h2><p>VTL ä½¿ç”¨ <code>#If</code>ã€<code>#elseif</code>ã€<code>#else</code> æŒ‡ä»¤åšæ¡ä»¶è¯­å¥æ§åˆ¶ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#if( $foo &lt; 10 )</span><br><span class="line">    &lt;strong&gt;Go North&lt;/strong&gt;</span><br><span class="line">#elseif( $foo == 10 )</span><br><span class="line">    &lt;strong&gt;Go East&lt;/strong&gt;</span><br><span class="line">#elseif( $bar == 6 )</span><br><span class="line">    &lt;strong&gt;Go South&lt;/strong&gt;</span><br><span class="line">#else</span><br><span class="line">    &lt;strong&gt;Go West&lt;/strong&gt;</span><br><span class="line">#end</span><br></pre></td></tr></table></figure>

<h2 id="é€»è¾‘"><a href="#é€»è¾‘" class="headerlink" title="é€»è¾‘"></a>é€»è¾‘</h2><p>VTL æ”¯æŒä¸ï¼ˆ<code>&amp;&amp;</code>ï¼‰ã€æˆ–ï¼ˆ<code>||</code>ï¼‰ã€éï¼ˆ<code>!</code>ï¼‰é€»è¾‘åˆ¤æ–­ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#if( $foo &amp;&amp; $bar )</span><br><span class="line">   &lt;strong&gt; This AND that&lt;/strong&gt;</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">#if( $foo || $bar )</span><br><span class="line">    &lt;strong&gt;This or That&lt;/strong&gt;</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">#if( !$foo )</span><br><span class="line"> &lt;strong&gt;NOT that&lt;/strong&gt;</span><br><span class="line">#end</span><br></pre></td></tr></table></figure>

<h2 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h2><p>VTL é€šè¿‡ <code>#foreach</code> æ”¯æŒå¾ªç¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">#foreach( $product in $allProducts )</span><br><span class="line">    &lt;li&gt;$product&lt;/li&gt;</span><br><span class="line">#end</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<h2 id="åŒ…å«"><a href="#åŒ…å«" class="headerlink" title="åŒ…å«"></a>åŒ…å«</h2><p>VTL é€šè¿‡ <code>#include</code> æ¥å¯¼å…¥å…¶ä»–æ–‡ä»¶ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include( &quot;one.txt&quot; )</span><br><span class="line"></span><br><span class="line">#include( &quot;one.gif&quot;,&quot;two.txt&quot;,&quot;three.htm&quot; )</span><br><span class="line"></span><br><span class="line">#include( &quot;greetings.txt&quot;, $seasonalstock )</span><br></pre></td></tr></table></figure>

<h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p>VTL é€šè¿‡ <code>#parse</code> å¯¼å…¥å…¶ä»– vm æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$count</span><br><span class="line">#set( $count = $count - 1 )</span><br><span class="line">#if( $count &gt; 0 )</span><br><span class="line">    #parse( &quot;parsefoo.vm&quot; )</span><br><span class="line">#else</span><br><span class="line">    All done with parsefoo.vm!</span><br><span class="line">#end</span><br></pre></td></tr></table></figure>

<h2 id="åœæ­¢"><a href="#åœæ­¢" class="headerlink" title="åœæ­¢"></a>åœæ­¢</h2><p>VTL ä½¿ç”¨ <code>#stop</code> åœæ­¢æ¨¡æ¿å¼•æ“çš„æ‰§è¡Œï¼Œå¹¶è¿”å›ã€‚è¿™é€šå¸¸ç”¨ä½œè°ƒè¯•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#stop ##</span><br></pre></td></tr></table></figure>

<h2 id="å®"><a href="#å®" class="headerlink" title="å®"></a>å®</h2><p>VTL ä½¿ç”¨ <code>#macro</code> å’Œ <code>#end</code> é…åˆæ¥å®šä¹‰å®ï¼Œä»¥æ­¤å®ç°è‡ªå®šä¹‰æŒ‡ä»¤ã€‚</p>
<p>ç¤ºä¾‹ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">## å®šä¹‰å®</span><br><span class="line">#macro( d )</span><br><span class="line">&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">## ä½¿ç”¨å®</span><br><span class="line">#d()</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">## å®šä¹‰å®</span><br><span class="line">#macro( tablerows $color $somelist )</span><br><span class="line">  #foreach( $something in $somelist )</span><br><span class="line">    &lt;tr&gt;&lt;td bgcolor=$color&gt;$something&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">  #end</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">## ä½¿ç”¨å®</span><br><span class="line">#set( $greatlakes = [&quot;Superior&quot;,&quot;Michigan&quot;,&quot;Huron&quot;,&quot;Erie&quot;,&quot;Ontario&quot;] )</span><br><span class="line">#set( $color = &quot;blue&quot; )</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    #tablerows( $color $greatlakes )</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>Superior<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>Michigan<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>Huron<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>Erie<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>Ontario<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="è½¬ä¹‰"><a href="#è½¬ä¹‰" class="headerlink" title="è½¬ä¹‰"></a>è½¬ä¹‰</h2><p>VTL ä½¿ç”¨ <code>\</code> ç¬¦å·æ¥è¿›è¡Œå­—ç¬¦è½¬ä¹‰ã€‚</p>
<p>ç¤ºä¾‹ä¸€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">## The following line defines $email in this template:</span><br><span class="line">#set( $email = &quot;foo&quot; )</span><br><span class="line">$email</span><br><span class="line">\$email</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo</span><br><span class="line">$email</span><br></pre></td></tr></table></figure>

<h2 id="è¯­ä¹‰è¦ç‚¹"><a href="#è¯­ä¹‰è¦ç‚¹" class="headerlink" title="è¯­ä¹‰è¦ç‚¹"></a>è¯­ä¹‰è¦ç‚¹</h2><p>Velocity æœ‰ä¸€äº›è¯­ä¹‰è¦ç‚¹ï¼Œå®¹æ˜“äº§ç”Ÿæ­§ä¹‰ï¼Œè¿™é‡Œå½’çº³ä¸€ä¸‹ã€‚</p>
<p>ï¼ˆ1ï¼‰<strong>Velocity çš„è¡Œä¸ºå¹¶ä¸å—ç©ºæ ¼çš„å½±å“</strong>ã€‚</p>
<p>ç¤ºä¾‹ï¼šä»¥ä¸‹ä¸‰ç§å†™æ³•æ•ˆæœä¸€è‡´</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">## å†™æ³•ä¸€</span><br><span class="line">Send me #set($foo = [&quot;$10 and &quot;,&quot;a cake&quot;])#foreach($a in $foo)$a #end please.</span><br><span class="line"></span><br><span class="line">## å†™æ³•äºŒ</span><br><span class="line">Send me</span><br><span class="line">#set( $foo = [&quot;$10 and &quot;,&quot;a cake&quot;] )</span><br><span class="line">#foreach( $a in $foo )</span><br><span class="line">$a</span><br><span class="line">#end</span><br><span class="line">please.</span><br><span class="line"></span><br><span class="line">## å†™æ³•ä¸‰</span><br><span class="line">Send me</span><br><span class="line">#set($foo       = [&quot;$10 and &quot;,&quot;a cake&quot;])</span><br><span class="line">                 #foreach           ($a in $foo )$a</span><br><span class="line">         #end please.</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/velocity-engine/">Velocity Github</a></li>
<li><a target="_blank" rel="noopener" href="https://velocity.apache.org/">Velocity å®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/velocity-doc/content/">Velocity ä¸­æ–‡æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/velocity-spring-boot-project">velocity-spring-boot-project</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/e7d2ad/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/e7d2ad/" class="post-title-link" itemprop="url">Thymeleaf å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E5%B7%A5%E5%85%B7/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/" itemprop="url" rel="index"><span itemprop="name">æ¨¡æ¿å¼•æ“</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>9.2k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>8 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Thymeleaf-å¿«é€Ÿå…¥é—¨"><a href="#Thymeleaf-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Thymeleaf å¿«é€Ÿå…¥é—¨"></a>Thymeleaf å¿«é€Ÿå…¥é—¨</h1><h2 id="æ ‡å‡†æ–¹è¨€"><a href="#æ ‡å‡†æ–¹è¨€" class="headerlink" title="æ ‡å‡†æ–¹è¨€"></a>æ ‡å‡†æ–¹è¨€</h2><p>æ ‡å‡†æ–¹è¨€æ˜¯æŒ‡ Thymeleaf å®šä¹‰äº†ä¸€ç»„åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½åº”è¯¥è¶³ä»¥æ»¡è¶³å¤§å¤šæ•°æƒ…å†µã€‚å¯ä»¥è¯†åˆ«è¿™äº›æ ‡å‡†æ–¹è¨€åœ¨æ¨¡æ¿ä¸­çš„ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå°†åŒ…å«ä»¥<code>th</code>å‰ç¼€å¼€å¤´çš„å±æ€§ï¼Œå¦‚<code>&lt;span th:text=&quot;...&quot;&gt;</code>ã€‚</p>
<h3 id="è¡¨è¾¾å¼"><a href="#è¡¨è¾¾å¼" class="headerlink" title="è¡¨è¾¾å¼"></a>è¡¨è¾¾å¼</h3><p><code>$&#123;...&#125;</code> : å˜é‡è¡¨è¾¾å¼ã€‚</p>
<p><code>*&#123;...&#125;</code> : é€‰æ‹©è¡¨è¾¾å¼ã€‚</p>
<p><code>#&#123;...&#125;</code> : æ¶ˆæ¯ (i18n) è¡¨è¾¾å¼ã€‚</p>
<p><code>@&#123;...&#125;</code> : é“¾æ¥ (URL) è¡¨è¾¾å¼ã€‚</p>
<p><code>~&#123;...&#125;</code> : ç‰‡æ®µè¡¨è¾¾å¼ã€‚</p>
<h4 id="å˜é‡è¡¨è¾¾å¼"><a href="#å˜é‡è¡¨è¾¾å¼" class="headerlink" title="å˜é‡è¡¨è¾¾å¼"></a>å˜é‡è¡¨è¾¾å¼</h4><p>å˜é‡è¡¨è¾¾å¼æ˜¯ OGNL è¡¨è¾¾å¼ - å¦‚æœå°† Thymeleaf ä¸ Spring - é›†æˆåœ¨ä¸Šä¸‹æ–‡å˜é‡ä¸Š(ä¹Ÿç§°ä¸º Spring æœ¯è¯­ä¸­çš„æ¨¡å‹å±æ€§)ï¼Œåˆ™ä¸º Spring ELã€‚ å®ƒä»¬çœ‹èµ·æ¥åƒè¿™æ ·:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;session.user.name&#125;</span><br></pre></td></tr></table></figure>

<p>å®ƒä»¬ä½œä¸ºå±æ€§å€¼æˆ–ä½œä¸ºå®ƒä»¬çš„ä¸€éƒ¨åˆ†ï¼Œå–å†³äºå±æ€§:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;book.author.name&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„è¡¨è¾¾å¼ä¸ä¸‹é¢æ˜¯ç›¸åŒçš„(åœ¨ OGNL å’Œ SpringEL ä¸­):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((Book)context.getVariable(<span class="string">&quot;book&quot;</span>)).getAuthor().getName()</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¸ä»…åœ¨æ¶‰åŠè¾“å‡ºçš„åœºæ™¯ä¸­æ‰¾åˆ°å˜é‡è¡¨è¾¾å¼ï¼Œè€Œä¸”è¿˜å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„å¤„ç†æ–¹å¼ï¼Œå¦‚:æ¡ä»¶ï¼Œè¿­ä»£â€¦ç­‰ç­‰ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">th:each</span>=<span class="string">&quot;book : $&#123;books&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ<code>$&#123;books&#125;</code>ä»ä¸Šä¸‹æ–‡ä¸­é€‰æ‹©åä¸º<code>books</code>çš„å˜é‡ï¼Œå¹¶åœ¨<code>th:each</code>ä¸­ä½¿ç”¨å¾ªç¯å°†å…¶è¯„ä¼°ä¸ºè¿­ä»£å™¨ã€‚</p>
<h4 id="é€‰æ‹©è¡¨è¾¾å¼"><a href="#é€‰æ‹©è¡¨è¾¾å¼" class="headerlink" title="é€‰æ‹©è¡¨è¾¾å¼"></a>é€‰æ‹©è¡¨è¾¾å¼</h4><p>é€‰æ‹©è¡¨è¾¾å¼å°±åƒå˜é‡è¡¨è¾¾å¼ä¸€æ ·ï¼Œå®ƒä»¬ä¸æ˜¯æ•´ä¸ªä¸Šä¸‹æ–‡å˜é‡æ˜ å°„ä¸Šæ‰§è¡Œï¼Œè€Œæ˜¯åœ¨å…ˆå‰é€‰æ‹©çš„å¯¹è±¡ã€‚ å®ƒä»¬çœ‹èµ·æ¥åƒè¿™æ ·:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*&#123;customer.name&#125;</span><br></pre></td></tr></table></figure>

<p>å®ƒä»¬æ‰€ä½œç”¨çš„å¯¹è±¡ç”±<code>th:object</code>å±æ€§æŒ‡å®š:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;book&#125;&quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;title&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¿™ç›¸å½“äº:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// th:object=&quot;$&#123;book&#125;&quot;</span></span><br><span class="line">  <span class="keyword">final</span> <span class="type">Book</span> <span class="variable">selection</span> <span class="operator">=</span> (Book) context.getVariable(<span class="string">&quot;book&quot;</span>);</span><br><span class="line">  <span class="comment">// th:text=&quot;*&#123;title&#125;&quot;</span></span><br><span class="line">  output(selection.getTitle());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¶ˆæ¯-i18n-è¡¨è¾¾å¼"><a href="#æ¶ˆæ¯-i18n-è¡¨è¾¾å¼" class="headerlink" title="æ¶ˆæ¯(i18n)è¡¨è¾¾å¼"></a>æ¶ˆæ¯(i18n)è¡¨è¾¾å¼</h4><p>æ¶ˆæ¯è¡¨è¾¾å¼(é€šå¸¸ç§°ä¸ºæ–‡æœ¬å¤–éƒ¨åŒ–ï¼Œå›½é™…åŒ–æˆ– i18n)å…è®¸ä»å¤–éƒ¨æº(å¦‚:<code>.properties</code>)æ–‡ä»¶ä¸­æ£€ç´¢ç‰¹å®šäºè¯­è¨€ç¯å¢ƒçš„æ¶ˆæ¯ï¼Œé€šè¿‡é”®æ¥å¼•ç”¨è¿™å¼•ç”¨æ¶ˆæ¯ã€‚</p>
<p>åœ¨ Spring åº”ç”¨ç¨‹åºä¸­ï¼Œå®ƒå°†è‡ªåŠ¨ä¸ Spring çš„ MessageSource æœºåˆ¶é›†æˆã€‚å¦‚ä¸‹ -</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&#123;main.title&#125;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&#123;message.entrycreated(<span class="variable">$&#123;entryId&#125;</span>)&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹æ˜¯åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å®ƒä»¬çš„æ–¹å¼:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">th:text</span>=<span class="string">&quot;#&#123;header.address.city&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">th:text</span>=<span class="string">&quot;#&#123;header.address.country&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼Œå¦‚æœå¸Œæœ›æ¶ˆæ¯é”®ç”±ä¸Šä¸‹æ–‡å˜é‡çš„å€¼ç¡®å®šï¼Œæˆ–è€…å¸Œæœ›å°†å˜é‡æŒ‡å®šä¸ºå‚æ•°ï¼Œåˆ™å¯ä»¥åœ¨æ¶ˆæ¯è¡¨è¾¾å¼ä¸­ä½¿ç”¨å˜é‡è¡¨è¾¾å¼:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;$&#123;config.adminWelcomeKey&#125;($&#123;session.user.name&#125;)&#125; Jsp</span><br></pre></td></tr></table></figure>

<h4 id="é“¾æ¥-URL-è¡¨è¾¾å¼"><a href="#é“¾æ¥-URL-è¡¨è¾¾å¼" class="headerlink" title="é“¾æ¥(URL)è¡¨è¾¾å¼"></a>é“¾æ¥(URL)è¡¨è¾¾å¼</h4><p>é“¾æ¥è¡¨è¾¾å¼åœ¨æ„å»º URL å¹¶å‘å…¶æ·»åŠ æœ‰ç”¨çš„ä¸Šä¸‹æ–‡å’Œä¼šè¯ä¿¡æ¯(é€šå¸¸ç§°ä¸º URL é‡å†™çš„è¿‡ç¨‹)ã€‚<br>å› æ­¤ï¼Œå¯¹äºéƒ¨ç½²åœ¨ Web æœåŠ¡å™¨çš„<code>/myapp</code>ä¸Šä¸‹æ–‡ä¸­çš„ Web åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¡¨è¾¾å¼:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/list&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥è½¬æ¢æˆå¦‚ä¸‹çš„ä¸œè¥¿:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/myapp/order/list&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç”šè‡³ï¼Œå¦‚æœéœ€è¦ä¿æŒä¼šè¯ï¼Œå¹¶ä¸” cookie æœªå¯ç”¨(æˆ–è€…æœåŠ¡å™¨è¿˜ä¸çŸ¥é“)ï¼Œé‚£ä¹ˆç”Ÿæˆçš„æ ¼å¼ä¸º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/myapp/order/list;jsessionid=s2ds3fa31abd241e2a01932&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span> HTML</span><br></pre></td></tr></table></figure>

<p>ç½‘å€ä¹Ÿå¯ä»¥å¸¦å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/details(id=$&#123;orderId&#125;,type=$&#123;orderType&#125;)&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™å°†äº§ç”Ÿç±»ä¼¼ä»¥ä¸‹çš„ç»“æœ -</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ³¨æ„ï¼†ç¬¦å·ä¼šåœ¨æ ‡ç­¾å±æ€§ä¸­è¿›è¡ŒHTMLè½¬ä¹‰... --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/myapp/order/details?id=23&amp;type=online&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é“¾æ¥è¡¨è¾¾å¼å¯ä»¥æ˜¯ç›¸å¯¹çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å°†ä¸ä¼šè¢«åŠ åˆ° URL çš„å‰é¢:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;../documents/report&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæ˜¯æœåŠ¡å™¨ç›¸å¯¹çš„(åŒæ ·ï¼Œæ²¡æœ‰åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„å‰ç¼€):</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;~/contents/main&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å’Œåè®®ç›¸å…³(å°±åƒç»å¯¹ URL ä¸€æ ·ï¼Œä½†æµè§ˆå™¨å°†ä½¿ç”¨ä¸æ­£åœ¨æ˜¾ç¤ºçš„é¡µé¢ç›¸åŒçš„ HTTP æˆ– HTTPS åè®®):</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;//static.mycompany.com/res/initial&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ï¼Œé“¾æ¥è¡¨è¾¾å¼ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹çš„:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;http://www.mycompany.com/main&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ç»å¯¹(æˆ–åè®®ç›¸å¯¹)URL ï¼Œåœ¨ Thymeleaf é“¾æ¥è¡¨è¾¾å¼ä¸­åº”è¯¥æ·»åŠ ä»€ä¹ˆå€¼ï¼Ÿ å¾ˆç®€å•:ç”±å“åº”è¿‡æ»¤å™¨å®šä¹‰ URL é‡å†™:åœ¨åŸºäº Servlet çš„ Web åº”ç”¨ç¨‹åºä¸­ï¼Œå¯¹äºæ¯ä¸ªè¾“å‡ºçš„ URL(ä¸Šä¸‹æ–‡ç›¸å¯¹ï¼Œç›¸å¯¹ï¼Œç»å¯¹â€¦)ï¼Œåœ¨æ˜¾ç¤º URL ä¹‹å‰ï¼ŒThymeleaf æ€»æ˜¯è°ƒç”¨<code>HttpServletResponse.encodeUrl(...)</code>æœºåˆ¶ã€‚ è¿™æ„å‘³ç€ä¸€ä¸ªè¿‡æ»¤å™¨å¯ä»¥é€šè¿‡åŒ…è£… HttpServletResponse å¯¹è±¡æ¥ä¸ºåº”ç”¨ç¨‹åºæ‰§è¡Œè‡ªå®šä¹‰çš„ URL é‡å†™ã€‚</p>
<h4 id="ç‰‡æ®µè¡¨è¾¾å¼"><a href="#ç‰‡æ®µè¡¨è¾¾å¼" class="headerlink" title="ç‰‡æ®µè¡¨è¾¾å¼"></a>ç‰‡æ®µè¡¨è¾¾å¼</h4><p>ç‰‡æ®µè¡¨è¾¾å¼æ˜¯ä¸€ç§ç®€å•çš„æ–¹æ³•ç”¨æ¥è¡¨ç¤ºæ ‡è®°çš„ç‰‡æ®µå¹¶å°†å…¶ç§»åŠ¨åˆ°æ¨¡æ¿ä¸­ã€‚ ç”±äºè¿™äº›è¡¨è¾¾å¼ï¼Œç‰‡æ®µå¯ä»¥è¢«å¤åˆ¶ï¼Œä¼ é€’ç»™å…¶ä»–æ¨¡æ¿çš„å‚æ•°ç­‰ç­‰ã€‚</p>
<p>æœ€å¸¸è§çš„æ˜¯ä½¿ç”¨<code>th:insert</code>æˆ–<code>th:replace</code>æ¥æ’å…¥ç‰‡æ®µ:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;commons :: main&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å®ƒä»¬å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œå°±åƒä»»ä½•å…¶ä»–å˜é‡ä¸€æ ·:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:with</span>=<span class="string">&quot;frag=~&#123;footer :: #main/text()&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:insert</span>=<span class="string">&quot;$&#123;frag&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç‰‡æ®µè¡¨è¾¾å¼å¯ä»¥æœ‰å‚æ•°ã€‚</p>
<h4 id="è¡¨è¾¾å¼é¢„å¤„ç†"><a href="#è¡¨è¾¾å¼é¢„å¤„ç†" class="headerlink" title="è¡¨è¾¾å¼é¢„å¤„ç†"></a>è¡¨è¾¾å¼é¢„å¤„ç†</h4><p>å…³äºè¡¨è¾¾å¼çš„æœ€åä¸€ä»¶äº‹æ˜¯çŸ¥é“è¡¨è¾¾å¼é¢„å¤„ç†ï¼Œåœ¨<code>__</code>ä¹‹é—´æŒ‡å®šï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;selection.__$&#123;sel.<span class="keyword">code</span>&#125;__&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œçš„å˜é‡è¡¨è¾¾å¼æ˜¯:<code>$&#123;sel.code&#125;</code>ï¼Œå¹¶ä¸”å°†ä½¿ç”¨å®ƒçš„ç»“æœä½œä¸ºè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†(å‡è®¾<code>$&#123;sel.code&#125;</code>çš„ç»“æœä¸º:<code>ALL</code>)ï¼Œåœ¨æ­¤å¤„æ‰§è¡Œå›½é™…åŒ–çš„æƒ…å†µä¸‹(è¿™å°†æŸ¥æ‰¾ä¸å…³é”®<code>selection.ALL</code>æ¶ˆæ¯)ã€‚</p>
<h3 id="æ–‡å­—å’Œæ“ä½œ"><a href="#æ–‡å­—å’Œæ“ä½œ" class="headerlink" title="æ–‡å­—å’Œæ“ä½œ"></a>æ–‡å­—å’Œæ“ä½œ</h3><p>æœ‰å¾ˆå¤šç±»å‹çš„æ–‡å­—å’Œæ“ä½œå¯ç”¨ï¼Œå®ƒä»¬åˆ†åˆ«å¦‚ä¸‹:</p>
<ul>
<li>æ–‡å­—<ul>
<li>æ–‡æœ¬æ–‡å­—ï¼Œä¾‹å¦‚:<code>&#39;one text&#39;</code>, <code>&#39;Another one!&#39;</code>,<code>â€¦</code></li>
<li>æ•°å­—æ–‡å­—ï¼Œä¾‹å¦‚:<code>0</code>,<code>10</code>, <code>314</code>, <code>31.01</code>, <code>112.83</code>,<code>â€¦</code></li>
<li>å¸ƒå°”æ–‡å­—ï¼Œä¾‹å¦‚:<code>true</code>,<code>false</code></li>
<li>Null æ–‡å­—ï¼Œä¾‹å¦‚:<code>Null</code></li>
<li>æ–‡å­—æ ‡è®°ï¼Œä¾‹å¦‚:<code>one</code>, <code>sometext</code>, <code>main</code>,<code>â€¦</code></li>
</ul>
</li>
<li>æ–‡æœ¬æ“ä½œ:<ul>
<li>å­—ç¬¦ä¸²è¿æ¥:<code>+</code></li>
<li>æ–‡å­—æ›¿æ¢:<code>|The name is $&#123;name&#125;|</code></li>
</ul>
</li>
<li>ç®—æœ¯è¿ç®—:<ul>
<li>äºŒè¿›åˆ¶æ“ä½œ:<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></li>
<li>å‡å·(ä¸€å…ƒè¿ç®—ç¬¦):<code>-</code></li>
</ul>
</li>
<li>å¸ƒå°”è¿ç®—:<ul>
<li>äºŒè¿›åˆ¶è¿ç®—ç¬¦ï¼Œ<code>and</code>,<code>or</code></li>
<li>å¸ƒå°”å¦å®š(ä¸€å…ƒè¿ç®—ç¬¦):<code>!</code>,<code>not</code></li>
</ul>
</li>
<li>æ¯”è¾ƒå’Œç›¸ç­‰:<ul>
<li>æ¯”è¾ƒè¿ç®—ç¬¦:<code>&gt;</code>,<code>&lt;</code>,<code>&gt;=</code>,<code>&lt;=</code>(<code>gt</code>,<code>lt</code>,<code>ge</code>,<code>le</code>)</li>
<li>ç›¸ç­‰è¿ç®—ç¬¦:<code>==</code>, <code>!=</code> (<code>eq</code>, <code>ne</code>)</li>
</ul>
</li>
<li>æ¡ä»¶æ“ä½œç¬¦:<ul>
<li>If-then:<code>(if) ? (then)</code></li>
<li>If-then-else:<code>(if) ? (then) : (else)</code></li>
<li>Default: <code>(value) ?: (defaultvalue)</code></li>
</ul>
</li>
</ul>
<h3 id="åŸºæœ¬å±æ€§"><a href="#åŸºæœ¬å±æ€§" class="headerlink" title="åŸºæœ¬å±æ€§"></a>åŸºæœ¬å±æ€§</h3><p>ä¸‹é¢æ¥çœ‹çœ‹æ ‡å‡†æ–¹è¨€ä¸­çš„å‡ ä¸ªæœ€åŸºæœ¬çš„å±æ€§ã€‚ ä»<code>th:</code>æ–‡æœ¬å¼€å§‹ï¼Œå®ƒä»£æ›¿äº†æ ‡ç­¾çš„ä¸»ä½“:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;#&#123;msg.welcome&#125;&quot;</span>&gt;</span>Welcome everyone!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œ<code>th:each</code>é‡å¤å®ƒæ‰€åœ¨å…ƒç´ çš„æ¬¡æ•°ï¼Œç”±å®ƒçš„è¡¨è¾¾å¼è¿”å›çš„æ•°ç»„æˆ–åˆ—è¡¨æ‰€æŒ‡å®šçš„æ¬¡æ•°ï¼Œä¸ºè¿­ä»£å…ƒç´ åˆ›å»ºä¸€ä¸ªå†…éƒ¨å˜é‡ï¼Œå…¶è¯­æ³•ä¸ Java çš„ foreach è¡¨è¾¾å¼ç›¸åŒ:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">th:each</span>=<span class="string">&quot;book : $&#123;books&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;book.title&#125;&quot;</span>&gt;</span></span><br><span class="line">  En las Orillas del Sar</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åï¼ŒThymeleaf ä¸ºç‰¹å®šçš„ XHTML å’Œ HTML5 å±æ€§æä¾›äº†è®¸å¤š<code>th</code>å±æ€§ï¼Œè¿™äº›å±æ€§åªè¯„ä¼°å®ƒä»¬çš„è¡¨è¾¾å¼ï¼Œå¹¶å°†è¿™äº›å±æ€§çš„å€¼è®¾ç½®ä¸ºç»“æœã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/createOrder&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;#&#123;form.submit&#125;&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/admin/users&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ ‡å‡†-URL"><a href="#æ ‡å‡†-URL" class="headerlink" title="æ ‡å‡† URL"></a>æ ‡å‡† URL</h3><p>Thymeleaf æ ‡å‡†æ–¹è¨€(ç§°ä¸º Standard å’Œ SpringStandard)æä¾›äº†ä¸€ç§åœ¨ Web åº”ç”¨ç¨‹åºä¸­è½»æ¾åˆ›å»º URL çš„æ–¹æ³•ï¼Œä»¥ä¾¿å®ƒä»¬åŒ…å«ä»»ä½•æ‰€éœ€çš„ URL å·¥ä»¶ã€‚ è¿™æ˜¯é€šè¿‡è¿æ¥è¡¨è¾¾æ–¹å¼æ¥å®Œæˆçš„ï¼Œè¿™æ˜¯ä¸€ç§ç±»ä¼¼äº Thymeleaf æ ‡å‡†çš„è¡¨ç°:<code>@&#123;...&#125;</code></p>
<h4 id="ç»å¯¹ç½‘å€"><a href="#ç»å¯¹ç½‘å€" class="headerlink" title="ç»å¯¹ç½‘å€"></a>ç»å¯¹ç½‘å€</h4><p>ç»å¯¹ URL ç”¨äºåˆ›å»ºåˆ°å…¶ä»–æœåŠ¡å™¨çš„é“¾æ¥ã€‚å®ƒä»¬éœ€è¦æŒ‡å®šä¸€ä¸ªåè®®åç§°(<code>http://</code>æˆ–<code>https://</code>)å¼€å¤´ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;https://www.yiibai.com/thymeleaf/&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢é“¾æ¥ä¸ä¼šè¢«ä¿®æ”¹ï¼Œé™¤éåœ¨æœåŠ¡å™¨ä¸Šé…ç½®äº† URL é‡å†™è¿‡æ»¤å™¨ï¼Œå¹¶åœ¨<code>HttpServletResponse.encodeUrl(...)</code>æ–¹æ³•ä¸­æ‰§è¡Œä¿®æ”¹ã€‚æœ€åç”Ÿæˆçš„ HTML ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.yiibai.com/thymeleaf/&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¸Šä¸‹æ–‡ç›¸å…³-URL"><a href="#ä¸Šä¸‹æ–‡ç›¸å…³-URL" class="headerlink" title="ä¸Šä¸‹æ–‡ç›¸å…³ URL"></a>ä¸Šä¸‹æ–‡ç›¸å…³ URL</h4><p>æœ€å¸¸ç”¨çš„ URL ç±»å‹æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³çš„ã€‚ è¿™äº› URL æ˜¯ä¸€æ—¦å®‰è£…åœ¨æœåŠ¡å™¨ä¸Šï¼Œå°±ä¼šä¸ Web åº”ç”¨ç¨‹åºæ ¹ç›¸å…³è” URLã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå°†ä¸€ä¸ªåç§°ä¸º<code>myapp.war</code>çš„æ–‡ä»¶éƒ¨ç½²åˆ°ä¸€ä¸ª Tomcat æœåŠ¡å™¨ä¸­ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºä¸€èˆ¬æ˜¯é€šè¿‡ URL:<code>http://localhost:8080/myapp</code>æ¥è®¿é—®ï¼Œ<code>myapp</code>å°±æ˜¯ä¸Šä¸‹æ–‡åç§°ã€‚</p>
<p>ä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„ URL ä»¥<code>/</code>å­—ç¬¦å¼€å¤´:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/list&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœåº”ç”¨ç¨‹åºè®¿é—® URL ä¸º:<code>http://localhost:8080/myapp</code>ï¼Œåˆ™æ­¤ URL å°†è¾“å‡º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/myapp/order/list&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¸æœåŠ¡å™¨ç›¸å…³-URL"><a href="#ä¸æœåŠ¡å™¨ç›¸å…³-URL" class="headerlink" title="ä¸æœåŠ¡å™¨ç›¸å…³ URL"></a>ä¸æœåŠ¡å™¨ç›¸å…³ URL</h4><p>æœåŠ¡å™¨ç›¸å…³çš„ URL ä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„ URL éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å®ƒä»¬ä¸å‡å®š URL è¦é“¾æ¥åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„èµ„æºï¼Œå› æ­¤å…è®¸é“¾æ¥åˆ°åŒä¸€æœåŠ¡å™¨ä¸­çš„ä¸åŒä¸Šä¸‹æ–‡:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;~/billing-app/showDetails.html&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å½“å‰åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡å°†è¢«å¿½ç•¥ï¼Œå› æ­¤å°½ç®¡åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨<code>http:// localhost:8080 / myapp</code>ï¼Œä½†è¯¥ URL å°†è¾“å‡º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/billing-app/showDetails.html&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="åè®®ç›¸å…³-URL"><a href="#åè®®ç›¸å…³-URL" class="headerlink" title="åè®®ç›¸å…³ URL"></a>åè®®ç›¸å…³ URL</h4><p>ä¸åè®®ç›¸å…³çš„ URL å®é™…ä¸Šæ˜¯ç»å¯¹çš„ URLï¼Œå®ƒå°†ä¿æŒç”¨äºæ˜¾ç¤ºå½“å‰é¡µé¢çš„åè®®(HTTPï¼ŒHTTPS)ã€‚ å®ƒä»¬é€šå¸¸ç”¨äºåŒ…æ‹¬æ ·å¼ï¼Œè„šæœ¬ç­‰å¤–éƒ¨èµ„æº:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;//scriptserver.example.net/myscript.js&#125;&quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®ƒå°†å‘ˆç°ä¸ä¸Šé¢ä¸€è‡´çš„ URL(URL é‡å†™é™¤å¤–)ï¼Œå¦‚:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;//scriptserver.example.net/myscript.js&quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="æ·»åŠ å‚æ•°"><a href="#æ·»åŠ å‚æ•°" class="headerlink" title="æ·»åŠ å‚æ•°"></a>æ·»åŠ å‚æ•°</h4><p>å¦‚ä½•å‘ä½¿ç”¨<code>@&#123;...&#125;</code>è¡¨è¾¾å¼åˆ›å»ºçš„ URL æ·»åŠ å‚æ•°ï¼Ÿ è¿™ä¹Ÿå¾ˆç®€å•:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/details(id=3)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ä»£ç ï¼Œæœ€ç»ˆå°†è¾“å‡ºä¸º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/order/details?id=3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥æ·»åŠ å‡ ä¸ªå‚æ•°ï¼Œç”¨é€—å·åˆ†éš”å®ƒä»¬:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/details(id=3,action=&#x27;show_all&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å°†è¾“å‡ºç»“æœä¸º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ³¨æ„ï¼†ç¬¦å·åœ¨æ ‡ç­¾å±æ€§ä¸­è¿›è¡ŒHTMLè½¬ä¹‰... --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/order/details?id=3&amp;action=show_all&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥ä½¿ç”¨æ­£å¸¸å‚æ•°çš„è·¯å¾„å˜é‡çš„å½¢å¼åŒ…å«å‚æ•°ï¼Œä½†åœ¨ URL çš„è·¯å¾„ä¸­æŒ‡å®šä¸€ä¸ªå ä½ç¬¦:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/&#123;id&#125;/details(id=3,action=&#x27;show_all&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¾“å‡ºç»“æœä¸º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/order/3/details?action=show_all&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ç½‘å€ç‰‡æ®µæ ‡è¯†ç¬¦"><a href="#ç½‘å€ç‰‡æ®µæ ‡è¯†ç¬¦" class="headerlink" title="ç½‘å€ç‰‡æ®µæ ‡è¯†ç¬¦"></a>ç½‘å€ç‰‡æ®µæ ‡è¯†ç¬¦</h4><p>ç‰‡æ®µæ ‡è¯†ç¬¦å¯ä»¥åŒ…å«åœ¨ URL ä¸­ï¼ŒåŒ…å«å‚æ•°å’Œä¸åŒ…å«å‚æ•°ã€‚ å®ƒä»¬å°†å§‹ç»ˆåŒ…å«åœ¨ç½‘å€çš„åŸºç¡€ä¸Šï¼Œå‚è€ƒä»¥ä¸‹ä»£ç :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/home#all_info(action=&#x27;show&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œè¾“å‡ºç»“æœå¦‚ä¸‹ -</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;/home?action=show#all_info&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="URL-é‡å†™"><a href="#URL-é‡å†™" class="headerlink" title="URL é‡å†™"></a>URL é‡å†™</h4><p>Thymeleaf å…è®¸åœ¨åº”ç”¨ç¨‹åºä¸­é…ç½® URL é‡å†™è¿‡æ»¤å™¨ï¼Œå®ƒé€šè¿‡è°ƒç”¨ Thymeleaf æ¨¡æ¿ç”Ÿæˆçš„æ¯ä¸ª URL çš„ Servlet API çš„<code>javax.servlet.http.HttpServletResponse</code>ç±»ä¸­çš„<code>response.encodeURL()</code>æ–¹æ³•æ¥å®ç°ã€‚</p>
<p>ä¸‹é¢åœ¨ Java Web åº”ç”¨ç¨‹åºä¸­æ”¯æŒ URL é‡å†™æ“ä½œçš„æ ‡å‡†æ–¹å¼ï¼Œå¹¶å…è®¸ URL:</p>
<ul>
<li>è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ˜¯å¦å¯ç”¨äº† Cookieï¼Œå¦‚æœæœªå¯ç”¨æˆ–è€…å¦‚æœå®ƒæ˜¯ç¬¬ä¸€ä¸ªè¯·æ±‚å¹¶ä¸” cookie é…ç½®ä»æœªçŸ¥ã€‚åˆ™å°†<code>;jsessionid=...</code>ç‰‡æ®µæ·»åŠ åˆ° URLã€‚</li>
<li>åœ¨éœ€è¦æ—¶è‡ªåŠ¨å°†ä»£ç†é…ç½®åº”ç”¨äº URLã€‚</li>
<li>ä½¿ç”¨ä¸åŒçš„ CDN è®¾ç½®ï¼Œä»¥ä¾¿é“¾æ¥åˆ°åˆ†å¸ƒåœ¨å¤šä¸ªæœåŠ¡å™¨ä¸­çš„å†…å®¹ã€‚</li>
</ul>
<h4 id="URL-å…¶å®ƒå±æ€§"><a href="#URL-å…¶å®ƒå±æ€§" class="headerlink" title="URL å…¶å®ƒå±æ€§"></a>URL å…¶å®ƒå±æ€§</h4><p>ä¸è¦ä»¥ä¸ºåœ¨<code>@&#123;...&#125;</code>è¡¨è¾¾å¼ä¸­åªæœ‰<code>th:href</code>å±æ€§æ¥è¡¨ç¤º URL ã€‚ äº‹å®ä¸Šï¼Œå®ƒä»¬å¯ä»¥åƒå˜é‡è¡¨è¾¾å¼(<code>$&#123;...&#125;</code>)æˆ–æ¶ˆæ¯å¤–éƒ¨åŒ–&#x2F;å›½é™…åŒ–(<code>ï¼ƒ&#123;...&#125;</code>)ä¸€æ ·ç”¨äºä»»ä½•åœ°æ–¹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¡¨å•æäº¤æ—¶ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹å†™æ³• -</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/order/processOrder&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ–ä½œä¸ºå…¶ä»–è¡¨è¾¾çš„ä¸€éƒ¨åˆ†ã€‚ å¦‚ä¸‹ä½œä¸ºå¤–éƒ¨åŒ–&#x2F;å›½é™…åŒ–å­—ç¬¦ä¸²çš„å‚æ•°:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span></span></span><br><span class="line"><span class="tag">  <span class="attr">th:text</span>=<span class="string">&quot;#&#123;orders.explanation(&#x27;3&#x27;, @&#123;/order/details(id=3,action=&#x27;show_all&#x27;)&#125;)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="åœ¨-URL-ä¸­ä½¿ç”¨è¡¨è¾¾å¼"><a href="#åœ¨-URL-ä¸­ä½¿ç”¨è¡¨è¾¾å¼" class="headerlink" title="åœ¨ URL ä¸­ä½¿ç”¨è¡¨è¾¾å¼"></a>åœ¨ URL ä¸­ä½¿ç”¨è¡¨è¾¾å¼</h4><p>ä¸‹é¢æ¥çœ‹çœ‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºçš„ URL è¡¨è¾¾å¼:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/details(id=3,action=&#x27;show_all&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†<code>3</code>å’Œ<code>&#39;show_all&#39;</code>éƒ½ä¸èƒ½æ˜¯æ–‡å­—å€¼ï¼Œå› ä¸ºåªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“å®ƒä»¬çš„å€¼ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">  <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/details(id=$&#123;order.id&#125;,action=($&#123;user.admin&#125; ? &#x27;show_all&#x27; : &#x27;show_public&#x27;))&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢çœ‹çœ‹å¦ä¸€ä¸ª URL è¡¨è¾¾å¼ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/order/details(id=$&#123;order.id&#125;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®ƒå…¶å®æ˜¯ä¸‹é¢ URL çš„ä¸€ä¸ªå¿«æ·æ–¹å¼:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/order/details&#x27;(id=$&#123;order.id&#125;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ„å‘³ç€ URL åŸºæœ¬èº«å¯ä»¥è¢«æŒ‡å®šä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ä¸€ä¸ªå˜é‡è¡¨è¾¾å¼:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;$&#123;detailsURL&#125;(id=$&#123;order.id&#125;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ–å¤–éƒ¨åŒ–&#x2F;å›½é™…åŒ–çš„æ–‡æœ¬:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;#&#123;orders.details.localized_url&#125;(id=$&#123;order.id&#125;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç”šè‡³å¯ä»¥ä½¿ç”¨å¤æ‚çš„è¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬æ¡ä»¶è¡¨è¾¾å¼ï¼Œä¾‹å¦‚:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">  <span class="attr">th:href</span>=<span class="string">&quot;@&#123;($&#123;user.admin&#125;? &#x27;/admin/home&#x27; : $&#123;user.homeUrl&#125;)(id=$&#123;order.id&#125;)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦æ›´æ¸…æ´ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>th:with</code> :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">  <span class="attr">th:with</span>=<span class="string">&quot;baseUrl=($&#123;user.admin&#125;? &#x27;/admin/home&#x27; : $&#123;user.homeUrl&#125;)&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">th:href</span>=<span class="string">&quot;@&#123;$&#123;baseUrl&#125;(id=$&#123;order.id&#125;)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆæˆ–è€… -</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:with</span>=<span class="string">&quot;baseUrl=($&#123;user.admin&#125;? &#x27;/admin/home&#x27; : $&#123;user.homeUrl&#125;)&quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;$&#123;baseUrl&#125;(id=$&#123;order.id&#125;)&#125;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>TODO</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.thymeleaf.org/">Thymeleaf å®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/thymeleaf/thymeleaf/">Thymeleaf Github</a></li>
<li><a target="_blank" rel="noopener" href="https://fanlychie.github.io/post/thymeleaf.html">Thymeleaf æ•™ç¨‹</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/85460d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/85460d/" class="post-title-link" itemprop="url">Java ç¼“å­˜ä¸­é—´ä»¶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E4%B8%AD%E9%97%B4%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">ä¸­é—´ä»¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E7%BC%93%E5%AD%98/" itemprop="url" rel="index"><span itemprop="name">ç¼“å­˜</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>6.3k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>6 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Java-ç¼“å­˜ä¸­é—´ä»¶"><a href="#Java-ç¼“å­˜ä¸­é—´ä»¶" class="headerlink" title="Java ç¼“å­˜ä¸­é—´ä»¶"></a>Java ç¼“å­˜ä¸­é—´ä»¶</h1><blockquote>
<p>å…³é”®è¯ï¼šSpring Cacheã€J2Cacheã€JetCache</p>
</blockquote>
<h2 id="ä¸€-ã€JSR-107"><a href="#ä¸€-ã€JSR-107" class="headerlink" title="ä¸€ ã€JSR 107"></a>ä¸€ ã€JSR 107</h2><p><a target="_blank" rel="noopener" href="https://www.jcp.org/en/jsr/detail?id=107">JSR107</a> ä¸­åˆ¶è®¢äº† Java ç¼“å­˜çš„è§„èŒƒã€‚</p>
<p>å› æ­¤ï¼Œåœ¨å¾ˆå¤šç¼“å­˜æ¡†æ¶ã€ç¼“å­˜åº“ä¸­ï¼Œå…¶ API éƒ½å‚è€ƒäº† JSR 107 è§„èŒƒã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200709174139.png" alt="img"></p>
<p>Java Caching å®šä¹‰äº† 5 ä¸ªæ ¸å¿ƒæ¥å£</p>
<ul>
<li><strong>CachingProvider</strong> - å®šä¹‰äº†åˆ›å»ºã€é…ç½®ã€è·å–ã€ç®¡ç†å’Œæ§åˆ¶å¤šä¸ª <code>CacheManager</code>ã€‚ä¸€ä¸ªåº”ç”¨å¯ä»¥åœ¨è¿è¡ŒæœŸè®¿é—®å¤šä¸ª <code>CachingProvider</code>ã€‚</li>
<li><strong>CacheManager</strong> - å®šä¹‰äº†åˆ›å»ºã€é…ç½®ã€è·å–ã€ç®¡ç†å’Œæ§åˆ¶å¤šä¸ªå”¯ä¸€å‘½åçš„ Cacheï¼Œè¿™äº› Cache å­˜åœ¨äº CacheManager çš„ä¸Šä¸‹æ–‡ä¸­ã€‚ä¸€ä¸ª CacheManager ä»…è¢«ä¸€ä¸ª CachingProvider æ‰€æ‹¥æœ‰ã€‚</li>
<li><strong>Cache</strong> - æ˜¯ä¸€ä¸ªç±»ä¼¼ Map çš„æ•°æ®ç»“æ„å¹¶ä¸´æ—¶å­˜å‚¨ä»¥ Key ä¸ºç´¢å¼•çš„å€¼ã€‚ä¸€ä¸ª Cache ä»…è¢«ä¸€ä¸ª CacheManager æ‰€æ‹¥æœ‰ã€‚</li>
<li><strong>Entry</strong> - æ˜¯ä¸€ä¸ªå­˜å‚¨åœ¨ Cache ä¸­çš„ key-value å¯¹ã€‚</li>
<li><strong>Expiry</strong> - æ¯ä¸€ä¸ªå­˜å‚¨åœ¨ Cache ä¸­çš„æ¡ç›®æœ‰ä¸€ä¸ªå®šä¹‰çš„æœ‰æ•ˆæœŸï¼Œå³ Expiry Durationã€‚ä¸€æ—¦è¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæ¡ç›®ä¸ºè¿‡æœŸçš„çŠ¶æ€ã€‚ä¸€æ—¦è¿‡æœŸï¼Œæ¡ç›®å°†ä¸å¯è®¿é—®ã€æ›´æ–°å’Œåˆ é™¤ã€‚ç¼“å­˜æœ‰æ•ˆæœŸå¯ä»¥é€šè¿‡ ExpiryPolicy è®¾ç½®ã€‚</li>
</ul>
<h2 id="äºŒã€Spring-Cache"><a href="#äºŒã€Spring-Cache" class="headerlink" title="äºŒã€Spring Cache"></a>äºŒã€Spring Cache</h2><blockquote>
<p>è¯¦è§ï¼š<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html#cache">Spring Cache å®˜æ–¹æ–‡æ¡£</a></p>
</blockquote>
<p>Spring ä½œä¸º Java å¼€å‘æœ€è‘—åçš„æ¡†æ¶ï¼Œä¹Ÿæä¾›äº†ç¼“å­˜åŠŸèƒ½çš„æ¡†æ¶â€”â€” Spring Cacheã€‚</p>
<p>Spring æ”¯æŒåŸºäºæ³¨é‡Šï¼ˆannotationï¼‰çš„ç¼“å­˜ï¼ˆcacheï¼‰æŠ€æœ¯ï¼Œå®ƒæœ¬è´¨ä¸Šä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç¼“å­˜å®ç°æ–¹æ¡ˆï¼ˆä¾‹å¦‚ï¼šEHCache æˆ– OSCacheï¼‰ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹ç¼“å­˜ä½¿ç”¨çš„æŠ½è±¡ï¼Œé€šè¿‡åœ¨æ—¢æœ‰ä»£ç ä¸­æ·»åŠ å°‘é‡å®ƒå®šä¹‰çš„å„ç§ annotationï¼Œå³èƒ½å¤Ÿè¾¾åˆ°ç¼“å­˜æ–¹æ³•çš„è¿”å›å¯¹è±¡çš„æ•ˆæœã€‚</p>
<p>Spring Cache çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>é€šè¿‡ç¼“å­˜æ³¨è§£å³å¯æ”¯æŒç¼“å­˜åŠŸèƒ½</li>
<li>æ”¯æŒ Spring EL è¡¨è¾¾å¼</li>
<li>æ”¯æŒ AspectJ</li>
<li>æ”¯æŒè‡ªå®šä¹‰ key å’Œç¼“å­˜ç®¡ç†</li>
</ul>
<h3 id="å¼€å¯ç¼“å­˜æ³¨è§£"><a href="#å¼€å¯ç¼“å­˜æ³¨è§£" class="headerlink" title="å¼€å¯ç¼“å­˜æ³¨è§£"></a>å¼€å¯ç¼“å­˜æ³¨è§£</h3><p>Spring ä¸ºç¼“å­˜åŠŸèƒ½æä¾›äº†æ³¨è§£åŠŸèƒ½ï¼Œä½†æ˜¯ä½ å¿…é¡»å¯åŠ¨æ³¨è§£ã€‚</p>
<p>æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<p>ï¼ˆä¸€ï¼‰ä½¿ç”¨æ ‡è®°æ³¨è§£ <code>@EnableCaching</code></p>
<p>è¿™ç§æ–¹å¼å¯¹äº Spring æˆ– Spring Boot é¡¹ç›®éƒ½é€‚ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆäºŒï¼‰åœ¨ xml ä¸­å£°æ˜</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache:annotation-driven</span> <span class="attr">cache-manager</span>=<span class="string">&quot;cacheManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="spring-ç¼“å­˜æ³¨è§£-API"><a href="#spring-ç¼“å­˜æ³¨è§£-API" class="headerlink" title="spring ç¼“å­˜æ³¨è§£ API"></a>spring ç¼“å­˜æ³¨è§£ API</h3><p>Spring å¯¹ç¼“å­˜çš„æ”¯æŒç±»ä¼¼äºå¯¹äº‹åŠ¡çš„æ”¯æŒã€‚</p>
<p>é¦–å…ˆä½¿ç”¨æ³¨è§£æ ‡è®°æ–¹æ³•ï¼Œç›¸å½“äºå®šä¹‰äº†åˆ‡ç‚¹ï¼Œç„¶åä½¿ç”¨ Aop æŠ€æœ¯åœ¨è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨å‰ã€è°ƒç”¨åè·å–æ–¹æ³•çš„å…¥å‚å’Œè¿”å›å€¼ï¼Œè¿›è€Œå®ç°äº†ç¼“å­˜çš„é€»è¾‘ã€‚</p>
<h4 id="Cacheable"><a href="#Cacheable" class="headerlink" title="@Cacheable"></a>@Cacheable</h4><p><strong><code>@Cacheable</code> ç”¨äºè§¦å‘ç¼“å­˜</strong>ã€‚</p>
<p>è¡¨æ˜æ‰€ä¿®é¥°çš„æ–¹æ³•æ˜¯å¯ä»¥ç¼“å­˜çš„ï¼šå½“ç¬¬ä¸€æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒçš„ç»“æœä¼šè¢«ç¼“å­˜ä¸‹æ¥ï¼Œåœ¨ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´å†…ï¼Œä»¥åè®¿é—®è¿™ä¸ªæ–¹æ³•éƒ½ç›´æ¥è¿”å›ç¼“å­˜ç»“æœï¼Œä¸å†æ‰§è¡Œæ–¹æ³•ä¸­çš„ä»£ç æ®µã€‚</p>
<p>è¿™ä¸ªæ³¨è§£å¯ä»¥ç”¨<code>condition</code>å±æ€§æ¥è®¾ç½®æ¡ä»¶ï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±ä¸ä½¿ç”¨ç¼“å­˜èƒ½åŠ›ï¼Œç›´æ¥æ‰§è¡Œæ–¹æ³•ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨<code>key</code>å±æ€§æ¥æŒ‡å®š key çš„ç”Ÿæˆè§„åˆ™ã€‚</p>
<h4 id="CachePut"><a href="#CachePut" class="headerlink" title="@CachePut"></a>@CachePut</h4><p><strong><code>@CachePut</code> ç”¨äºæ›´æ–°ç¼“å­˜</strong>ã€‚</p>
<p>ä¸<code>@Cacheable</code>ä¸åŒï¼Œ<code>@CachePut</code>ä¸ä»…ä¼šç¼“å­˜æ–¹æ³•çš„ç»“æœï¼Œè¿˜ä¼šæ‰§è¡Œæ–¹æ³•çš„ä»£ç æ®µã€‚</p>
<p>å®ƒæ”¯æŒçš„å±æ€§å’Œç”¨æ³•éƒ½ä¸<code>@Cacheable</code>ä¸€è‡´ã€‚</p>
<h4 id="CacheEvict"><a href="#CacheEvict" class="headerlink" title="@CacheEvict"></a>@CacheEvict</h4><p><strong><code>@CacheEvict</code> ç”¨äºæ¸…é™¤ç¼“å­˜</strong>ã€‚</p>
<p>ä¸<code>@Cacheable</code>åŠŸèƒ½ç›¸åï¼Œ<code>@CacheEvict</code>è¡¨æ˜æ‰€ä¿®é¥°çš„æ–¹æ³•æ˜¯ç”¨æ¥åˆ é™¤å¤±æ•ˆæˆ–æ— ç”¨çš„ç¼“å­˜æ•°æ®ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>@Cacheable</code>ã€<code>@CacheEvict</code>å’Œ<code>@CachePut</code>åŸºæœ¬ä½¿ç”¨æ–¹æ³•çš„ä¸€ä¸ªé›†ä¸­å±•ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="comment">// @Cacheableå¯ä»¥è®¾ç½®å¤šä¸ªç¼“å­˜ï¼Œå½¢å¼å¦‚ï¼š@Cacheable(&#123;&quot;books&quot;, &quot;isbns&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@Cacheable(value=&#123;&quot;users&quot;&#125;, key=&quot;#user.id&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> findUserInDB(user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Cacheable(value = &quot;users&quot;, condition = &quot;#user.getId() &lt;= 2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findUserInLimit</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> findUserInDB(user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CachePut(value = &quot;users&quot;, key = &quot;#user.getId()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        updateUserInDB(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CacheEvict(value = &quot;users&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        removeUserInDB(user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CacheEvict(value = &quot;users&quot;, allEntries = true)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        removeAllInDB();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Caching"><a href="#Caching" class="headerlink" title="@Caching"></a>@Caching</h4><p><strong><code>@Caching</code> ç”¨äºç»„åˆå®šä¹‰å¤šç§ç¼“å­˜åŠŸèƒ½</strong>ã€‚</p>
<p>å¦‚æœéœ€è¦ä½¿ç”¨åŒä¸€ä¸ªç¼“å­˜æ³¨è§£ï¼ˆ<code>@Cacheable</code>ã€<code>@CacheEvict</code>æˆ–<code>@CachePut</code>ï¼‰å¤šæ¬¡ä¿®é¥°ä¸€ä¸ªæ–¹æ³•ï¼Œå°±éœ€è¦ç”¨åˆ°<code>@Caching</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Caching(evict = &#123; @CacheEvict(&quot;primary&quot;), @CacheEvict(cacheNames=&quot;secondary&quot;, key=&quot;#p0&quot;) &#125;)</span></span><br><span class="line"><span class="keyword">public</span> Book <span class="title function_">importBooks</span><span class="params">(String deposit, Date date)</span></span><br></pre></td></tr></table></figure>

<h4 id="CacheConfig"><a href="#CacheConfig" class="headerlink" title="@CacheConfig"></a>@CacheConfig</h4><p><strong><code>@CacheConfig</code> ç”¨äºå®šä¹‰å…¬å…±ç¼“å­˜é…ç½®</strong>ã€‚</p>
<p>ä¸å‰é¢çš„ç¼“å­˜æ³¨è§£ä¸åŒï¼Œè¿™æ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ã€‚</p>
<p>å¦‚æœç±»çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯ç¼“å­˜æ“ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨<code>@CacheConfig</code>æ¥æŒ‡å®šç±»ï¼Œçœå»ä¸€äº›é…ç½®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CacheConfig(&quot;books&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookRepositoryImpl</span> <span class="keyword">implements</span> <span class="title class_">BookRepository</span> &#123;</span><br><span class="line"> <span class="meta">@Cacheable</span></span><br><span class="line"> <span class="keyword">public</span> Book <span class="title function_">findBook</span><span class="params">(ISBN isbn)</span> &#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€Spring-Boot-Cache"><a href="#ä¸‰ã€Spring-Boot-Cache" class="headerlink" title="ä¸‰ã€Spring Boot Cache"></a>ä¸‰ã€Spring Boot Cache</h2><blockquote>
<p>è¯¦è§ï¼š<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.3.1.RELEASE/reference/html/spring-boot-features.html#boot-features-caching">Spring Boot Cache ç‰¹æ€§å®˜æ–¹æ–‡æ¡£</a></p>
</blockquote>
<p>Spring Boot Cache æ˜¯åœ¨ Spring Cache çš„åŸºç¡€ä¸Šåšäº†å°è£…ï¼Œä½¿å¾—ä½¿ç”¨æ›´ä¸ºä¾¿æ·ã€‚</p>
<h3 id="Spring-Boot-Cache-å¿«é€Ÿå…¥é—¨"><a href="#Spring-Boot-Cache-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Spring Boot Cache å¿«é€Ÿå…¥é—¨"></a>Spring Boot Cache å¿«é€Ÿå…¥é—¨</h3><p>ï¼ˆ1ï¼‰å¼•å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŒ‰åºå¼•å…¥éœ€è¦çš„ç¼“å­˜åº“ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰ç¼“å­˜é…ç½®</p>
<p>ä¾‹å¦‚ï¼Œé€‰ç”¨ç¼“å­˜ä¸º redisï¼Œåˆ™éœ€è¦é…ç½® redis ç›¸å…³çš„é…ç½®é¡¹ï¼ˆå¦‚ï¼šæ•°æ®æºã€è¿æ¥æ± ç­‰é…ç½®ä¿¡æ¯ï¼‰</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼“å­˜ç±»å‹ï¼Œæ”¯æŒç±»å‹ï¼šGENERICã€JCACHEã€EHCACHEã€HAZELCASTã€INFINISPANã€COUCHBASEã€REDISã€CAFFEINEã€SIMPLE</span></span><br><span class="line"><span class="attr">spring.cache.type</span> = <span class="string">redis</span></span><br><span class="line"><span class="comment"># å…¨å±€ç¼“å­˜æ—¶é—´</span></span><br><span class="line"><span class="attr">spring.cache.redis.time-to-live</span> = <span class="string">60s</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Redis é…ç½®</span></span><br><span class="line"><span class="attr">spring.redis.database</span> = <span class="string">0</span></span><br><span class="line"><span class="attr">spring.redis.host</span> = <span class="string">localhost</span></span><br><span class="line"><span class="attr">spring.redis.port</span> = <span class="string">6379</span></span><br><span class="line"><span class="attr">spring.redis.password</span> =<span class="string"></span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ä½¿ç”¨ <code>@EnableCaching</code> å¼€å¯ç¼“å­˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰ç¼“å­˜æ³¨è§£ï¼ˆ<code>@Cacheable</code>ã€<code>@CachePut</code>ã€<code>@CacheEvit</code> ç­‰ï¼‰ä½¿ç”¨æ–¹å¼ä¸ Spring Cache å®Œå…¨ä¸€æ ·</p>
<h2 id="å››ã€JetCache"><a href="#å››ã€JetCache" class="headerlink" title="å››ã€JetCache"></a>å››ã€JetCache</h2><blockquote>
<p>JetCache æ˜¯ä¸€ä¸ªåŸºäº Java çš„ç¼“å­˜ç³»ç»Ÿå°è£…ï¼Œæä¾›ç»Ÿä¸€çš„ API å’Œæ³¨è§£æ¥ç®€åŒ–ç¼“å­˜çš„ä½¿ç”¨ã€‚ JetCache æä¾›äº†æ¯” SpringCache æ›´åŠ å¼ºå¤§çš„æ³¨è§£ï¼Œå¯ä»¥åŸç”Ÿçš„æ”¯æŒ TTLã€ä¸¤çº§ç¼“å­˜ã€åˆ†å¸ƒå¼è‡ªåŠ¨åˆ·æ–°ï¼Œè¿˜æä¾›äº†<code>Cache</code>æ¥å£ç”¨äºæ‰‹å·¥ç¼“å­˜æ“ä½œã€‚ å½“å‰æœ‰å››ä¸ªå®ç°ï¼Œ<code>RedisCache</code>ã€<code>TairCache</code>ï¼ˆæ­¤éƒ¨åˆ†æœªåœ¨ github å¼€æºï¼‰ã€<code>CaffeineCache</code>(in memory)å’Œä¸€ä¸ªç®€æ˜“çš„<code>LinkedHashMapCache</code>(in memory)ï¼Œè¦æ·»åŠ æ–°çš„å®ç°ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ã€‚</p>
<p>è¯¦è§ï¼š<a target="_blank" rel="noopener" href="https://github.com/alibaba/jetcache">jetcache Github</a></p>
</blockquote>
<h3 id="jetcache-å¿«é€Ÿå…¥é—¨"><a href="#jetcache-å¿«é€Ÿå…¥é—¨" class="headerlink" title="jetcache å¿«é€Ÿå…¥é—¨"></a>jetcache å¿«é€Ÿå…¥é—¨</h3><p>å¦‚æœä½¿ç”¨ Spring Bootï¼Œå¯ä»¥æŒ‰å¦‚ä¸‹çš„æ–¹å¼é…ç½®ï¼ˆè¿™é‡Œä½¿ç”¨äº† jedis å®¢æˆ·ç«¯è¿æ¥ redisï¼Œå¦‚æœéœ€è¦é›†ç¾¤ã€è¯»å†™åˆ†ç¦»ã€å¼‚æ­¥ç­‰ç‰¹æ€§æ”¯æŒè¯·ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/alibaba/jetcache/wiki/RedisWithLettuce_CN">lettuce</a>å®¢æˆ·ç«¯ï¼‰ã€‚</p>
<p>ï¼ˆ1ï¼‰å¼•å…¥ POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alicp.jetcache<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetcache-starter-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰é…ç½®</p>
<p>é…ç½®ä¸€ä¸ª spring boot é£æ ¼çš„ application.yml æ–‡ä»¶ï¼ŒæŠŠä»–æ”¾åˆ°èµ„æºç›®å½•ä¸­</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jetcache:</span></span><br><span class="line">  <span class="attr">statIntervalMinutes:</span> <span class="number">15</span></span><br><span class="line">  <span class="attr">areaInCacheName:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">local:</span></span><br><span class="line">    <span class="attr">default:</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">linkedhashmap</span></span><br><span class="line">      <span class="attr">keyConvertor:</span> <span class="string">fastjson</span></span><br><span class="line">  <span class="attr">remote:</span></span><br><span class="line">    <span class="attr">default:</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">redis</span></span><br><span class="line">      <span class="attr">keyConvertor:</span> <span class="string">fastjson</span></span><br><span class="line">      <span class="attr">valueEncoder:</span> <span class="string">java</span></span><br><span class="line">      <span class="attr">valueDecoder:</span> <span class="string">java</span></span><br><span class="line">      <span class="attr">poolConfig:</span></span><br><span class="line">        <span class="attr">minIdle:</span> <span class="number">5</span></span><br><span class="line">        <span class="attr">maxIdle:</span> <span class="number">20</span></span><br><span class="line">        <span class="attr">maxTotal:</span> <span class="number">50</span></span><br><span class="line">      <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰å¼€å¯ç¼“å­˜</p>
<p>ç„¶ååˆ›å»ºä¸€ä¸ª App ç±»æ”¾åœ¨ä¸šåŠ¡åŒ…çš„æ ¹ä¸‹ï¼ŒEnableMethodCacheï¼ŒEnableCreateCacheAnnotation è¿™ä¸¤ä¸ªæ³¨è§£åˆ†åˆ«æ¿€æ´» Cached å’Œ CreateCache æ³¨è§£ï¼Œå…¶ä»–å’Œæ ‡å‡†çš„ Spring Boot ç¨‹åºæ˜¯ä¸€æ ·çš„ã€‚è¿™ä¸ªç±»å¯ä»¥ç›´æ¥ main æ–¹æ³•è¿è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.mypackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alicp.jetcache.anno.config.EnableCreateCacheAnnotation;</span><br><span class="line"><span class="keyword">import</span> com.alicp.jetcache.anno.config.EnableMethodCache;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableMethodCache(basePackages = &quot;com.company.mypackage&quot;)</span></span><br><span class="line"><span class="meta">@EnableCreateCacheAnnotation</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySpringBootApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MySpringBootApp.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰API åŸºæœ¬ä½¿ç”¨</p>
<p>åˆ›å»ºç¼“å­˜å®ä¾‹</p>
<p>é€šè¿‡ @CreateCache æ³¨è§£åˆ›å»ºä¸€ä¸ªç¼“å­˜å®ä¾‹ï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´æ˜¯ 100 ç§’</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CreateCache(expire = 100)</span></span><br><span class="line"><span class="keyword">private</span> Cache&lt;Long, UserDO&gt; userCache;</span><br></pre></td></tr></table></figure>

<p>ç”¨èµ·æ¥å°±åƒ map ä¸€æ ·</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UserDO</span> <span class="variable">user</span> <span class="operator">=</span> userCache.get(<span class="number">123L</span>);</span><br><span class="line">userCache.put(<span class="number">123L</span>, user);</span><br><span class="line">userCache.remove(<span class="number">123L</span>);</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ªä¸¤çº§ï¼ˆå†…å­˜+è¿œç¨‹ï¼‰çš„ç¼“å­˜ï¼Œå†…å­˜ä¸­çš„å…ƒç´ ä¸ªæ•°é™åˆ¶åœ¨ 50 ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CreateCache(name = &quot;UserService.userCache&quot;, expire = 100, cacheType = CacheType.BOTH, localLimit = 50)</span></span><br><span class="line"><span class="keyword">private</span> Cache&lt;Long, UserDO&gt; userCache;</span><br></pre></td></tr></table></figure>

<p>name å±æ€§ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯èµ·ä¸ªåå­—æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼Œå±•ç¤ºç»Ÿè®¡æ•°æ®çš„ä½¿ç”¨ï¼Œä¼šä½¿ç”¨è¿™ä¸ªåå­—ã€‚å¦‚æœåŒä¸€ä¸ª area ä¸¤ä¸ª @CreateCache çš„ name é…ç½®ä¸€æ ·ï¼Œå®ƒä»¬ç”Ÿæˆçš„ Cache å°†æŒ‡å‘åŒä¸€ä¸ªå®ä¾‹ã€‚</p>
<p>åˆ›å»ºæ–¹æ³•ç¼“å­˜</p>
<p>ä½¿ç”¨ @Cached æ–¹æ³•å¯ä»¥ä¸ºä¸€ä¸ªæ–¹æ³•æ·»åŠ ä¸Šç¼“å­˜ã€‚JetCache é€šè¿‡ Spring AOP ç”Ÿæˆä»£ç†ï¼Œæ¥æ”¯æŒç¼“å­˜åŠŸèƒ½ã€‚æ³¨è§£å¯ä»¥åŠ åœ¨æ¥å£æ–¹æ³•ä¸Šä¹Ÿå¯ä»¥åŠ åœ¨ç±»æ–¹æ³•ä¸Šï¼Œä½†éœ€è¦ä¿è¯æ˜¯ä¸ª Spring beanã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Cached(name=&quot;UserService.getUserById&quot;, expire = 3600)</span></span><br><span class="line">    User <span class="title function_">getUserById</span><span class="params">(<span class="type">long</span> userId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€j2cache"><a href="#äº”ã€j2cache" class="headerlink" title="äº”ã€j2cache"></a>äº”ã€j2cache</h2><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>ä½¿ç”¨ç¼“å­˜æ¡†æ¶ï¼Œä½¿å¾—å¼€å‘ç¼“å­˜åŠŸèƒ½éå¸¸ä¾¿æ·ã€‚</p>
<p>å¦‚æœä½ çš„ç³»ç»Ÿåªéœ€è¦ä½¿ç”¨ä¸€ç§ç¼“å­˜ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨ Spring Boot Cacheã€‚Spring Boot Cache åœ¨ Spring Cache åŸºç¡€ä¸Šåšäº†å°è£…ï¼Œä½¿ç”¨æ›´ç®€å•ã€æ–¹ä¾¿ã€‚</p>
<p>å¦‚æœä½ çš„ç³»ç»Ÿéœ€è¦ä½¿ç”¨å¤šçº§ç¼“å­˜ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨ jetcacheã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.jcp.org/en/jsr/detail?id=107">JSR107</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html#cache">Spring Cache å®˜æ–¹æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.3.1.RELEASE/reference/html/spring-boot-features.html#boot-features-caching">Spring Boot Cache ç‰¹æ€§å®˜æ–¹æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://gitee.com/ld/J2Cache">J2Cache Gitee</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/jetcache">jetcache Github</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/jetcache/wiki/Home_CN">jetcache wiki</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.ligoudan.cn/pages/59f078/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/ligoudan.png">
      <meta itemprop="name" content="æç‹—è›‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LIGOUDAN">
      <meta itemprop="description" content="å¤©æ°”ä¸é”™å“‡ï¼Œä½ çœ‹è¿™å¤§å†°é›¹ä¸‹å¾—">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LIGOUDAN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/pages/59f078/" class="post-title-link" itemprop="url">Java è¿›ç¨‹å†…ç¼“å­˜</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-17 22:34:30" itemprop="dateCreated datePublished" datetime="2022-02-17T22:34:30+08:00">2022-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-12 10:02:52" itemprop="dateModified" datetime="2024-12-12T10:02:52+08:00">2024-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E4%B8%AD%E9%97%B4%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">ä¸­é—´ä»¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E7%BC%93%E5%AD%98/" itemprop="url" rel="index"><span itemprop="name">ç¼“å­˜</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>3.7k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>3 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Java-è¿›ç¨‹å†…ç¼“å­˜"><a href="#Java-è¿›ç¨‹å†…ç¼“å­˜" class="headerlink" title="Java è¿›ç¨‹å†…ç¼“å­˜"></a>Java è¿›ç¨‹å†…ç¼“å­˜</h1><blockquote>
<p>å…³é”®è¯ï¼šConcurrentHashMapã€LRUHashMapã€Guava Cacheã€Caffeineã€Ehcache</p>
</blockquote>
<h2 id="ä¸€ã€ConcurrentHashMap"><a href="#ä¸€ã€ConcurrentHashMap" class="headerlink" title="ä¸€ã€ConcurrentHashMap"></a>ä¸€ã€ConcurrentHashMap</h2><p>æœ€ç®€å•çš„è¿›ç¨‹å†…ç¼“å­˜å¯ä»¥é€šè¿‡ JDK è‡ªå¸¦çš„ <code>HashMap</code> æˆ– <code>ConcurrentHashMap</code> å®ç°ã€‚</p>
<p>é€‚ç”¨åœºæ™¯ï¼š<strong>ä¸éœ€è¦æ·˜æ±°çš„ç¼“å­˜æ•°æ®</strong>ã€‚</p>
<p>ç¼ºç‚¹ï¼šæ— æ³•è¿›è¡Œç¼“å­˜æ·˜æ±°ï¼Œå†…å­˜ä¼šæ— é™åˆ¶çš„å¢é•¿ã€‚</p>
<h2 id="äºŒã€LRUHashMap"><a href="#äºŒã€LRUHashMap" class="headerlink" title="äºŒã€LRUHashMap"></a>äºŒã€LRUHashMap</h2><p>å¯ä»¥é€šè¿‡**ç»§æ‰¿ <code>LinkedHashMap</code> æ¥å®ç°ä¸€ä¸ªç®€å•çš„ <code>LRUHashMap</code>**ï¼Œå³å¯å®Œæˆä¸€ä¸ªç®€å•çš„ <strong>LRU ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰</strong>ç®—æ³•ã€‚</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>é”ç«äº‰ä¸¥é‡ï¼Œæ€§èƒ½æ¯”è¾ƒä½ã€‚</li>
<li>ä¸æ”¯æŒè¿‡æœŸæ—¶é—´</li>
<li>ä¸æ”¯æŒè‡ªåŠ¨åˆ·æ–°</li>
</ul>
<p>ã€ç¤ºä¾‹ã€‘LRUHashMap çš„ç®€å•å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LRUCache</span> <span class="keyword">extends</span> <span class="title class_">LinkedHashMap</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> max;</span><br><span class="line">    <span class="keyword">private</span> Object lock;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LRUCache</span><span class="params">(<span class="type">int</span> max)</span> &#123;</span><br><span class="line">        <span class="comment">//æ— éœ€æ‰©å®¹</span></span><br><span class="line">        <span class="built_in">super</span>((<span class="type">int</span>) (max * <span class="number">1.4f</span>), <span class="number">0.75f</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">this</span>.max = max;</span><br><span class="line">        <span class="built_in">this</span>.lock = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡å†™LinkedHashMapçš„removeEldestEntryæ–¹æ³•å³å¯ åœ¨Putçš„æ—¶å€™åˆ¤æ–­ï¼Œå¦‚æœä¸ºtrueï¼Œå°±ä¼šåˆ é™¤æœ€è€çš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> eldest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">removeEldestEntry</span><span class="params">(Map.Entry eldest)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size() &gt; max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            <span class="keyword">return</span> get(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">putValue</span><span class="params">(Object key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            put(key, value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">removeValue</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            <span class="keyword">return</span> remove(key) != <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">removeAll</span><span class="params">()</span> &#123;</span><br><span class="line">        clear();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€Guava-Cache"><a href="#ä¸‰ã€Guava-Cache" class="headerlink" title="ä¸‰ã€Guava Cache"></a>ä¸‰ã€Guava Cache</h2><p>Guava Cache è§£å†³äº† <code>LRUHashMap</code> ä¸­çš„å‡ ä¸ªç¼ºç‚¹ã€‚</p>
<p>Guava Cache æä¾›äº†<strong>åŸºäºå®¹é‡ï¼Œæ—¶é—´å’Œå¼•ç”¨çš„ç¼“å­˜å›æ”¶æ–¹å¼</strong>ã€‚åŸºäºå®¹é‡çš„æ–¹å¼å†…éƒ¨å®ç°é‡‡ç”¨ LRU ç®—æ³•ï¼ŒåŸºäºå¼•ç”¨å›æ”¶å¾ˆå¥½çš„åˆ©ç”¨äº† Java è™šæ‹Ÿæœºçš„åƒåœ¾å›æ”¶æœºåˆ¶ã€‚</p>
<p>å…¶ä¸­çš„ç¼“å­˜æ„é€ å™¨ CacheBuilder é‡‡ç”¨æ„å»ºè€…æ¨¡å¼æä¾›äº†è®¾ç½®å¥½å„ç§å‚æ•°çš„ç¼“å­˜å¯¹è±¡ã€‚ç¼“å­˜æ ¸å¿ƒç±» LocalCache é‡Œé¢çš„å†…éƒ¨ç±» Segment ä¸ jdk1.7 åŠä»¥å‰çš„ <code>ConcurrentHashMap</code> éå¸¸ç›¸ä¼¼ï¼Œåˆ†æ®µåŠ é”ï¼Œå‡å°‘é”ç«äº‰ï¼Œå¹¶ä¸”éƒ½ç»§æ‰¿äº <code>ReetrantLock</code>ï¼Œè¿˜æœ‰å…­ä¸ªé˜Ÿåˆ—ï¼Œä»¥å®ç°ä¸°å¯Œçš„æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆã€‚Guava Cache å¯¹äºè¿‡æœŸçš„ Entry å¹¶æ²¡æœ‰é©¬ä¸Šè¿‡æœŸ(ä¹Ÿå°±æ˜¯å¹¶æ²¡æœ‰åå°çº¿ç¨‹ä¸€ç›´åœ¨æ‰«)ï¼Œè€Œæ˜¯é€šè¿‡è¿›è¡Œè¯»å†™æ“ä½œçš„æ—¶å€™è¿›è¡Œè¿‡æœŸå¤„ç†ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯é¿å…åå°çº¿ç¨‹æ‰«æçš„æ—¶å€™è¿›è¡Œå…¨å±€åŠ é”ã€‚</p>
<p>ç›´æ¥é€šè¿‡æŸ¥è¯¢ï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ»¡è¶³åˆ·æ–°æ¡ä»¶ï¼Œè¿›è¡Œåˆ·æ–°ã€‚</p>
<h3 id="Guava-Cache-ç¼“å­˜å›æ”¶"><a href="#Guava-Cache-ç¼“å­˜å›æ”¶" class="headerlink" title="Guava Cache ç¼“å­˜å›æ”¶"></a>Guava Cache ç¼“å­˜å›æ”¶</h3><p>Guava Cache æä¾›äº†ä¸‰ç§åŸºæœ¬çš„ç¼“å­˜å›æ”¶æ–¹å¼ã€‚</p>
<h3 id="åŸºäºå®¹é‡å›æ”¶"><a href="#åŸºäºå®¹é‡å›æ”¶" class="headerlink" title="åŸºäºå®¹é‡å›æ”¶"></a>åŸºäºå®¹é‡å›æ”¶</h3><p><code>maximumSize(long)</code>ï¼šå½“ç¼“å­˜ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡æŒ‡å®šå€¼æ—¶è§¦å‘å›æ”¶ã€‚</p>
<h3 id="åŸºäºå®šæ—¶å›æ”¶"><a href="#åŸºäºå®šæ—¶å›æ”¶" class="headerlink" title="åŸºäºå®šæ—¶å›æ”¶"></a>åŸºäºå®šæ—¶å›æ”¶</h3><ul>
<li><code>expireAfterAccess(long, TimeUnit)</code>ï¼šç¼“å­˜é¡¹åœ¨ç»™å®šæ—¶é—´å†…æ²¡æœ‰è¢«è¯»&#x2F;å†™è®¿é—®ï¼Œåˆ™å›æ”¶ã€‚è¯·æ³¨æ„è¿™ç§ç¼“å­˜çš„å›æ”¶é¡ºåºå’ŒåŸºäºå¤§å°å›æ”¶ä¸€æ ·ã€‚</li>
<li><code>expireAfterWrite(long, TimeUnit)</code>ï¼šç¼“å­˜é¡¹åœ¨ç»™å®šæ—¶é—´å†…æ²¡æœ‰è¢«å†™è®¿é—®ï¼ˆåˆ›å»ºæˆ–è¦†ç›–ï¼‰ï¼Œåˆ™å›æ”¶ã€‚å¦‚æœè®¤ä¸ºç¼“å­˜æ•°æ®æ€»æ˜¯åœ¨å›ºå®šæ—¶å€™åå˜å¾—é™ˆæ—§ä¸å¯ç”¨ï¼Œè¿™ç§å›æ”¶æ–¹å¼æ˜¯å¯å–çš„ã€‚</li>
</ul>
<p>å¦‚ä¸‹æ–‡æ‰€è®¨è®ºï¼Œå®šæ—¶å›æ”¶å‘¨æœŸæ€§åœ°åœ¨å†™æ“ä½œä¸­æ‰§è¡Œï¼Œå¶å°”åœ¨è¯»æ“ä½œä¸­æ‰§è¡Œã€‚</p>
<h3 id="åŸºäºå¼•ç”¨å›æ”¶"><a href="#åŸºäºå¼•ç”¨å›æ”¶" class="headerlink" title="åŸºäºå¼•ç”¨å›æ”¶"></a>åŸºäºå¼•ç”¨å›æ”¶</h3><ul>
<li><code>CacheBuilder.weakKeys()</code>ï¼šä½¿ç”¨å¼±å¼•ç”¨å­˜å‚¨é”®ã€‚å½“é”®æ²¡æœ‰å…¶å®ƒï¼ˆå¼ºæˆ–è½¯ï¼‰å¼•ç”¨æ—¶ï¼Œç¼“å­˜é¡¹å¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚</li>
<li><code>CacheBuilder.weakValues()</code>ï¼šä½¿ç”¨å¼±å¼•ç”¨å­˜å‚¨å€¼ã€‚å½“å€¼æ²¡æœ‰å…¶å®ƒï¼ˆå¼ºæˆ–è½¯ï¼‰å¼•ç”¨æ—¶ï¼Œç¼“å­˜é¡¹å¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚</li>
<li><code>CacheBuilder.softValues()</code>ï¼šä½¿ç”¨è½¯å¼•ç”¨å­˜å‚¨å€¼ã€‚è½¯å¼•ç”¨åªæœ‰åœ¨å“åº”å†…å­˜éœ€è¦æ—¶ï¼Œæ‰æŒ‰ç…§å…¨å±€æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡ºåºå›æ”¶ã€‚</li>
</ul>
<h3 id="Guava-Cache-æ ¸å¿ƒ-API"><a href="#Guava-Cache-æ ¸å¿ƒ-API" class="headerlink" title="Guava Cache æ ¸å¿ƒ API"></a>Guava Cache æ ¸å¿ƒ API</h3><h4 id="CacheBuilder"><a href="#CacheBuilder" class="headerlink" title="CacheBuilder"></a>CacheBuilder</h4><p>ç¼“å­˜æ„å»ºå™¨ã€‚æ„å»ºç¼“å­˜çš„å…¥å£ï¼ŒæŒ‡å®šç¼“å­˜é…ç½®å‚æ•°å¹¶åˆå§‹åŒ–æœ¬åœ°ç¼“å­˜ã€‚<br>ä¸»è¦é‡‡ç”¨ builder çš„æ¨¡å¼ï¼ŒCacheBuilder çš„æ¯ä¸€ä¸ªæ–¹æ³•éƒ½è¿”å›è¿™ä¸ª CacheBuilder çŸ¥é“ build æ–¹æ³•çš„è°ƒç”¨ã€‚<br>æ³¨æ„ build æ–¹æ³•æœ‰é‡è½½ï¼Œå¸¦æœ‰å‚æ•°çš„ä¸ºæ„å»ºä¸€ä¸ªå…·æœ‰æ•°æ®åŠ è½½åŠŸèƒ½çš„ç¼“å­˜ï¼Œä¸å¸¦å‚æ•°çš„æ„å»ºä¸€ä¸ªæ²¡æœ‰æ•°æ®åŠ è½½åŠŸèƒ½çš„ç¼“å­˜ã€‚</p>
<h4 id="LocalManualCache"><a href="#LocalManualCache" class="headerlink" title="LocalManualCache"></a>LocalManualCache</h4><p>ä½œä¸º LocalCache çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œåœ¨æ„é€ æ–¹æ³•é‡Œé¢ä¼šæŠŠ LocalCache ç±»å‹çš„å˜é‡ä¼ å…¥ï¼Œå¹¶ä¸”è°ƒç”¨æ–¹æ³•æ—¶éƒ½ç›´æ¥æˆ–è€…é—´æ¥è°ƒç”¨ LocalCache é‡Œé¢çš„æ–¹æ³•ã€‚</p>
<h4 id="LocalLoadingCache"><a href="#LocalLoadingCache" class="headerlink" title="LocalLoadingCache"></a>LocalLoadingCache</h4><p>å¯ä»¥çœ‹åˆ°è¯¥ç±»ç»§æ‰¿äº† LocalManualCache å¹¶å®ç°æ¥å£ LoadingCacheã€‚<br>è¦†ç›–äº† getï¼ŒgetUnchecked ç­‰æ–¹æ³•ã€‚</p>
<h4 id="LocalCache"><a href="#LocalCache" class="headerlink" title="LocalCache"></a>LocalCache</h4><p>Guava Cache ä¸­çš„æ ¸å¿ƒç±»ï¼Œé‡ç‚¹äº†è§£ã€‚</p>
<p>LocalCache çš„æ•°æ®ç»“æ„ä¸ ConcurrentHashMap å¾ˆç›¸ä¼¼ï¼Œéƒ½ç”±å¤šä¸ª segment ç»„æˆï¼Œä¸”å„ segment ç›¸å¯¹ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ï¼Œæ‰€ä»¥èƒ½æ”¯æŒå¹¶è¡Œæ“ä½œã€‚æ¯ä¸ª segment ç”±ä¸€ä¸ª table å’Œè‹¥å¹²é˜Ÿåˆ—ç»„æˆã€‚ç¼“å­˜æ•°æ®å­˜å‚¨åœ¨ table ä¸­ï¼Œå…¶ç±»å‹ä¸º AtomicReferenceArrayã€‚</p>
<h2 id="å››ã€Caffeine"><a href="#å››ã€Caffeine" class="headerlink" title="å››ã€Caffeine"></a>å››ã€Caffeine</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/ben-manes/caffeine">caffeine</a> æ˜¯ä¸€ä¸ªä½¿ç”¨ JDK8 æ”¹è¿› Guava ç¼“å­˜çš„é«˜æ€§èƒ½ç¼“å­˜åº“ã€‚</p>
</blockquote>
<p>Caffeine å®ç°äº† W-TinyLFU(<strong>LFU</strong> + <strong>LRU</strong> ç®—æ³•çš„å˜ç§)ï¼Œå…¶<strong>å‘½ä¸­ç‡å’Œè¯»å†™ååé‡å¤§å¤§ä¼˜äº Guava Cache</strong>ã€‚</p>
<p>å…¶å®ç°åŸç†è¾ƒå¤æ‚ï¼Œå¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://juejin.im/post/5b7593496fb9a009b62904fa#comment">ä½ åº”è¯¥çŸ¥é“çš„ç¼“å­˜è¿›åŒ–å²</a>ã€‚</p>
<h2 id="äº”ã€Ehcache"><a href="#äº”ã€Ehcache" class="headerlink" title="äº”ã€Ehcache"></a>äº”ã€Ehcache</h2><blockquote>
<p>å‚è€ƒï¼š<a href="04.Ehcache.md">Ehcache</a></p>
</blockquote>
<h2 id="å…­ã€è¿›ç¨‹å†…ç¼“å­˜å¯¹æ¯”"><a href="#å…­ã€è¿›ç¨‹å†…ç¼“å­˜å¯¹æ¯”" class="headerlink" title="å…­ã€è¿›ç¨‹å†…ç¼“å­˜å¯¹æ¯”"></a>å…­ã€è¿›ç¨‹å†…ç¼“å­˜å¯¹æ¯”</h2><p>å¸¸ç”¨è¿›ç¨‹å†…ç¼“å­˜æŠ€æœ¯å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒé¡¹</th>
<th>ConcurrentHashMap</th>
<th>LRUMap</th>
<th>Ehcache</th>
<th>Guava Cache</th>
<th>Caffeine</th>
</tr>
</thead>
<tbody><tr>
<td>è¯»å†™æ€§èƒ½</td>
<td>å¾ˆå¥½ï¼Œåˆ†æ®µé”</td>
<td>ä¸€èˆ¬ï¼Œå…¨å±€åŠ é”</td>
<td>å¥½</td>
<td>å¥½ï¼Œéœ€è¦åšæ·˜æ±°æ“ä½œ</td>
<td>å¾ˆå¥½</td>
</tr>
<tr>
<td>æ·˜æ±°ç®—æ³•</td>
<td>æ— </td>
<td>LRUï¼Œä¸€èˆ¬</td>
<td>æ”¯æŒå¤šç§æ·˜æ±°ç®—æ³•,LRU,LFU,FIFO</td>
<td>LRUï¼Œä¸€èˆ¬</td>
<td>W-TinyLFU, å¾ˆå¥½</td>
</tr>
<tr>
<td>åŠŸèƒ½ä¸°å¯Œç¨‹åº¦</td>
<td>åŠŸèƒ½æ¯”è¾ƒç®€å•</td>
<td>åŠŸèƒ½æ¯”è¾ƒå•ä¸€</td>
<td>åŠŸèƒ½å¾ˆä¸°å¯Œ</td>
<td>åŠŸèƒ½å¾ˆä¸°å¯Œï¼Œæ”¯æŒåˆ·æ–°å’Œè™šå¼•ç”¨ç­‰</td>
<td>åŠŸèƒ½å’Œ Guava Cache ç±»ä¼¼</td>
</tr>
<tr>
<td>å·¥å…·å¤§å°</td>
<td>jdk è‡ªå¸¦ç±»ï¼Œå¾ˆå°</td>
<td>åŸºäº LinkedHashMapï¼Œè¾ƒå°</td>
<td>å¾ˆå¤§ï¼Œæœ€æ–°ç‰ˆæœ¬ 1.4MB</td>
<td>æ˜¯ Guava å·¥å…·ç±»ä¸­çš„ä¸€ä¸ªå°éƒ¨åˆ†ï¼Œè¾ƒå°</td>
<td>ä¸€èˆ¬ï¼Œæœ€æ–°ç‰ˆæœ¬ 644KB</td>
</tr>
<tr>
<td>æ˜¯å¦æŒä¹…åŒ–</td>
<td>å¦</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>å¦</td>
<td>å¦</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒé›†ç¾¤</td>
<td>å¦</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>å¦</td>
<td>å¦</td>
</tr>
</tbody></table>
<ul>
<li><strong><code>ConcurrentHashMap</code></strong> - æ¯”è¾ƒé€‚åˆç¼“å­˜æ¯”è¾ƒå›ºå®šä¸å˜çš„å…ƒç´ ï¼Œä¸”ç¼“å­˜çš„æ•°é‡è¾ƒå°çš„ã€‚è™½ç„¶ä»ä¸Šé¢è¡¨æ ¼ä¸­æ¯”èµ·æ¥æœ‰ç‚¹é€Šè‰²ï¼Œä½†æ˜¯å…¶ç”±äºæ˜¯ JDK è‡ªå¸¦çš„ç±»ï¼Œåœ¨å„ç§æ¡†æ¶ä¸­ä¾ç„¶æœ‰å¤§é‡çš„ä½¿ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç”¨æ¥ç¼“å­˜æˆ‘ä»¬åå°„çš„ Methodï¼ŒField ç­‰ç­‰ï¼›ä¹Ÿå¯ä»¥ç¼“å­˜ä¸€äº›é“¾æ¥ï¼Œé˜²æ­¢å…¶é‡å¤å»ºç«‹ã€‚åœ¨ Caffeine ä¸­ä¹Ÿæ˜¯ä½¿ç”¨çš„ <code>ConcurrentHashMap</code> æ¥å­˜å‚¨å…ƒç´ ã€‚</li>
<li><strong><code>LRUMap</code></strong> - å¦‚æœä¸æƒ³å¼•å…¥ç¬¬ä¸‰æ–¹åŒ…ï¼Œåˆæƒ³ä½¿ç”¨æ·˜æ±°ç®—æ³•æ·˜æ±°æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªã€‚</li>
<li><strong><code>Ehcache</code></strong> - ç”±äºå…¶ jar åŒ…å¾ˆå¤§ï¼Œè¾ƒé‡é‡çº§ã€‚å¯¹äºéœ€è¦æŒä¹…åŒ–å’Œé›†ç¾¤çš„ä¸€äº›åŠŸèƒ½çš„ï¼Œå¯ä»¥é€‰æ‹© Ehcacheã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ Ehcache ä¹Ÿæ”¯æŒåˆ†å¸ƒå¼ç¼“å­˜ï¼Œä½†æ˜¯ç”±äºå…¶èŠ‚ç‚¹é—´é€šä¿¡æ–¹å¼ä¸º rmiï¼Œè¡¨ç°ä¸å¦‚ Redisï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸å»ºè®®ç”¨å®ƒæ¥ä½œä¸ºåˆ†å¸ƒå¼ç¼“å­˜ã€‚</li>
<li><strong><code>Guava Cache</code></strong> - Guava è¿™ä¸ª jar åŒ…åœ¨å¾ˆå¤š Java åº”ç”¨ç¨‹åºä¸­éƒ½æœ‰å¤§é‡çš„å¼•å…¥ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™å…¶å®æ˜¯ç›´æ¥ç”¨å°±å¥½äº†ï¼Œå¹¶ä¸”å…¶æœ¬èº«æ˜¯è½»é‡çº§çš„è€Œä¸”åŠŸèƒ½è¾ƒä¸ºä¸°å¯Œï¼Œåœ¨ä¸äº†è§£ Caffeine çš„æƒ…å†µä¸‹å¯ä»¥é€‰æ‹© Guava Cacheã€‚</li>
<li><strong><code>Caffeine</code></strong> - å…¶åœ¨å‘½ä¸­ç‡ï¼Œè¯»å†™æ€§èƒ½ä¸Šéƒ½æ¯” Guava Cache å¥½å¾ˆå¤šï¼Œå¹¶ä¸”å…¶ API å’Œ Guava cache åŸºæœ¬ä¸€è‡´ï¼Œç”šè‡³ä¼šå¤šä¸€ç‚¹ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ä½¿ç”¨ Caffeineï¼Œå–å¾—è¿‡ä¸é”™çš„æ•ˆæœã€‚</li>
</ul>
<p>æ€»ç»“ä¸€ä¸‹ï¼š**å¦‚æœä¸éœ€è¦æ·˜æ±°ç®—æ³•åˆ™é€‰æ‹© <code>ConcurrentHashMap</code>ï¼Œå¦‚æœéœ€è¦æ·˜æ±°ç®—æ³•å’Œä¸€äº›ä¸°å¯Œçš„ APIï¼Œæ¨èé€‰æ‹© <code>Caffeine</code>**ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ben-manes/caffeine">caffeine github</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5b8df63c6fb9a019e04ebaf4">æ·±å…¥è§£å¯†æ¥è‡ªæœªæ¥çš„ç¼“å­˜-Caffeine</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/9a80c662dac4">Caffeine ç¼“å­˜</a></li>
<li><a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/guava-tutorial/content/1.html">Google Guava å®˜æ–¹æ•™ç¨‹ï¼ˆä¸­æ–‡ç‰ˆï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/38bd5f1cf2f2">Google Guava Cache å…¨è§£æ</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.ibm.com/zh/articles/os-cn-spring-cache/">æ³¨é‡Šé©±åŠ¨çš„ Spring cache ç¼“å­˜ä»‹ç»</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="ä¸Šä¸€é¡µ" aria-label="ä¸Šä¸€é¡µ" href="/page/11/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/47/">47</a><a class="extend next" rel="next" title="ä¸‹ä¸€é¡µ" aria-label="ä¸‹ä¸€é¡µ" href="/page/13/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ç²¤ICPå¤‡2021160229å· </a>
  </div>
  <div class="copyright">
    &copy; 2015 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">æç‹—è›‹</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">3.5m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">53:28</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/yiyirushi/" class="github-corner" title="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" aria-label="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  




<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

</body>
</html>
